import type { SeedCard } from "../generator";

type UserLevel = "Fácil" | "Médio" | "Difícil";

// ─── Rede de Computadores · 12 categorias × 3 níveis × 7 questões (rodada 4/30) ───

export const redesBank: Record<string, Record<UserLevel, SeedCard[]>> = {
  // ── Cabeamento Estruturado ──
  "Cabeamento Estruturado": {
    Fácil: [
      {
        q: "Qual é o comprimento máximo de um segmento de cabo UTP Cat5e em redes Ethernet?",
        o: ["100 metros", "50 metros", "200 metros", "150 metros"],
        c: 0,
        e: "O padrão TIA/EIA-568 define que cabos UTP (categorias 5e, 6, 6A) podem ter no máximo 100 metros por segmento em redes Ethernet. Isso inclui 90m de cabeamento fixo + 10m de patch cords (cabos de ligação).",
        x: "Horizontal cabling: 90m (da sala de telecomunicações até a tomada). Patch cords: 5m de cada lado (5+5=10). Total: 90 + 10 = 100m. Acima disso, é necessário usar um switch/repetidor.",
      },
      {
        q: "Qual tipo de cabo era necessário para conectar dois computadores diretamente sem switch em redes Fast Ethernet?",
        o: [
          "Cabo crossover (cruzado)",
          "Cabo coaxial",
          "Cabo de fibra óptica",
          "Cabo direto (straight-through)",
        ],
        c: 0,
        e: "O cabo crossover cruza os pares de transmissão e recepção (TX↔RX), permitindo comunicação direta entre dois dispositivos iguais (PC-PC, switch-switch). Dispositivos modernos com Auto-MDI/MDIX detectam e corrigem automaticamente, tornando o crossover desnecessário.",
        x: "Crossover: pinos 1,2 trocam com 3,6. Usa 568A em uma ponta e 568B na outra. Auto-MDI/MDIX (presente em switches e NICs modernos) detecta o tipo de cabo e ajusta automaticamente.",
      },
      {
        q: "O que é um patch panel em cabeamento estruturado?",
        o: [
          "Painel que organiza e termina os cabos fixos da rede em um rack",
          "Equipamento que amplifica o sinal de rede",
          "Dispositivo que converte fibra óptica em cabo UTP",
          "Software de gerenciamento de cabos",
        ],
        c: 0,
        e: "O patch panel é um painel passivo instalado no rack que organiza a terminação dos cabos fixos (horizontal cabling). Cada porta corresponde a uma tomada de rede. Patch cords conectam o patch panel ao switch.",
        x: "Vantagem: facilita manutenção e mudanças — basta trocar o patch cord, sem alterar o cabeamento fixo na parede. Norma TIA-568: o patch panel fica na sala de telecomunicações (TR).",
      },
      {
        q: "Qual o comprimento máximo de um segmento de cabo UTP Ethernet (horizontal cabling)?",
        o: ["100 metros", "50 metros", "200 metros", "500 metros"],
        c: 0,
        e: "O padrão TIA-568 define 100 metros como comprimento máximo total do canal (channel): 90m de cabeamento fixo + até 10m de patch cords. Acima de 100m, a atenuação do sinal degrada a comunicação.",
        x: "90m de cabeamento horizontal (fixo na parede) + 5m de patch cord no rack + 5m de patch cord na área de trabalho = 100m total (channel). Fibra permite distâncias muito maiores.",
      },
      {
        q: "Qual tipo de cabo é usado para conectar dispositivos diferentes (PC ↔ switch)?",
        o: [
          "Cabo direto (straight-through)",
          "Cabo crossover",
          "Cabo rollover/console",
          "Cabo coaxial",
        ],
        c: 0,
        e: "Cabo direto (straight-through) conecta dispositivos diferentes: PC↔switch, switch↔roteador. Usa o mesmo padrão (568B) em ambas as pontas. Cabo crossover conecta dispositivos iguais (PC↔PC, switch↔switch).",
        x: "Direto: mesmo padrão nas duas pontas (568B-568B). Crossover: padrões diferentes (568A-568B). Aujourd'hui: switches modernos com Auto-MDI/MDIX detectam automaticamente.",
      },
      {
        q: "O que é um rack de telecomunicações em cabeamento estruturado?",
        o: [
          "Armário metálico que organiza equipamentos de rede como switches e patch panels",
          "Software de gerenciamento de cabos",
          "Tipo de conector para fibra óptica",
          "Dispositivo que amplifica o sinal Wi-Fi",
        ],
        c: 0,
        e: "O rack é uma estrutura metálica padronizada (19 polegadas de largura) que acomoda switches, patch panels, servidores e organizadores de cabos. A altura é medida em U (unidades de rack, 1U = 44.45mm).",
        x: 'Rack 19": padrão da indústria. Tamanhos comuns: 42U (piso), 12U (parede). Componentes: patch panel, switch, organizador de cabos, régua de energia (PDU). Norma TIA-569 define o espaço.',
      },
      {
        q: "Para que serve a fibra óptica em redes de computadores?",
        o: [
          "Transmitir dados como pulsos de luz, alcançando longas distâncias com alta velocidade",
          "Substituir cabos de energia elétrica",
          "Conectar teclados e mouses ao computador",
          "Transmitir sinal de rádio para redes Wi-Fi",
        ],
        c: 0,
        e: "A fibra óptica transmite dados usando luz (laser ou LED) em vez de sinais elétricos. Vantagens: imunidade a interferência eletromagnética, distâncias muito maiores e velocidades mais altas que o cobre.",
        x: "Vantagens da fibra: distância (km vs 100m do UTP), velocidade (100+ Gbps), imunidade a EMI, segurança (difícil interceptar). Desvantagens: custo maior, fragilidade, mão-de-obra especializada.",
      },
    ],
    Médio: [
      {
        q: "Qual a principal diferença entre cabo UTP Cat6 e Cat6A?",
        o: [
          "Cat6A suporta 10 Gbps a 100m; Cat6 suporta 10 Gbps apenas a 55m",
          "Cat6A é blindado e Cat6 não",
          "Cat6A suporta apenas 1 Gbps",
          "Não há diferença prática",
        ],
        c: 0,
        e: "Cat6 suporta 10 Gigabit Ethernet (10GBASE-T) apenas até 55 metros; para 1 Gbps vai até 100m normalmente. Cat6A (Augmented) foi projetado para suportar 10 Gbps em toda a distância de 100m, com melhor isolamento contra crosstalk (alien crosstalk).",
        x: "Cat5e: 1 Gbps/100m. Cat6: 1 Gbps/100m ou 10 Gbps/55m. Cat6A: 10 Gbps/100m. Cat7: 10 Gbps/100m (blindado, conector GG45). Cat8: 25-40 Gbps/30m.",
      },
      {
        q: "Qual tipo de fibra óptica é ideal para longas distâncias acima de 10 km?",
        o: [
          "Fibra monomodo (single-mode)",
          "Fibra multimodo (multi-mode)",
          "Cabo UTP Cat6A",
          "Cabo coaxial RG-59",
        ],
        c: 0,
        e: "Fibra monomodo (SMF) usa um núcleo muito fino (~9 µm) que permite apenas um modo de propagação da luz, reduzindo a dispersão. Alcança 10 km a 100+ km. Fibra multimodo (MMF, núcleo 50/62.5 µm) é para curtas distâncias (até ~550m em 10G).",
        x: "Monomodo: núcleo 9 µm, laser, longa distância (10-100+ km), mais cara. Multimodo: núcleo 50/62.5 µm, LED/VCSEL, curta distância (até 2 km em 1G, 550m em 10G), mais barata. Conector LC é o mais comum.",
      },
      {
        q: "O que é crosstalk (diafonia) em cabos de rede e qual tipo é medido na ponta transmissora?",
        o: [
          "NEXT (Near-End Crosstalk) — interferência entre pares adjacentes dentro do mesmo cabo",
          "Atenuação do sinal ao longo do cabo",
          "Reflexão do sinal causada por impedância incorreta",
          "Perda de pacotes na camada de transporte",
        ],
        c: 0,
        e: "Crosstalk é a interferência eletromagnética entre pares de fios. NEXT mede a interferência na mesma ponta onde o sinal é transmitido. FEXT mede na ponta oposta. A trançagem dos pares e blindagem (STP/FTP) reduzem o crosstalk.",
        x: "NEXT: Near-End Crosstalk (ponta transmissora). FEXT: Far-End Crosstalk (ponta receptora). PS-NEXT: Power Sum NEXT (todos os pares). Quanto maior o valor em dB, melhor o isolamento.",
      },
      {
        q: "O que é PoE (Power over Ethernet)?",
        o: [
          "Tecnologia que fornece energia elétrica e dados pelo mesmo cabo de rede",
          "Protocolo de roteamento para redes ópticas",
          "Método de criptografia para Ethernet",
          "Padrão de conector para fibra óptica",
        ],
        c: 0,
        e: "PoE (IEEE 802.3af/at/bt) permite alimentar dispositivos como access points, câmeras IP e telefones VoIP pelo próprio cabo Ethernet, eliminando a necessidade de fonte de energia separada. Requer switch PoE ou injetor PoE.",
        x: "802.3af (PoE): até 15.4W. 802.3at (PoE+): até 30W. 802.3bt (PoE++): até 60-100W. Usa pares sobressalentes do cabo ou sobreposição nos pares de dados.",
      },
      {
        q: "Qual a diferença entre cabos UTP, STP e FTP?",
        o: [
          "UTP: sem blindagem. STP: blindagem por par. FTP: blindagem geral (folha)",
          "São todos iguais, apenas marcas diferentes",
          "UTP é para 1 Gbps, STP para 10 Gbps, FTP para 100 Gbps",
          "UTP é cobre, STP é fibra, FTP é coaxial",
        ],
        c: 0,
        e: "UTP (Unshielded Twisted Pair): sem blindagem, mais flexível e barato. FTP (Foiled TP) / F/UTP: uma folha metálica envolvendo todos os pares. STP (Shielded TP) / S/FTP: blindagem individual por par + geral. Blindagem reduz EMI.",
        x: "Notação ISO: X/Y TP. X = blindagem geral (U=nenhuma, F=folha, S=malha). Y = blindagem por par (U=nenhuma, F=folha). Ex: S/FTP = malha geral + folha por par.",
      },
      {
        q: "O que é o backbone (cabeamento vertical) em cabeamento estruturado?",
        o: [
          "Cabeamento que interconecta salas de telecomunicações entre andares diferentes",
          "O cabo que liga o computador ao switch",
          "O servidor central da rede",
          "O roteador principal do edifício",
        ],
        c: 0,
        e: "O backbone (ou cabeamento vertical) conecta as salas de telecomunicações (TR) dos diversos andares à sala de equipamentos principal (ER). Geralmente usa fibra óptica para suportar maiores distâncias e largura de banda.",
        x: "Backbone vertical: entre andares (TR↔ER). Cabeamento horizontal: do TR até a estação de trabalho (máx 90m). Norma TIA-568: backbone usa fibra (multimodo até 2000m, monomodo até 3000m) ou cobre (até 800m).",
      },
      {
        q: "Qual ferramenta é usada para testar continuidade e mapeamento de pinos em cabos UTP?",
        o: [
          "Testador de cabos (cable tester)",
          "Alicate de crimpagem",
          "Decapador de cabos",
          "Multímetro digital",
        ],
        c: 0,
        e: "O testador de cabos (cable tester) verifica se os 8 fios estão corretamente conectados pino a pino, identificando cabos rompidos, curtos, pares trocados ou abertos. Modelos avançados (certificadores) medem atenuação, NEXT, return loss.",
        x: "Tester básico: apenas continuidade e mapeamento. Qualificador: testa para velocidades específicas (1G, 10G). Certificador (Fluke, etc.): mede todos os parâmetros para certificação Cat5e/6/6A.",
      },
    ],
    Difícil: [
      {
        q: "No padrão TIA-568B, qual é a sequência correta dos pares de fios no conector RJ-45?",
        o: [
          "Branco-Laranja, Laranja, Branco-Verde, Azul, Branco-Azul, Verde, Branco-Marrom, Marrom",
          "Branco-Verde, Verde, Branco-Laranja, Azul, Branco-Azul, Laranja, Branco-Marrom, Marrom",
          "Branco-Laranja, Laranja, Branco-Azul, Verde, Branco-Verde, Azul, Branco-Marrom, Marrom",
          "Laranja, Branco-Laranja, Verde, Branco-Verde, Azul, Branco-Azul, Marrom, Branco-Marrom",
        ],
        c: 0,
        e: "TIA-568B (mais comum): pinos 1-8 = BL, L, BV, Az, BAz, V, BM, M. TIA-568A troca os pares laranja e verde: BV, V, BL, Az, BAz, L, BM, M. Cabo crossover usa 568A numa ponta e 568B na outra; cabo direto (straight) usa o mesmo padrão em ambas.",
        x: "568B: 1-BL 2-L 3-BV 4-Az 5-BAz 6-V 7-BM 8-M. Mnemônico: 'OoGbBgBbB' (Orange, green, blue em pares). Pinos de dados Ethernet (10/100): 1,2 (TX) e 3,6 (RX).",
      },
      {
        q: "Em cabeamento estruturado, qual é a diferença entre os testes de certificação 'channel' e 'permanent link'?",
        o: [
          "Channel inclui os patch cords (até 100m); permanent link testa apenas o cabeamento fixo (até 90m)",
          "Channel testa apenas fibra; permanent link testa cobre",
          "Não há diferença — são sinônimos",
          "Channel é usado em Cat5e; permanent link em Cat6",
        ],
        c: 0,
        e: "Permanent link testa o cabeamento fixo entre o patch panel e a tomada (até 90m), excluindo patch cords. Channel testa o caminho completo ponta a ponta incluindo patch cords (até 100m). Channel é mais realista pois inclui mais conexões.",
        x: "Permanent link: patch panel → cabeamento horizontal → tomada (90m). Channel: equipment cord + patch panel → cabeamento → tomada → work area cord (100m). Mais conexões = mais atenuação.",
      },
      {
        q: "O que é alien crosstalk (AXT) e a partir de qual categoria de cabeamento ele se tornou requisito de teste?",
        o: [
          "Interferência entre cabos adjacentes no mesmo feixe; Cat6A foi a primeira a exigir esse teste",
          "Interferência entre pares do mesmo cabo; Cat5e já exigia",
          "Atenuação causada por temperatura; Cat7 introduziu",
          "Reflexão de sinal em conectores; todas as categorias exigem",
        ],
        c: 0,
        e: "Alien crosstalk (AXT) é a interferência eletromagnética entre cabos diferentes (não entre pares do mesmo cabo). Com frequências mais altas (500 MHz em Cat6A), a proximidade entre cabos causa interferência significativa. Cat6A introduziu testes obrigatórios de AXT.",
        x: "Cat6: até 250 MHz, AXT não exigido. Cat6A: até 500 MHz, AXT obrigatório. Mitigação: blindagem (F/UTP ou S/FTP), maior espaçamento entre cabos. ANEXT: Alien NEXT. AFEXT: Alien FEXT.",
      },
      {
        q: "O que é um OTDR e para que é utilizado?",
        o: [
          "Reflectometro óptico que testa e localiza falhas em fibra óptica",
          "Analisador de protocolo para redes Ethernet",
          "Ferramenta de crimpagem de conectores RJ-45",
          "Software de projeção de cabeamento estruturado",
        ],
        c: 0,
        e: "OTDR (Optical Time Domain Reflectometer) envia pulsos de luz na fibra e analisa as reflexões. Permite medir atenuação, localizar emendas, conectores e pontos de ruptura com precisão de metros. Essencial para certificação de fibra.",
        x: "OTDR gera um traço (trace) mostrando distância × potência. Eventos reflexivos (conectores) aparecem como picos; eventos não-reflexivos (emendas por fusão) aparecem como degraus. Alternativa: power meter + light source.",
      },
      {
        q: "Qual padrão Ethernet opera a 10 Gbps sobre par trançado (cobre)?",
        o: [
          "10GBASE-T (IEEE 802.3an)",
          "1000BASE-T (IEEE 802.3ab)",
          "100BASE-TX (IEEE 802.3u)",
          "10GBASE-SR (IEEE 802.3ae)",
        ],
        c: 0,
        e: "10GBASE-T (IEEE 802.3an) opera a 10 Gbps sobre cabo de par trançado. Requer Cat6A para 100m ou Cat6 para ~55m. Usa todos os 4 pares do cabo e modulação PAM-16. 10GBASE-SR é fibra multimodo.",
        x: "100BASE-TX: 100 Mbps, Cat5, 100m. 1000BASE-T: 1 Gbps, Cat5e, 100m. 10GBASE-T: 10 Gbps, Cat6A, 100m. O 'T' indica par trançado; 'SR/LR' indicam fibra curta/longa.",
      },
      {
        q: "Qual a diferença entre emenda por fusão e emenda mecânica em fibra óptica?",
        o: [
          "Fusão: permanente, baixa perda (~0.02 dB). Mecânica: temporária, maior perda (~0.3 dB)",
          "São a mesma técnica com nomes diferentes",
          "Fusão é para multimodo; mecânica para monomodo",
          "Mecânica requer equipamento mais caro",
        ],
        c: 0,
        e: "Emenda por fusão: usa máquina fusora que derrete e une as extremidades da fibra. Perda típica: 0.02 dB. Permanente e robusta. Emenda mecânica: alinha as fibras mecanicamente com gel de índice. Perda: ~0.3 dB. Mais rápida, mas menos confiável.",
        x: "Fusão: máquina fusora (~R$ 15-80k), perda ≤0.05 dB, permanente. Mecânica: conector mecânico (~R$ 30-50/emenda), perda ~0.3 dB, provisória. Para certificação, fusão é preferida.",
      },
      {
        q: "O que é delay skew em cabeamento de rede e por que é importante em Gigabit Ethernet?",
        o: [
          "Diferença no tempo de propagação entre os 4 pares do cabo; Gigabit usa todos os pares simultaneamente",
          "Atraso causado pela distância do cabo",
          "Tempo de resposta do servidor DNS",
          "Latência adicionada pela criptografia",
        ],
        c: 0,
        e: "Delay skew é a diferença de tempo de propagação entre os pares de um cabo UTP. Gigabit e 10G Ethernet usam os 4 pares simultaneamente — se os sinais chegarem em tempos muito diferentes, ocorrem erros. Limite: ≤45 ns em 100m.",
        x: "Fast Ethernet (100 Mbps): usa 2 pares → delay skew menos crítico. Gigabit (1000BASE-T): usa 4 pares em transmissão simultânea → delay skew ≤45 ns exigido. Causa: diferenças físicas de trançagem entre pares.",
      },
    ],
  },

  // ── DNS, DHCP e NAT ──
  "DNS, DHCP e NAT": {
    Fácil: [
      {
        q: "Qual é a principal função do DNS (Domain Name System)?",
        o: [
          "Traduzir nomes de domínio em endereços IP",
          "Atribuir IPs automaticamente",
          "Criptografar dados na rede",
          "Filtrar pacotes maliciosos",
        ],
        c: 0,
        e: "O DNS funciona como uma 'lista telefônica' da internet: converte nomes legíveis (ex: google.com) em endereços IP numéricos (ex: 142.250.80.46) que os computadores usam para se comunicar.",
        x: "Sem DNS, você precisaria digitar 142.250.80.46 em vez de google.com. O DNS resolve queries recursivas e iterativas através de uma hierarquia: Root → TLD (.com) → Autoritativo (google.com).",
      },
      {
        q: "O que o DHCP faz automaticamente para os dispositivos em uma rede?",
        o: [
          "Atribui endereços IP, máscara, gateway e DNS automaticamente",
          "Traduz nomes de domínio para IPs",
          "Filtra pacotes maliciosos na rede",
          "Criptografa a comunicação entre dispositivos",
        ],
        c: 0,
        e: "DHCP (Dynamic Host Configuration Protocol) configura automaticamente os parâmetros de rede: endereço IP, máscara de sub-rede, gateway padrão e servidores DNS. Elimina a necessidade de configuração manual em cada dispositivo.",
        x: "Sem DHCP: cada dispositivo precisa de IP, máscara, gateway e DNS configurados manualmente. Com DHCP: o dispositivo recebe tudo ao se conectar. Portas UDP 67 (servidor) e 68 (cliente).",
      },
      {
        q: "O que é NAT (Network Address Translation)?",
        o: [
          "Técnica que traduz endereços IP privados para públicos ao acessar a internet",
          "Protocolo que atribui IPs automaticamente",
          "Serviço que resolve nomes de domínio",
          "Mecanismo de criptografia de pacotes",
        ],
        c: 0,
        e: "NAT traduz endereços IP privados (ex: 192.168.1.x) em endereços IP públicos para que dispositivos internos acessem a internet. O roteador mantém uma tabela de tradução para encaminhar respostas ao dispositivo correto.",
        x: "Sem NAT: cada dispositivo precisaria de um IP público. Com NAT: toda a rede interna compartilha um ou poucos IPs públicos. Tipos: Static NAT (1:1), Dynamic NAT (pool), PAT/overload (muitos:1).",
      },
      {
        q: "Qual porta o DNS utiliza por padrão?",
        o: ["Porta 53", "Porta 80", "Porta 443", "Porta 25"],
        c: 0,
        e: "O DNS usa a porta 53. Consultas normais usam UDP/53 (rápido, resposta curta). Transferências de zona (AXFR) e respostas grandes usam TCP/53. DNS sobre HTTPS (DoH) usa 443; DNS sobre TLS (DoT) usa 853.",
        x: "UDP/53: consultas DNS normais (<512 bytes, ou com EDNS0 até ~4096 bytes). TCP/53: transferência de zona, respostas truncadas. DoH: 443. DoT: 853.",
      },
      {
        q: "O que acontece quando o lease DHCP de um dispositivo expira?",
        o: [
          "O dispositivo precisa renovar ou obter um novo endereço IP",
          "O IP se torna permanente",
          "O dispositivo é bloqueado da rede",
          "Nada acontece",
        ],
        c: 0,
        e: "Quando o lease expira, o IP volta ao pool do servidor DHCP. O cliente tenta renovar em 50% do lease (T1) e 87.5% (T2). Se não conseguir renovar, perde o IP e reinicia o processo DORA para obter um novo.",
        x: "Renovação: T1 (50% do lease, unicast ao servidor). T2 (87.5%, broadcast). Expiração: perde o IP. Em Windows, recebe APIPA (169.254.x.x) se não houver servidor DHCP.",
      },
      {
        q: "O que acontece se o servidor DNS ficar indisponível?",
        o: [
          "O dispositivo não consegue traduzir nomes em IPs, impedindo acesso por nome de domínio",
          "A internet para completamente",
          "Os IPs de todos os dispositivos mudam",
          "Os dados enviados são perdidos",
        ],
        c: 0,
        e: "Sem DNS, o dispositivo não resolve nomes como google.com para IPs. O acesso por IP direto (ex: 142.250.80.46) ainda funciona. Por isso, configuram-se dois servidores DNS (primário e secundário) para redundância.",
        x: "Teste sem DNS: `ping 8.8.8.8` funciona (IP direto), mas `ping google.com` falha (precisa de DNS). Cache DNS local pode manter resoluções recentes. Servidores DNS secundários garantem redundância.",
      },
      {
        q: "Qual a diferença entre IP estático e IP dinâmico (via DHCP)?",
        o: [
          "Estático: configurado manualmente, fixo. Dinâmico: atribuído pelo DHCP, pode mudar",
          "São a mesma coisa",
          "Estático é mais rápido",
          "Dinâmico é mais seguro",
        ],
        c: 0,
        e: "IP estático é configurado manualmente e não muda — ideal para servidores, impressoras de rede e roteadores. IP dinâmico é atribuído automaticamente pelo DHCP e pode mudar a cada renovação de lease.",
        x: "Estático: servidores (DNS, web, e-mail), impressoras, roteadores — precisam de IP fixo para serem encontrados. Dinâmico: estações de trabalho, celulares — facilita a administração em redes grandes.",
      },
    ],
    Médio: [
      {
        q: "No processo DHCP, qual é a sequência correta das mensagens trocadas (DORA)?",
        o: [
          "Discover → Offer → Request → Acknowledge",
          "Demand → Offer → Reply → Accept",
          "Discover → Open → Request → Assign",
          "Detect → Offer → Register → Acknowledge",
        ],
        c: 0,
        e: "DORA: 1) Discover (cliente broadcast: 'preciso de IP'). 2) Offer (servidor: 'ofereço esse IP'). 3) Request (cliente: 'aceito esse IP'). 4) Acknowledge (servidor: 'IP confirmado, é seu por X tempo'). Todas as mensagens usam UDP nas portas 67 (servidor) e 68 (cliente).",
        x: "Discover: broadcast 255.255.255.255, src 0.0.0.0. Offer: servidor responde com IP proposto + máscara + gateway + DNS + lease time. Request: cliente confirma escolha. ACK: servidor finaliza.",
      },
      {
        q: "Qual tipo de registro DNS é usado para apontar um domínio para um endereço IPv4?",
        o: ["Registro A", "Registro MX", "Registro CNAME", "Registro PTR"],
        c: 0,
        e: "Registro A (Address): mapeia nome de domínio → endereço IPv4. AAAA: IPv6. MX: servidor de email. CNAME: alias para outro domínio. PTR: resolução reversa (IP → nome). NS: servidor DNS autoritativo.",
        x: "Exemplo: google.com → A → 142.250.80.46. CNAME: mail.google.com → googlemail.l.google.com. Comando: `nslookup -type=A google.com` ou `dig A google.com`.",
      },
      {
        q: "O que é DHCP Relay e quando ele é necessário?",
        o: [
          "Encaminha mensagens DHCP entre sub-redes diferentes quando o servidor está em outra rede",
          "Replica o servidor DHCP para redundância",
          "Renova os leases automaticamente",
          "Bloqueia requisições DHCP suspeitas",
        ],
        c: 0,
        e: "DHCP Relay é necessário quando cliente e servidor DHCP estão em sub-redes diferentes. Como o Discover é broadcast (não atravessa roteadores), o relay agent captura o broadcast e encaminha como unicast ao servidor DHCP remoto.",
        x: "Cisco: `ip helper-address 10.0.0.100`. O relay converte broadcast → unicast e adiciona o campo giaddr (endereço da interface) para o servidor saber de qual sub-rede veio o pedido.",
      },
      {
        q: "Qual registro DNS é usado para indicar o servidor de e-mail de um domínio?",
        o: ["Registro MX", "Registro A", "Registro CNAME", "Registro NS"],
        c: 0,
        e: "MX (Mail Exchanger) indica o servidor responsável por receber e-mails para aquele domínio. Cada registro MX tem um valor de prioridade (preferência) — menor número = maior prioridade.",
        x: "Exemplo: gmail.com MX 5 gmail-smtp-in.l.google.com. Prioridade 5 = preferêncial. Se o servidor principal falhar, tenta o MX de prioridade 10, 20 etc. (fallback).",
      },
      {
        q: "Qual a diferença entre DNS recursivo e DNS autoritativo?",
        o: [
          "Recursivo consulta outros servidores em nome do cliente; autoritativo responde com dados próprios",
          "São a mesma coisa",
          "Recursivo é mais rápido que autoritativo",
          "Autoritativo faz cache; recursivo não",
        ],
        c: 0,
        e: "Recursivo (resolver): recebe a consulta do cliente e busca a resposta percorrendo a hierarquia DNS (root → TLD → autoritativo). Faz cache. Autoritativo: é a fonte oficial dos registros de um domínio, responde com dados definitivos.",
        x: "Recursivo: 8.8.8.8 (Google), 1.1.1.1 (Cloudflare) — fazem a busca para o cliente. Autoritativo: ns1.exemplo.com — tem os registros reais do domínio. O recursivo consulta o autoritativo.",
      },
      {
        q: "O que é um registro CNAME no DNS?",
        o: [
          "Alias que aponta um domínio para outro domínio (não diretamente para um IP)",
          "Registro que mapeia nome para IPv4",
          "Registro de servidor de e-mail",
          "Registro de resolução reversa",
        ],
        c: 0,
        e: "CNAME (Canonical Name) cria um alias: um domínio aponta para outro. Ex: www.site.com CNAME site.com. O navegador resolve o CNAME até encontrar um registro A (IPv4) ou AAAA (IPv6). CNAME não pode coexistir com outros registros no mesmo nome.",
        x: "www.google.com CNAME www.google.com.cdn.cloudflare.net → depois resolve o A desse destino. CNAME não pode ser usado na raiz do domínio (ex: google.com) — use ALIAS/ANAME (extensão não-padrão).",
      },
      {
        q: "O que é DHCP Snooping e qual seu objetivo?",
        o: [
          "Recurso de segurança no switch que filtra mensagens DHCP não autorizadas",
          "Monitor de tráfego DNS",
          "Ferramenta de atribuição de IPs estáticos",
          "Protocolo de roteamento dinâmico",
        ],
        c: 0,
        e: "DHCP Snooping é um recurso de segurança L2 que classifica portas como confiáveis (trusted) ou não confiáveis (untrusted). Apenas portas trusted podem enviar DHCP Offer/ACK, prevenindo servidores DHCP falsos (rogue DHCP).",
        x: "Porta trusted: conectada ao servidor DHCP legítimo. Untrusted: todas as outras. Se um atacante ligar um DHCP falso em porta untrusted, os Offers são descartados. Também cria binding table (MAC↔IP↔porta).",
      },
    ],
    Difícil: [
      {
        q: "No NAT tipo PAT (Port Address Translation), como múltiplos dispositivos compartilham um único IP público?",
        o: [
          "Cada conexão interna recebe uma porta de origem diferente no IP público",
          "Cada dispositivo recebe um IP público temporário",
          "As conexões são multiplexadas por MAC address",
          "O roteador alterna o IP público entre os dispositivos",
        ],
        c: 0,
        e: "PAT (também chamado NAT overload) mapeia múltiplos IPs privados para UM IP público usando portas diferentes. O roteador mantém uma tabela de tradução: (IP_privado:porta_interna) ↔ (IP_público:porta_externa). Isso permite milhares de conexões simultâneas com um único IP público.",
        x: "Exemplo: PC1 (192.168.1.10:5000) → NAT → (200.1.1.1:40001). PC2 (192.168.1.11:5000) → NAT → (200.1.1.1:40002). Ambos usam o mesmo IP público, diferenciados pela porta.",
      },
      {
        q: "O que são ataques de DNS Cache Poisoning e como o DNSSEC protege contra eles?",
        o: [
          "Injeção de registros DNS falsos no cache; DNSSEC usa assinaturas digitais para validar respostas",
          "Sobrecarga do servidor DNS; DNSSEC limita conexões",
          "Interceptação de queries DNS; DNSSEC criptografa o tráfego",
          "Sequestro do domínio no registrar; DNSSEC bloqueia transferências",
        ],
        c: 0,
        e: "DNS Cache Poisoning: atacante injeta respostas DNS falsas no cache de um resolver, redirecionando usuários para IPs maliciosos. DNSSEC adiciona assinaturas digitais (RRSIG) aos registros, permitindo validar autenticidade e integridade das respostas.",
        x: "DNSSEC usa cadeia de confiança: Root → TLD → Domínio, com chaves KSK e ZSK. Registros: DNSKEY, RRSIG, DS, NSEC/NSEC3. Nota: DNSSEC não criptografa — apenas autentica.",
      },
      {
        q: "Qual a diferença entre NAT estático, NAT dinâmico e PAT (Port Address Translation)?",
        o: [
          "Estático: 1:1 fixo. Dinâmico: pool de IPs públicos. PAT: múltiplos privados compartilham 1 público via portas",
          "Todos são sinônimos para a mesma técnica",
          "Estático usa IPv6, dinâmico usa IPv4 e PAT usa ambos",
          "A diferença é apenas na velocidade de tradução",
        ],
        c: 0,
        e: "NAT Estático: mapeamento fixo 1:1 (ideal para servidores). NAT Dinâmico: usa pool de IPs públicos sob demanda. PAT (overload): múltiplos IPs privados compartilham um único IP público, diferenciados por portas de origem. PAT é o mais usado.",
        x: "Estático: 10.0.0.5 ↔ 200.1.1.5 (sempre). Dinâmico: 10.0.0.x → próximo IP do pool 200.1.1.10-20. PAT: 10.0.0.x:porta → 200.1.1.1:porta_aleatória. PAT é padrão em roteadores domésticos.",
      },
      {
        q: "O que é NAT64 e para que serve?",
        o: [
          "Traduz IPv6 ↔ IPv4, permitindo hosts IPv6-only acessarem serviços IPv4",
          "Traduz endereços MAC em endereços IPv6",
          "Comprime cabeçalhos NAT para economizar banda",
          "Duplica o número de portas disponíveis no PAT",
        ],
        c: 0,
        e: "NAT64 permite que redes exclusivamente IPv6 se comuniquem com serviços IPv4, traduzindo cabeçalhos entre os dois protocolos. É uma solução de transição para a coexistência IPv4/IPv6 durante a migração.",
        x: "NAT64 geralmente opera com DNS64, que sintetiza registros AAAA para domínios que só têm registros A (IPv4). O prefixo 64:ff9b::/96 é usado para mapear endereços IPv4 dentro de IPv6.",
      },
      {
        q: "Qual a diferença entre DNS sobre HTTPS (DoH) e DNS sobre TLS (DoT)?",
        o: [
          "DoH usa porta 443 (misturado com HTTPS); DoT usa porta 853 (canal TLS dedicado)",
          "São a mesma coisa com nomes diferentes",
          "DoH é mais antigo que DoT",
          "DoT não é criptografado",
        ],
        c: 0,
        e: "DoH (RFC 8484): encapsula queries DNS em HTTPS na porta 443, tornando o tráfego DNS indistinguível de navegação web. DoT (RFC 7858): usa TLS na porta dedicada 853, permitindo que administradores identifiquem e controlem o tráfego DNS.",
        x: "DoH: porta 443, difícil de bloquear/filtrar (confunde com HTTPS). DoT: porta 853, fácil de identificar/bloquear. Ambos criptografam queries DNS. DoH preferido por navegadores; DoT preferido por administradores de rede.",
      },
      {
        q: "O que é CGNAT (Carrier-Grade NAT) e por que foi necessário?",
        o: [
          "NAT em larga escala feito pelo ISP, compartilhando IPs públicos entre múltiplos clientes devido à exaustão de IPv4",
          "NAT exclusivo para redes domésticas",
          "Tradução de endereços MAC para IP",
          "Protocolo de roteamento para ISPs",
        ],
        c: 0,
        e: "CGNAT (RFC 6888) é NAT feito pelo provedor de internet, não pelo roteador do cliente. Múltiplos clientes compartilham o mesmo IP público. Foi necessário pela exaustão de endereços IPv4. Bloco reservado: 100.64.0.0/10.",
        x: "Problema: 4.3 bilhões de IPs IPv4 esgotados. CGNAT: ISP dá IP privado (100.64.x.x) ao cliente, que já faz NAT internamente → duplo NAT. Desvantagens: dificulta P2P, port forwarding e rastreamento.",
      },
      {
        q: "O que são registros NSEC e NSEC3 no DNSSEC?",
        o: [
          "Provam autenticamente que um domínio NÃO existe (prova de inexistência)",
          "Criptografam as queries DNS",
          "Armazenam chaves públicas do domínio",
          "Indicam servidores DNS autoritativos",
        ],
        c: 0,
        e: "NSEC e NSEC3 permitem que o resolver verifique que um nome de domínio realmente não existe (authenticated denial of existence). NSEC lista o próximo nome existente na zona; NSEC3 usa hashes para evitar enumeração de zona (zone walking).",
        x: "NSEC: 'Entre aaa.com e bbb.com não há nada' — permite zone walking (listar todos os nomes). NSEC3: usa hash dos nomes → impede enumeração. NSEC3 é preferido por segurança.",
      },
    ],
  },

  // ── Endereçamento IP e Sub-redes ──
  "Endereçamento IP e Sub-redes": {
    Fácil: [
      {
        q: "Qual das seguintes é uma faixa de endereços IP privados (classe C)?",
        o: [
          "192.168.0.0 a 192.168.255.255",
          "200.0.0.0 a 200.255.255.255",
          "172.0.0.0 a 172.255.255.255",
          "10.0.0.0 a 10.0.0.255",
        ],
        c: 0,
        e: "A RFC 1918 define três faixas de IPs privados: Classe A: 10.0.0.0/8 (10.0.0.0 a 10.255.255.255). Classe B: 172.16.0.0/12 (172.16.0.0 a 172.31.255.255). Classe C: 192.168.0.0/16 (192.168.0.0 a 192.168.255.255).",
        x: "IPs privados não são roteados na internet. Uso: redes internas/domésticas. Para acessar a internet, precisam de NAT. Note: 172.0.0.0 não é toda privada — apenas 172.16.0.0 a 172.31.255.255.",
      },
      {
        q: "Qual é a máscara de sub-rede padrão de uma rede classe C?",
        o: [
          "255.255.255.0 (/24)",
          "255.0.0.0 (/8)",
          "255.255.0.0 (/16)",
          "255.255.255.128 (/25)",
        ],
        c: 0,
        e: "Classes de IP e máscaras padrão: Classe A (1.0–126.x) → /8 = 255.0.0.0. Classe B (128.0–191.x) → /16 = 255.255.0.0. Classe C (192.0–223.x) → /24 = 255.255.255.0. Sistema classful é obsoleto mas cobrado em provas.",
        x: "Classe A: /8 (16M hosts). Classe B: /16 (65K hosts). Classe C: /24 (254 hosts). CIDR (Classless) substituiu: permite qualquer máscara (/1 a /32), independente da 'classe'.",
      },
      {
        q: "O endereço 127.0.0.1 é utilizado para qual finalidade?",
        o: [
          "Loopback — referência ao próprio dispositivo (localhost)",
          "Gateway padrão da rede",
          "Endereço de broadcast",
          "Primeiro IP utilizável em qualquer rede",
        ],
        c: 0,
        e: "O endereço 127.0.0.1 (faixa 127.0.0.0/8) é reservado para loopback: o tráfego nunca sai da máquina. Usado para testes locais e comunicação entre processos. 'localhost' é o nome associado.",
        x: "127.0.0.0/8: 16M endereços para loopback (só 127.0.0.1 é comumente usado). `ping 127.0.0.1` testa a pilha TCP/IP local. Em IPv6, o loopback é ::1.",
      },
      {
        q: "Quais são os três intervalos de endereços IP privados definidos pela RFC 1918?",
        o: [
          "10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16",
          "10.0.0.0/16, 172.16.0.0/8, 192.168.0.0/24",
          "127.0.0.0/8, 169.254.0.0/16, 10.0.0.0/8",
          "192.0.0.0/8, 172.0.0.0/8, 10.0.0.0/8",
        ],
        c: 0,
        e: "RFC 1918 define 3 faixas privadas: 10.0.0.0/8 (16M hosts), 172.16.0.0/12 (1M hosts), 192.168.0.0/16 (65K hosts). Esses IPs não são roteáveis na internet — precisam de NAT para sair.",
        x: "Classe A privada: 10.0.0.0–10.255.255.255. Classe B privada: 172.16.0.0–172.31.255.255. Classe C privada: 192.168.0.0–192.168.255.255. Redes domésticas usam 192.168.x.x.",
      },
      {
        q: "O que é um endereço de broadcast em uma rede IP?",
        o: [
          "Endereço que envia pacote para todos os hosts da rede",
          "Endereço do roteador padrão",
          "Primeiro IP utilizável da sub-rede",
          "Endereço reservado para DNS",
        ],
        c: 0,
        e: "O endereço de broadcast é o último da sub-rede (todos os bits de host = 1). Pacotes enviados para este endereço são entregues a TODOS os hosts da rede. Ex: na rede 192.168.1.0/24, o broadcast é 192.168.1.255.",
        x: "Broadcast: todos os bits de host = 1. Endereço de rede: todos = 0. Nenhum dos dois pode ser atribuído a hosts. Broadcast limitado: 255.255.255.255 (não cruza roteadores).",
      },
      {
        q: "O que é uma máscara de sub-rede?",
        o: [
          "Número que define quais bits do IP identificam a rede e quais identificam o host",
          "Endereço IP do roteador principal",
          "Senha de acesso à rede",
          "Identificador do fabricante do equipamento",
        ],
        c: 0,
        e: "A máscara de sub-rede separa a parte de rede da parte de host em um endereço IP. Bits 1 = rede, bits 0 = host. Ex: 255.255.255.0 = /24 (24 bits de rede, 8 de host). Dispositivos na mesma rede compartilham a mesma parte de rede.",
        x: "255.255.255.0 = 11111111.11111111.11111111.00000000 = /24. Os '1s' identificam a rede; os '0s' identificam o host. IP 192.168.1.10 com /24: rede = 192.168.1, host = .10.",
      },
      {
        q: "O endereço 192.168.1.0 em uma rede /24 pode ser atribuído a um host?",
        o: [
          "Não — é o endereço de rede, reservado",
          "Sim — é um endereço normal",
          "Apenas para servidores",
          "Apenas para roteadores",
        ],
        c: 0,
        e: "O primeiro endereço de uma sub-rede (todos os bits de host = 0) é o endereço de rede e não pode ser atribuído a nenhum dispositivo. O último (todos os bits = 1) é o broadcast. Ambos são reservados.",
        x: "Rede 192.168.1.0/24: .0 = endereço de rede (reservado). .255 = broadcast (reservado). Hosts válidos: .1 a .254 (254 hosts). Todo cálculo de sub-rede desconta esses 2 endereços.",
      },
    ],
    Médio: [
      {
        q: "Quantos hosts válidos podem existir em uma rede /26?",
        o: ["62", "64", "30", "126"],
        c: 0,
        e: "Uma rede /26 tem 32 - 26 = 6 bits para hosts. 2⁶ = 64 endereços totais. Subtraímos 2 (endereço de rede e broadcast): 64 - 2 = 62 hosts válidos. Máscara /26 = 255.255.255.192.",
        x: "/26 → 6 bits host → 2⁶ = 64. Hosts utilizáveis: 64 - 2 = 62. Primeiro IP: rede. Último IP: broadcast. Exemplo: 192.168.1.0/26 → rede .0, hosts .1 a .62, broadcast .63.",
      },
      {
        q: "Qual é o endereço de broadcast da rede 192.168.10.0/24?",
        o: ["192.168.10.255", "192.168.10.0", "192.168.10.1", "192.168.11.0"],
        c: 0,
        e: "O broadcast é o último endereço da sub-rede — todos os bits de host são 1. Em /24, os últimos 8 bits: 11111111 = 255. Broadcast = 192.168.10.255. O endereço de rede é 192.168.10.0.",
        x: "Rede: .0 (bits host = 0). Broadcast: .255 (bits host = 1). Hosts válidos: .1 a .254 (254 hosts). Gateway geralmente é .1 ou .254. Broadcast entrega pacotes a todos os hosts.",
      },
      {
        q: "Qual a diferença entre IPv4 e IPv6 em termos de tamanho de endereço?",
        o: [
          "IPv4 usa 32 bits; IPv6 usa 128 bits",
          "IPv4 usa 64 bits; IPv6 usa 128 bits",
          "IPv4 usa 32 bits; IPv6 usa 64 bits",
          "Ambos usam 32 bits",
        ],
        c: 0,
        e: "IPv4: 32 bits = 4 octetos (ex: 192.168.1.1) → ~4,3 bilhões de endereços. IPv6: 128 bits = 8 grupos hexadecimais (ex: 2001:0db8::1) → 3,4 × 10³⁸ endereços. IPv6 resolve a escassez de IPv4.",
        x: "IPv4: 2³² ≈ 4,3 × 10⁹. IPv6: 2¹²⁸ ≈ 3,4 × 10³⁸. IPv6 elimina NAT, tem IPsec nativo e autoconfiguração (SLAAC). Formato: 2001:0db8:85a3::8a2e:0370:7334.",
      },
      {
        q: "Qual a máscara de sub-rede para /28 em notação decimal?",
        o: [
          "255.255.255.240",
          "255.255.255.224",
          "255.255.255.248",
          "255.255.255.192",
        ],
        c: 0,
        e: "/28 significa 28 bits de rede e 4 bits de host. Último octeto: 11110000 = 240. Máscara: 255.255.255.240. Hosts: 2⁴ - 2 = 14 hosts válidos por sub-rede.",
        x: "/28 = 255.255.255.240 (14 hosts). /29 = .248 (6 hosts). /30 = .252 (2 hosts, links ponto-a-ponto). /27 = .224 (30 hosts). /26 = .192 (62 hosts).",
      },
      {
        q: "O que é CIDR (Classless Inter-Domain Routing)?",
        o: [
          "Sistema flexível de endereçamento IP que substitui classes fixas",
          "Protocolo de roteamento dinâmico",
          "Método de criptografia de pacotes",
          "Protocolo de transferência de arquivos",
        ],
        c: 0,
        e: "CIDR permite usar qualquer máscara de sub-rede (/1 a /32), sem depender das classes A, B e C tradicionais. Notação: IP/prefixo (ex: 192.168.1.0/24). Permite agregação de rotas (supernetting) e uso eficiente de endereços.",
        x: "Antes (classful): Classe A (/8), B (/16), C (/24) fixos. Com CIDR: qualquer máscara. Exemplo: 200.10.0.0/22 agrega 4 redes /24. CIDR foi definido na RFC 4632.",
      },
      {
        q: "Quantas sub-redes /28 podem ser criadas a partir de uma rede /24?",
        o: ["16", "8", "32", "4"],
        c: 0,
        e: "De /24 para /28: 28 - 24 = 4 bits emprestados para sub-rede. 2⁴ = 16 sub-redes. Cada sub-rede /28 tem 2⁴ - 2 = 14 hosts válidos. Total: 16 sub-redes × 14 hosts = 224 hosts (vs 254 em /24).",
        x: "/24 → /28 = 4 bits extra = 16 sub-redes de 14 hosts. /24 → /26 = 2 bits = 4 sub-redes de 62 hosts. /24 → /25 = 1 bit = 2 sub-redes de 126 hosts. Fórmula: 2^(novo-antigo) sub-redes.",
      },
      {
        q: "Qual a faixa de hosts válidos na sub-rede 10.0.0.64/26?",
        o: [
          "10.0.0.65 a 10.0.0.126",
          "10.0.0.64 a 10.0.0.127",
          "10.0.0.65 a 10.0.0.127",
          "10.0.0.64 a 10.0.0.126",
        ],
        c: 0,
        e: "/26 → 6 bits de host → 64 endereços por sub-rede. Rede: 10.0.0.64. Broadcast: 10.0.0.127 (64 + 63). Hosts válidos: primeiro +1 (10.0.0.65) até broadcast -1 (10.0.0.126) = 62 hosts.",
        x: "Sub-redes /26 em 10.0.0.0/24: .0-.63, .64-.127, .128-.191, .192-.255. Cada bloco: 64 endereços, 62 hosts. Rede 10.0.0.64/26: rede .64, hosts .65-.126, broadcast .127.",
      },
    ],
    Difícil: [
      {
        q: "Você precisa dividir a rede 10.0.0.0/8 em sub-redes que comportem exatamente 500 hosts cada. Qual máscara usar?",
        o: [
          "/23 (255.255.254.0)",
          "/22 (255.255.252.0)",
          "/24 (255.255.255.0)",
          "/25 (255.255.255.128)",
        ],
        c: 0,
        e: "Para 500 hosts: precisamos de n bits tal que 2ⁿ - 2 ≥ 500. 2⁹ = 512 (512-2 = 510 ≥ 500 ✓). 2⁸ = 256 (256-2 = 254 < 500 ✗). Com 9 bits de host: máscara = 32 - 9 = /23 = 255.255.254.0. Cada sub-rede tem 510 hosts utilizáveis.",
        x: "500 hosts → 2⁹ = 512 → /23. Sub-redes: 10.0.0.0/23 (hosts .0.1-.1.254), 10.0.2.0/23 (hosts .2.1-.3.254), etc. Total de sub-redes possíveis: 2^(23-8) = 2¹⁵ = 32.768 sub-redes.",
      },
      {
        q: "O que é VLSM (Variable Length Subnet Masking) e qual sua vantagem?",
        o: [
          "Permite usar máscaras de tamanho diferente em cada sub-rede, otimizando o uso de IPs",
          "Usa uma máscara única para toda a rede",
          "Funciona apenas com IPv6",
          "É um protocolo de roteamento dinâmico",
        ],
        c: 0,
        e: "VLSM permite que diferentes sub-redes tenham máscaras distintas. Em vez de /24 para todas (desperdício se uma sub-rede tem 3 hosts), usa-se /30 para links ponto-a-ponto e /24 para sub-redes maiores.",
        x: "Sem VLSM: todas /24 = 254 hosts (link WAN: 2 hosts, desperdício de 252). Com VLSM: WAN usa /30 (2 hosts), LAN usa /24 (254). Requer protocolos classless (OSPF, EIGRP, RIPv2).",
      },
      {
        q: "Dado o endereço 172.16.45.123/20, qual é o endereço de rede e o broadcast desta sub-rede?",
        o: [
          "Rede: 172.16.32.0 — Broadcast: 172.16.47.255",
          "Rede: 172.16.45.0 — Broadcast: 172.16.45.255",
          "Rede: 172.16.44.0 — Broadcast: 172.16.47.255",
          "Rede: 172.16.40.0 — Broadcast: 172.16.43.255",
        ],
        c: 0,
        e: "/20 = 255.255.240.0. Terceiro octeto 45 em binário: 00101101. Máscara 3º octeto: 11110000. Parte de rede: 00100000 = 32. Rede = 172.16.32.0. Broadcast: 32 + 15 = 47 → 172.16.47.255.",
        x: "Cálculo: /20 → 12 bits host. 45 AND 240 = 32 (rede). 32 OR 15 = 47 (broadcast). Faixa: 172.16.32.0 a 172.16.47.255 = 4096 endereços (4094 hosts).",
      },
      {
        q: "O que é supernetting (superrede) e quando é utilizado?",
        o: [
          "Agregação de múltiplas sub-redes em uma rota única para reduzir tabelas de roteamento",
          "Divisão de uma rede grande em sub-redes menores",
          "Criação de VLANs dentro de uma sub-rede",
          "Duplicação de IPs para redundância",
        ],
        c: 0,
        e: "Supernetting (agregação de rotas / route summarization) combina várias sub-redes contíguas em uma única rota com máscara menor. Exemplo: 4 redes /24 (192.168.0.0–3.0) viram 1 rota /22. Reduz o tamanho da tabela de roteamento.",
        x: "192.168.0.0/24 + .1.0/24 + .2.0/24 + .3.0/24 = 192.168.0.0/22 (1 rota). Requisito: as redes devem ser contíguas e a quantidade deve ser potência de 2.",
      },
      {
        q: "Em IPv6, o que é SLAAC (Stateless Address Autoconfiguration)?",
        o: [
          "Método que permite hosts gerarem IPs automaticamente sem servidor DHCP",
          "Protocolo de roteamento exclusivo para IPv6",
          "Mecanismo de tradução IPv4 para IPv6",
          "Firewall nativo do IPv6",
        ],
        c: 0,
        e: "SLAAC permite que um host IPv6 configure seu próprio endereço combinando o prefixo da rede (obtido via Router Advertisement/NDP) com o identificador da interface (geralmente derivado do MAC via EUI-64 ou aleatório).",
        x: "SLAAC: host recebe prefixo /64 via RA do roteador + gera sufixo. Sem estado no servidor (stateless). DHCPv6: stateful (servidor controla IPs). Ambos usam NDP (Neighbor Discovery Protocol) na base.",
      },
      {
        q: "O que é um endereço link-local em IPv6 e qual seu prefixo?",
        o: [
          "fe80::/10 — autoconfigurado, não roteável, comunicação no mesmo link",
          "2001::/16 — endereço público global",
          "ff00::/8 — multicast",
          "::1/128 — loopback",
        ],
        c: 0,
        e: "Endereços link-local (fe80::/10) são autoconfigurados em TODA interface IPv6 e são válidos apenas no segmento local (não são roteados). São essenciais para NDP (Neighbor Discovery), SLAAC e roteamento local.",
        x: "fe80:: link-local: sempre presente, não roteável. 2001:: global unicast: roteável na internet. ff02:: multicast link-local. ::1 loopback. fc00::/7 unique local (equivalente ao IP privado).",
      },
      {
        q: "Qual é o endereço de rede e broadcast de 192.168.5.130/25?",
        o: [
          "Rede: 192.168.5.128 — Broadcast: 192.168.5.255",
          "Rede: 192.168.5.0 — Broadcast: 192.168.5.255",
          "Rede: 192.168.5.128 — Broadcast: 192.168.5.191",
          "Rede: 192.168.5.129 — Broadcast: 192.168.5.254",
        ],
        c: 0,
        e: "/25 divide em 2 sub-redes de 128 endereços. 130 é > 128 → segunda sub-rede: 192.168.5.128 a 192.168.5.255. Rede: .128 (bits host = 0). Broadcast: .255 (bits host = 1). Hosts: .129 a .254 (126 hosts).",
        x: "/25: 7 bits host = 128 endereços. Sub-rede 1: .0-.127 (hosts .1-.126). Sub-rede 2: .128-.255 (hosts .129-.254). 130 está na sub-rede 2. Cálculo: 130 AND 128 = 128 (rede).",
      },
    ],
  },

  // ── Equipamentos de Rede ──
  "Equipamentos de Rede": {
    Fácil: [
      {
        q: "Qual equipamento opera na Camada 2 (Enlace) do modelo OSI e encaminha quadros com base em endereços MAC?",
        o: ["Switch", "Roteador", "Hub", "Modem"],
        c: 0,
        e: "O switch opera na Camada 2 (Enlace de Dados) e utiliza endereços MAC para encaminhar quadros (frames) apenas para a porta de destino. Diferente do hub (Camada 1), que replica para todas as portas. Roteador opera na Camada 3 (Rede).",
        x: "Hub: Camada 1 (repete sinal em todas as portas). Switch: Camada 2 (encaminha por MAC). Roteador: Camada 3 (encaminha por IP). Switch L3: opera nas camadas 2 e 3.",
      },
      {
        q: "Qual é a função de um roteador em uma rede?",
        o: [
          "Encaminhar pacotes entre redes diferentes com base em endereços IP",
          "Amplificar o sinal elétrico nas portas",
          "Conectar dispositivos na mesma rede local por MAC",
          "Converter sinais digitais em analógicos",
        ],
        c: 0,
        e: "O roteador opera na Camada 3 (Rede) do modelo OSI e encaminha pacotes entre redes diferentes usando endereços IP e tabelas de roteamento. É essencial para conectar LAN à internet (WAN) e segmentar redes.",
        x: "Switch: mesma rede (intra-VLAN). Roteador: redes diferentes (inter-rede). O roteador é o 'gateway padrão'. Funções adicionais comuns: NAT, firewall, DHCP, VPN.",
      },
      {
        q: "O que é um access point (AP) wireless?",
        o: [
          "Dispositivo que permite conexão sem fio (Wi-Fi) à rede cabeada",
          "Roteador com fio para redes grandes",
          "Firewall para redes wireless",
          "Amplificador de sinal de internet via cabo",
        ],
        c: 0,
        e: "O access point cria uma rede sem fio (Wi-Fi) e conecta clientes wireless à rede cabeada. Diferente de um roteador Wi-Fi doméstico, um AP dedicado não faz NAT nem roteamento — apenas bridge entre wireless e wired.",
        x: "Roteador Wi-Fi doméstico = roteador + switch + AP + NAT em um só. AP corporativo: gerenciado por controladora (WLC), múltiplos SSIDs, VLANs, 802.1X.",
      },
      {
        q: "O que é um repetidor (repeater) em redes?",
        o: [
          "Dispositivo que amplifica/regenera o sinal para aumentar o alcance",
          "Equipamento que traduz endereços IP",
          "Filtro de pacotes por regras",
          "Servidor que distribui endereços IP",
        ],
        c: 0,
        e: "O repetidor opera na Camada 1 (Física) e regenera o sinal degradado, estendendo o alcance da rede. Não interpreta dados — simplesmente amplifica. Em redes modernas, foi substituído por switches e APs.",
        x: "Repetidor: Camada 1, regenera sinal. Hub: Camada 1, repetidor multiporta. Switch: Camada 2, encaminha por MAC. Roteador: Camada 3, roteia por IP. Camada mais alta = mais inteligência.",
      },
      {
        q: "Qual equipamento é o 'gateway padrão' de uma rede local?",
        o: ["Roteador", "Switch", "Hub", "Access Point"],
        c: 0,
        e: "O roteador é o gateway padrão — o ponto de saída da rede local para outras redes (internet). Quando um host quer acessar um IP fora de sua sub-rede, envia o pacote para o gateway (IP do roteador na rede local).",
        x: "Gateway padrão: geralmente o primeiro ou último IP da sub-rede (ex: 192.168.1.1 ou .254). Configurado no host ou via DHCP. Sem gateway, o host só se comunica dentro da própria sub-rede.",
      },
      {
        q: "O que é um switch PoE?",
        o: [
          "Switch que fornece energia elétrica e dados pelo mesmo cabo de rede",
          "Switch que opera apenas com fibra óptica",
          "Switch com fonte de energia mais potente",
          "Switch exclusivo para redes sem fio",
        ],
        c: 0,
        e: "Um switch PoE (Power over Ethernet) fornece energia elétrica e dados simultaneamente pelo cabo UTP. Ideal para alimentar access points, câmeras IP e telefones VoIP sem necessidade de tomada elétrica próxima ao dispositivo.",
        x: "PoE (802.3af): 15.4W. PoE+ (802.3at): 30W. PoE++ (802.3bt): 60-100W. Orçamento PoE do switch: soma da potência disponível para todas as portas. Exemplo: switch 24 portas com 370W PoE budget.",
      },
      {
        q: "Qual dispositivo conecta uma rede local (LAN) à internet (WAN)?",
        o: ["Roteador", "Hub", "Repetidor", "Patch panel"],
        c: 0,
        e: "O roteador conecta redes diferentes, como a LAN interna e a internet (WAN). Ele encaminha pacotes entre essas redes usando endereços IP e tabelas de roteamento. O roteador é o gateway padrão da LAN.",
        x: "LAN (rede local) ↔ Roteador ↔ WAN (internet). O roteador faz NAT, DHCP, firewall básico e roteamento. Em empresas: roteador dedicado + switch + AP. Em casa: tudo integrado no 'roteador Wi-Fi'.",
      },
    ],
    Médio: [
      {
        q: "O que é um switch gerenciável (managed switch) e qual sua vantagem sobre um switch não gerenciável?",
        o: [
          "Permite configuração de VLANs, QoS, espelhamento e monitoramento via interface de gestão",
          "É mais rápido que o não gerenciável",
          "Funciona como roteador automaticamente",
          "Tem mais portas que um switch comum",
        ],
        c: 0,
        e: "Switches gerenciáveis permitem configuração avançada: VLANs (segmentação lógica), QoS (priorização de tráfego), port mirroring (espelhamento), SNMP (monitoramento), spanning tree (prevenção de loops), segurança por porta. São acessados via CLI, web ou SNMP.",
        x: "Não gerenciável: plug-and-play, sem configuração. Gerenciável: CLI/Web para VLANs, ACLs, QoS, LLDP, STP, SNMP, port security. Custo maior, mas essencial em redes corporativas.",
      },
      {
        q: "Qual a principal diferença entre um hub e um switch?",
        o: [
          "O hub envia dados para todas as portas; o switch envia apenas para a porta de destino",
          "O hub é mais rápido que o switch",
          "O switch funciona apenas com fibra óptica",
          "O hub opera na Camada 3 e o switch na Camada 1",
        ],
        c: 0,
        e: "Hub (Camada 1): repete o sinal para TODAS as portas, criando um domínio de colisão. Switch (Camada 2): aprende endereços MAC e encaminha quadros APENAS para a porta correta, um domínio de colisão por porta.",
        x: "Hub: banda compartilhada (10 dispositivos × 100Mbps = ~10Mbps cada). Switch: banda dedicada por porta. Hub gera mais colisões. Switch usa tabela MAC (CAM table).",
      },
      {
        q: "O que é um modem e em qual camada do modelo OSI ele atua?",
        o: [
          "Modula/demodula sinais para transmissão; atua na Camada 1 (Física)",
          "Equipamento da Camada 3 que roteia pacotes",
          "Dispositivo da Camada 2 que filtra quadros",
          "Software da Camada 7 que processa dados",
        ],
        c: 0,
        e: "Modem (MOdulador/DEModulador) converte sinais digitais em analógicos para transmissão pelo meio (linha telefônica, cabo, fibra) e vice-versa. Opera na Camada 1 (Física) do modelo OSI.",
        x: "Tipos: ADSL (linha telefônica), cable modem (coaxial/HFC), fibra (ONT/ONU), 4G/5G. O modem da operadora geralmente inclui roteador e Wi-Fi integrados (CPE).",
      },
      {
        q: "O que é a tabela MAC (CAM table) de um switch?",
        o: [
          "Tabela que associa endereços MAC às portas físicas do switch",
          "Tabela de roteamento IP",
          "Lista de VLANs configuradas",
          "Registro de logs de segurança",
        ],
        c: 0,
        e: "A tabela MAC (CAM — Content Addressable Memory) mapeia endereços MAC para portas do switch. Quando o switch recebe um quadro, ele aprende o MAC de origem na porta de entrada e encaminha para a porta associada ao MAC de destino.",
        x: "Aprendizagem: quadro entra na porta 1 com MAC-A → switch grava 'MAC-A = porta 1'. Encaminhamento: destino MAC-B → busca na tabela → porta 3. Se não conhece: flooding (envia para todas).",
      },
      {
        q: "O que é VLAN e qual sua principal vantagem?",
        o: [
          "Rede virtual que segmenta logicamente a rede, mesmo no mesmo switch físico",
          "Rede que só funciona com cabos virtuais",
          "Protocolo de criptografia para switches",
          "Software de gerenciamento de roteadores",
        ],
        c: 0,
        e: "VLAN (Virtual LAN) permite segmentar uma rede física em múltiplas redes lógicas. Portas do mesmo switch podem pertencer a VLANs diferentes (domínios de broadcast separados). Comunicação entre VLANs requer roteamento (roteador ou switch L3).",
        x: "VLAN 10 (vendas) e VLAN 20 (TI) no mesmo switch: isoladas. Trunk (802.1Q): link que transporta múltiplas VLANs entre switches usando tags. Access port: pertence a uma única VLAN.",
      },
      {
        q: "O que é EtherChannel (Link Aggregation) em switches?",
        o: [
          "Agrupamento de múltiplos links físicos em um único link lógico",
          "Protocolo de roteamento dinâmico",
          "Método de criptografia para VLANs",
          "Tipo de cabo para conexões de alta velocidade",
        ],
        c: 0,
        e: "EtherChannel (ou Link Aggregation / LAG) combina 2-8 links físicos em um único link lógico, aumentando a largura de banda e fornecendo redundância. Se um link falhar, o tráfego é redistribuído pelos demais.",
        x: "4 links de 1 Gbps = 1 link lógico de 4 Gbps. Protocolos: LACP (IEEE 802.3ad, negociação automática) e PAgP (Cisco proprietário). STP vê o EtherChannel como uma única porta.",
      },
      {
        q: "O que é um switch Layer 3?",
        o: [
          "Switch que também roteia pacotes usando endereços IP, combinando funções de L2 e L3",
          "Switch com 3 portas de uplink",
          "Switch que opera apenas na Camada 1",
          "Switch exclusivo para fibra óptica",
        ],
        c: 0,
        e: "Um switch L3 combina switching (Camada 2, por MAC) com roteamento (Camada 3, por IP). Faz roteamento inter-VLAN em hardware (ASICs), com desempenho muito superior a um roteador para tráfego interno.",
        x: "Switch L2: encaminha por MAC, não roteia. Switch L3: encaminha por MAC + roteia por IP. Roteador: foco em WAN, NAT, VPN. Switch L3 é ideal para core/distribuição em redes corporativas.",
      },
    ],
    Difícil: [
      {
        q: "Em qual cenário é mais apropriado usar um switch Layer 3 em vez de um roteador tradicional?",
        o: [
          "Roteamento entre VLANs em alta velocidade dentro do campus",
          "Conexão WAN com a internet",
          "VPN site-to-site",
          "Filtragem de pacotes no perímetro da rede",
        ],
        c: 0,
        e: "Switches L3 fazem roteamento inter-VLAN em hardware (ASICs), com latência muito menor e throughput muito maior que roteadores tradicionais. São ideais para roteamento interno (campus/LAN). Roteadores são preferidos para WAN, VPN e funções de perímetro com recursos como NAT e firewall avançado.",
        x: "Switch L3: roteamento LAN/campus inter-VLAN, hardware-based, wire-speed. Roteador: WAN, NAT, VPN, firewall, links seriais/DSL. Em redes grandes, combinam-se ambos: switches L3 internamente e roteadores na borda.",
      },
      {
        q: "Qual é a função do Spanning Tree Protocol (STP) em redes com switches?",
        o: [
          "Prevenir loops de camada 2 bloqueando portas redundantes",
          "Balancear carga de tráfego entre switches",
          "Criptografar o tráfego entre switches",
          "Atribuir VLANs automaticamente às portas",
        ],
        c: 0,
        e: "STP (IEEE 802.1D) previne loops de Camada 2 em redes com links redundantes. Elege um Root Bridge e calcula caminhos livres de loop, bloqueando portas redundantes. RSTP (802.1w) oferece convergência mais rápida.",
        x: "Sem STP: loop → broadcast storm → rede cai. Com STP: Root Bridge eleito (menor Bridge ID). Portas: Root, Designated, Blocked. STP converge em 30-50s. RSTP: < 6s.",
      },
      {
        q: "O que é empilhamento (stacking) de switches e quais benefícios oferece?",
        o: [
          "Conectar múltiplos switches para operarem como uma única unidade lógica",
          "Empilhar switches fisicamente no rack sem conexão",
          "Usar switches de marcas diferentes na mesma rede",
          "Configurar VLANs em switches diferentes automaticamente",
        ],
        c: 0,
        e: "Stacking conecta switches por cabos dedicados de alta velocidade formando um único switch lógico. Um switch master gerencia todo o stack. Benefícios: gerenciamento unificado, tabela MAC única, alta disponibilidade.",
        x: "Exemplos: Cisco StackWise, Juniper Virtual Chassis. Stack link: até 480 Gbps. Stack de 8 switches = 1 switch lógico com N × portas. Diferente de chassis modular.",
      },
      {
        q: "O que é port mirroring (SPAN) e para que é usado?",
        o: [
          "Copia tráfego de uma porta para outra para análise e monitoramento",
          "Bloqueia portas não utilizadas do switch",
          "Duplica a largura de banda de uma porta",
          "Espelha a configuração entre switches",
        ],
        c: 0,
        e: "Port mirroring (SPAN — Switched Port Analyzer) copia todo o tráfego de uma ou mais portas (source) para uma porta de destino (monitor), onde um analisador (Wireshark, IDS) captura os pacotes. Não afeta o tráfego original.",
        x: "SPAN: local (mesmo switch). RSPAN: entre switches (via VLAN). ERSPAN: encapsula em GRE para análise remota via IP. Usado para troubleshooting, IDS/IPS e compliance.",
      },
      {
        q: "O que é um chassis modular de switch e como difere de stacking?",
        o: [
          "Switch com slots para módulos intercambiáveis; stacking une switches separados",
          "São a mesma coisa com nomes diferentes",
          "Chassis modular é mais barato que stacking",
          "Stacking usa fibra e chassis usa cobre",
        ],
        c: 0,
        e: "Chassis modular: um único equipamento com backplane de alta velocidade e slots para line cards, supervisores e fontes redundâncias (ex: Cisco Catalyst 9400). Stacking: múltiplos switches independentes conectados por cabos stack formando uma unidade lógica.",
        x: "Chassis: Cisco 9400/9600, Juniper EX9200. Alto custo, alta resiliência, backplane dedicado. Stacking: Cisco 9200/9300 StackWise. Menor custo, flexibilidade, mas depende de cabos stack.",
      },
      {
        q: "O que é SDN (Software Defined Networking)?",
        o: [
          "Arquitetura que separa o plano de controle do plano de dados, centralizando a inteligência em um controlador",
          "Rede exclusivamente por software, sem hardware",
          "Protocolo de roteamento para data centers",
          "VPN baseada em nuvem",
        ],
        c: 0,
        e: "SDN desacopla o plano de controle (decisões de encaminhamento) do plano de dados (encaminhamento físico). Um controlador central programa os switches via protocolos como OpenFlow. Permite automação, agilidade e visão global da rede.",
        x: "Tradicional: cada switch decide localmente. SDN: controlador central decide, switches só encaminham. Protocolos: OpenFlow, NETCONF, gRPC. Controladores: OpenDaylight, ONOS, VMware NSX.",
      },
      {
        q: "O que é LACP (Link Aggregation Control Protocol) e como funciona?",
        o: [
          "Protocolo IEEE 802.3ad que negocia automaticamente a criação de links agregados entre switches",
          "Protocolo de roteamento dinâmico",
          "Método de autenticação 802.1X",
          "Protocolo de transferência de arquivos",
        ],
        c: 0,
        e: "LACP (IEEE 802.3ad) negocia automaticamente a agregação de links entre switches. Cada lado envia LACPDUs para identificar links compatíveis e formar o port-channel. Modos: active (inicia negociação) e passive (aguarda).",
        x: "LACP modos: active-active ou active-passive (um lado deve ser active). PAgP (Cisco): desirable-desirable ou desirable-auto. LACP é padrão IEEE (interoperável); PAgP é Cisco proprietário.",
      },
    ],
  },

  // ── Firewall e Proxy ──
  "Firewall e Proxy": {
    Fácil: [
      {
        q: "Qual é a função principal de um firewall em uma rede?",
        o: [
          "Filtrar tráfego de rede com base em regras de segurança",
          "Acelerar a conexão com a internet",
          "Atribuir endereços IP",
          "Converter nomes de domínio em IPs",
        ],
        c: 0,
        e: "O firewall atua como barreira entre redes (ex: interna e internet), permitindo ou bloqueando tráfego com base em regras de segurança. Pode filtrar por IP, porta, protocolo, estado da conexão ou conteúdo, dependendo do tipo.",
        x: "Analogia: porteiro de prédio que verifica credenciais. Pode ser: hardware (appliance dedicado), software (Windows Firewall, iptables) ou cloud-based (WAF). Sem firewall, todos os serviços ficam expostos.",
      },
      {
        q: "O que é uma DMZ (Zona Desmilitarizada) em segurança de redes?",
        o: [
          "Rede intermediária entre a rede interna e a internet onde ficam servidores públicos",
          "Área física onde ficam os servidores",
          "Tipo de firewall mais seguro",
          "Protocolo de criptografia",
        ],
        c: 0,
        e: "A DMZ é uma sub-rede isolada entre a rede interna e a internet. Servidores acessíveis externamente (web, email, DNS) ficam na DMZ. Se comprometidos, o atacante não acessa a rede interna diretamente.",
        x: "Topologia: Internet → Firewall → DMZ (servidores públicos) → Firewall → Rede interna. Com duas zonas de firewall, a DMZ tem acesso controlado de ambos os lados.",
      },
      {
        q: "O que é um proxy server (servidor proxy)?",
        o: [
          "Intermediário entre clientes e a internet que filtra e armazena conteúdo em cache",
          "Servidor que atribui endereços IP",
          "Equipamento que interliga redes diferentes",
          "Software que criptografa todo o tráfego",
        ],
        c: 0,
        e: "O proxy atua como intermediário: clientes enviam requisições ao proxy, que as encaminha à internet. Vantagens: cache (acelera acessos repetidos), filtragem de conteúdo, anonimato (esconde IP do cliente) e log de acessos.",
        x: "Exemplo: empresa usa Squid Proxy para bloquear redes sociais e cachear atualizações. Proxy pode ser configurado no navegador ou ser transparente (intercepta na rede). Porta padrão Squid: 3128.",
      },
      {
        q: "Qual a política padrão de firewall considerada mais segura?",
        o: [
          "Negar tudo (deny all) e liberar apenas o necessário",
          "Permitir tudo (allow all) e bloquear o perigoso",
          "Bloquear somente portas conhecidas",
          "Permitir tráfego interno e bloquear externo",
        ],
        c: 0,
        e: "A política 'deny all' (whitelist) bloqueia TUDO por padrão e permite apenas tráfego autorizado explicitamente. É mais segura que 'allow all' (blacklist), que permite tudo e tenta bloquear ameaças conhecidas — deixando brechas.",
        x: "Deny all: regra DENY ALL no final. Administrador cria regras ALLOW específicas (ex: permitir porta 443 para HTTPS). Princípio do menor privilégio aplicado a redes.",
      },
      {
        q: "Em que camadas do modelo OSI opera um firewall de filtragem de pacotes básico?",
        o: [
          "Camada 3 (Rede) e Camada 4 (Transporte)",
          "Apenas Camada 7 (Aplicação)",
          "Camada 1 (Física) e Camada 2 (Enlace)",
          "Todas as 7 camadas",
        ],
        c: 0,
        e: "Firewall de filtragem de pacotes analisa cabeçalhos das Camadas 3 e 4: endereços IP origem/destino (L3), portas e protocolo TCP/UDP (L4). Não inspeciona o conteúdo dos dados (payload). Exemplo clássico: ACLs em roteadores.",
        x: "Packet filter (L3/L4) → Stateful (L3/L4 + estado) → Application Gateway/Proxy (L7) → NGFW (L3-L7 + DPI + IPS). Quanto mais alto na camada, mais contexto e mais overhead.",
      },
      {
        q: "O que é uma regra de firewall?",
        o: [
          "Instrução que define se o tráfego deve ser permitido ou bloqueado com base em critérios",
          "Programa que detecta vírus",
          "Configuração de velocidade da rede",
          "Protocolo de criptografia",
        ],
        c: 0,
        e: "Uma regra de firewall define critérios (IP origem/destino, porta, protocolo) e uma ação (permitir/bloquear/registrar). São avaliadas em ordem (top-down): a primeira regra que combinar é aplicada. A última regra geralmente é 'deny all'.",
        x: "Exemplo: ALLOW TCP src=192.168.1.0/24 dst=ANY port=443 (permite HTTPS da LAN). Regras são avaliadas na ordem: primeira que combina ganha. Regra final: DENY ALL (bloqueia o restante).",
      },
      {
        q: "Qual a diferença entre firewall de hardware e firewall de software?",
        o: [
          "Hardware: appliance dedicado. Software: programa instalado no sistema operacional",
          "São a mesma coisa",
          "Hardware só funciona com Linux",
          "Software é sempre mais seguro",
        ],
        c: 0,
        e: "Firewall de hardware: appliance dedicado (ex: Fortinet, Palo Alto, Cisco ASA) com SO próprio otimizado. Firewall de software: programa instalado no OS (ex: iptables/nftables no Linux, Windows Firewall). Ambos podem coexistir em defesa em profundidade.",
        x: "Hardware: alto desempenho, dedicado, custo elevado. Software: flexível, custo menor, compartilha recursos do host. Empresas usam ambos: appliance na borda + host firewall nos servidores.",
      },
    ],
    Médio: [
      {
        q: "Qual a diferença entre um firewall stateless e um stateful?",
        o: [
          "Stateful rastreia o estado da conexão; stateless analisa pacotes individualmente",
          "Stateless é mais seguro que stateful",
          "Stateful só funciona na Camada 7",
          "Não há diferença prática",
        ],
        c: 0,
        e: "Stateless: analisa cada pacote isoladamente (IP/porta origem/destino). Stateful: mantém uma tabela de estados de conexão, sabendo se um pacote faz parte de uma sessão já estabelecida. Stateful é mais seguro pois impede pacotes forjados que não pertencem a conexões legítimas.",
        x: "Stateless: regra 'permitir porta 80' permite QUALQUER pacote na porta 80. Stateful: só permite respostas de conexões que VOCÊ iniciou. Exemplo: iptables com módulo conntrack (state ESTABLISHED,RELATED).",
      },
      {
        q: "O que é um firewall de próxima geração (NGFW — Next-Generation Firewall)?",
        o: [
          "Firewall que integra inspeção profunda de pacotes, IPS e controle de aplicações",
          "Firewall com mais portas de rede",
          "Versão atualizada do iptables",
          "Firewall exclusivo para redes IPv6",
        ],
        c: 0,
        e: "NGFW combina firewall stateful com funcionalidades avançadas: DPI (Deep Packet Inspection), IPS, controle de aplicações (identifica apps independente da porta), filtragem de URL e integração com threat intelligence.",
        x: "Firewall tradicional: filtra por IP/porta. NGFW: identifica a aplicação (ex: bloqueia WhatsApp na porta 443), inspeciona conteúdo, detecta malware. Exemplos: Palo Alto, Fortinet FortiGate, Cisco Firepower.",
      },
      {
        q: "Qual a diferença entre um IDS e um IPS?",
        o: [
          "IDS detecta e alerta sobre ataques; IPS detecta e bloqueia automaticamente",
          "IDS bloqueia e IPS apenas detecta",
          "Ambos são sinônimos",
          "IDS é hardware e IPS é software",
        ],
        c: 0,
        e: "IDS (Intrusion Detection System): monitora o tráfego e gera alertas quando detecta atividades suspeitas, mas não bloqueia. IPS (Intrusion Prevention System): monitora E bloqueia automaticamente tráfego malicioso em tempo real, posicionado inline.",
        x: "IDS: passivo (cópia do tráfego via SPAN/TAP), apenas alerta. IPS: inline (tráfego passa por ele), bloqueia em tempo real. Tipos: NIDS/NIPS (rede) e HIDS/HIPS (host). Exemplos: Snort, Suricata.",
      },
      {
        q: "O que é um WAF (Web Application Firewall)?",
        o: [
          "Firewall de camada 7 que protege aplicações web contra ataques como SQL Injection e XSS",
          "Firewall de rede que bloqueia IPs maliciosos",
          "Antivírus para servidores web",
          "Software que criptografa páginas web",
        ],
        c: 0,
        e: "WAF opera na Camada 7 (Aplicação), analisando requisições HTTP/HTTPS. Protege contra OWASP Top 10: SQL Injection, XSS, CSRF, etc. Pode ser appliance (hardware), software (ModSecurity) ou cloud (AWS WAF, Cloudflare).",
        x: "WAF vs Firewall de rede: firewall de rede filtra L3/L4 (IP/porta). WAF filtra L7 (parâmetros HTTP, cookies, headers). Ambos são complementares. WAF cloud: protege sem alteração de infra.",
      },
      {
        q: "O que é o conceito de 'security zones' em firewalls modernos?",
        o: [
          "Segmentação lógica da rede em zonas com diferentes níveis de confiança",
          "Criptografia diferenciada por segmento de rede",
          "Backup automático de regras de firewall",
          "Virtualização do hardware do firewall",
        ],
        c: 0,
        e: "Security zones agrupam interfaces/sub-redes com o mesmo nível de confiança. Exemplos clássicos: Trust (interna), Untrust (internet), DMZ (servidores públicos). Políticas são definidas entre zonas (inter-zone), não apenas por IP/porta.",
        x: "Cisco ASA: security levels (0-100). Palo Alto: zone-based policies. Tráfego Trust→Untrust: geralmente permitido. Untrust→Trust: bloqueado por padrão. Intra-zone: mesmo nível, geralmente livre.",
      },
      {
        q: "O que é DPI (Deep Packet Inspection)?",
        o: [
          "Técnica que analisa o conteúdo (payload) dos pacotes, não apenas os cabeçalhos",
          "Método que verifica apenas endereços IP",
          "Protocolo de roteamento avançado",
          "Criptografia de pacotes em trânsito",
        ],
        c: 0,
        e: "DPI examina o conteúdo (payload) dos pacotes além dos cabeçalhos L3/L4. Permite identificar aplicações (YouTube, BitTorrent), detectar malware, filtrar conteúdo e aplicar políticas granulares. É a base dos NGFWs.",
        x: "Sem DPI: vê apenas IP + porta (ex: porta 443 = HTTPS). Com DPI: identifica QUE aplicação usa a porta 443 (Netflix? VPN? WhatsApp?). Trade-off: mais segurança vs mais processamento e questões de privacidade.",
      },
      {
        q: "O que é filtragem de URL em firewalls e proxies?",
        o: [
          "Bloqueio ou liberação de acesso a sites com base em categorias ou URLs específicas",
          "Criptografia de endereços web",
          "Redirect automático de URLs",
          "Cache de páginas web",
        ],
        c: 0,
        e: "A filtragem de URL permite bloquear ou permitir acesso a sites baseando-se em categorias (redes sociais, jogos, adulto) ou URLs específicas. Bancos de dados de URLs categorizam milhões de sites. Pode ser feita no proxy, NGFW ou DNS.",
        x: "Categorias: 'Redes Sociais' (bloquear), 'Bancário' (permitir), 'Malware' (bloquear). Implementação: proxy (Squid + SquidGuard), NGFW (Fortinet, Palo Alto), DNS (OpenDNS, Pi-hole).",
      },
    ],
    Difícil: [
      {
        q: "O que é um proxy reverso e como ele difere de um proxy direto (forward proxy)?",
        o: [
          "Proxy reverso fica na frente dos servidores; proxy direto fica na frente dos clientes",
          "São termos sinônimos",
          "Proxy reverso funciona apenas com HTTPS",
          "Proxy direto é mais seguro que o reverso",
        ],
        c: 0,
        e: "Forward proxy: intermediário entre clientes internos e a internet (ex: Squid). Clientes sabem que usam proxy. Proxy reverso: intermediário entre a internet e servidores internos (ex: Nginx, HAProxy). Clientes não sabem que existe proxy — pensam estar acessando o servidor diretamente. Oferece load balancing, cache, SSL termination e proteção dos servidores.",
        x: "Forward: Cliente → Proxy → Internet (esconde o cliente). Reverse: Internet → Proxy Reverso → Servidores (esconde os servidores). Nginx como reverse proxy: balanceia carga entre vários servidores backend.",
      },
      {
        q: "O que é SSL/TLS Inspection em firewalls e quais suas implicações?",
        o: [
          "Firewall decifra, inspeciona e recifra tráfego HTTPS; requer certificado CA nos clientes",
          "Bloqueio total de tráfego HTTPS",
          "Monitoramento apenas de cabeçalhos sem decifrar conteúdo",
          "Técnica para acelerar conexões HTTPS",
        ],
        c: 0,
        e: "SSL Inspection: o firewall atua como MitM legítimo — decifra o tráfego HTTPS, inspeciona o conteúdo (malware, DLP) e recifra antes de enviar ao destino. Requer que a CA interna seja confiável nos clientes. Levanta questões de privacidade.",
        x: "Fluxo: Cliente ↔ Firewall (CA interna) ↔ Servidor (certificado real). Sem SSL Inspection: vê apenas IP/SNI. Com: vê todo o conteúdo. Exceções comuns: sites bancários, saúde (compliance).",
      },
      {
        q: "Em um proxy transparente, como o tráfego é interceptado sem configuração nos clientes?",
        o: [
          "O roteador/switch redireciona automaticamente o tráfego para o proxy via WCCP ou iptables",
          "O proxy envia broadcast pedindo para ser usado",
          "Os clientes detectam o proxy via DNS",
          "O proxy altera a tabela MAC do switch",
        ],
        c: 0,
        e: "Proxy transparente intercepta tráfego sem configuração no cliente. O roteador/switch redireciona tráfego HTTP (porta 80) para o proxy usando WCCP, policy-based routing ou iptables/REDIRECT. HTTPS requer SSL bump.",
        x: "Linux: iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 3128 (Squid). Cisco WCCP: redirecionamento automático. Proxy transparente + HTTPS = precisa SSL Inspection.",
      },
      {
        q: "O que é micro-segmentação de rede e como se relaciona com firewalls?",
        o: [
          "Aplicar regras granulares de firewall por workload/aplicação, não apenas por segmento de rede",
          "Dividir a rede em VLANs menores",
          "Usar múltiplos firewalls físicos em série",
          "Segmentar apenas o tráfego de saída",
        ],
        c: 0,
        e: "Micro-segmentação aplica políticas de segurança por carga de trabalho individual (VM, container), não apenas por sub-rede. Cada workload tem regras específicas. Pilar do Zero Trust: nunca confie, sempre verifique — mesmo tráfego leste-oeste (interno).",
        x: "Tradicional: firewall no perímetro (norte-sul). Micro-seg: firewall distribuído internamente (leste-oeste). Ferramentas: VMware NSX, Cisco ACI, Illumio. Impede movimentação lateral do atacante.",
      },
      {
        q: "O que é um UTM (Unified Threat Management)?",
        o: [
          "Dispositivo que integra firewall, antivírus, IDS/IPS, VPN e filtro de conteúdo em um só",
          "Software exclusivo para gestão de logs",
          "Tipo avançado de switch gerenciável",
          "Protocolo unificado de monitoramento",
        ],
        c: 0,
        e: "UTM consolida múltiplas funções de segurança em um único appliance: firewall stateful, antivírus/antimalware, IDS/IPS, VPN, filtragem de URL/conteúdo, antispam. Ideal para PMEs. Desvantagem: ponto único de falha, menor performance que soluções dedicadas.",
        x: "UTM vs NGFW: UTM foca em PMEs (tudo-em-um). NGFW foca em empresas grandes (firewall + DPI + app control). Na prática, a linha entre eles está borrada. Exemplos UTM: Fortinet, Sophos, pfSense.",
      },
      {
        q: "O que é Zero Trust Architecture e como se relaciona com firewalls?",
        o: [
          "Modelo que nunca confia em nenhum tráfego por padrão, verificando continuamente cada acesso",
          "Firewall que bloqueia todo o tráfego",
          "Rede sem firewall",
          "Tipo de VPN sem autenticação",
        ],
        c: 0,
        e: "Zero Trust: 'nunca confie, sempre verifique'. Nenhum usuário, dispositivo ou rede é automaticamente confiável — nem tráfego interno. Requer autenticação contínua, micro-segmentação e menor privilégio. Firewalls evoluem para suportar este modelo.",
        x: "Tradicional: 'confie na LAN, desconfie da internet' (castelo e fosso). Zero Trust: desconfie de TUDO. Pilares: identidade forte, micro-segmentação, least privilege, MFA, monitoramento contínuo. NIST SP 800-207.",
      },
      {
        q: "O que é um Application Layer Gateway (ALG) em firewalls?",
        o: [
          "Firewall L7 que entende protocolos de aplicação específicos e inspeciona seu conteúdo",
          "Firewall básico que filtra por IP",
          "Proxy transparente para DNS",
          "Protocolo de agregação de links",
        ],
        c: 0,
        e: "ALG (Application Layer Gateway) opera na Camada 7 e compreende protocolos específicos (FTP, SIP, H.323). Pode modificar o payload para permitir que protocolos problemáticos com NAT funcionem (ex: FTP ativo através de NAT).",
        x: "FTP ativo: servidor abre conexão de volta ao cliente (problema com NAT/firewall). ALG para FTP: firewall entende o comando PORT e abre a porta dinâmica automaticamente. ALG SIP: ajusta endereços SDP em VoIP.",
      },
    ],
  },

  // ── Modelo OSI e TCP/IP ──
  "Modelo OSI e TCP/IP": {
    Fácil: [
      {
        q: "Quantas camadas tem o modelo OSI?",
        o: ["7", "4", "5", "6"],
        c: 0,
        e: "O modelo OSI (Open Systems Interconnection) tem 7 camadas: 1-Física, 2-Enlace de Dados, 3-Rede, 4-Transporte, 5-Sessão, 6-Apresentação, 7-Aplicação. É um modelo de referência teórico criado pela ISO para padronizar a comunicação em rede.",
        x: "Mnemônico de baixo para cima: 'Filhos Educados Raramente Trazem Sensações Pouco Agradáveis' → Física, Enlace, Rede, Transporte, Sessão, Apresentação, Aplicação.",
      },
      {
        q: "No modelo TCP/IP, quantas camadas existem e quais são?",
        o: [
          "4 camadas: Acesso à Rede, Internet, Transporte e Aplicação",
          "7 camadas, iguais ao modelo OSI",
          "5 camadas: Física, Enlace, Rede, Transporte e Aplicação",
          "3 camadas: Rede, Transporte e Aplicação",
        ],
        c: 0,
        e: "O modelo TCP/IP tem 4 camadas: 1) Acesso à Rede (Link) = Física+Enlace do OSI. 2) Internet = Rede (IP). 3) Transporte = TCP, UDP. 4) Aplicação = Sessão+Apresentação+Aplicação do OSI.",
        x: "OSI (7 camadas, teórico) vs TCP/IP (4 camadas, prático). OSI 1-2 → Acesso. OSI 3 → Internet. OSI 4 → Transporte. OSI 5-7 → Aplicação. Na prática, TCP/IP é o modelo implementado.",
      },
      {
        q: "Qual camada do modelo OSI é responsável pelo endereçamento IP?",
        o: [
          "Camada 3 — Rede",
          "Camada 2 — Enlace",
          "Camada 4 — Transporte",
          "Camada 7 — Aplicação",
        ],
        c: 0,
        e: "A Camada 3 (Rede) é responsável pelo endereçamento lógico (IP), roteamento de pacotes entre redes e determinação do melhor caminho. Protocolos: IP, ICMP, OSPF, BGP.",
        x: "Camada 3: endereço IP (lógico, mutável). Camada 2: endereço MAC (físico, fixo). Roteadores operam na Camada 3. Switches operam na Camada 2. Switch L3 opera em ambas.",
      },
      {
        q: "Como é chamado o PDU (unidade de dados) da Camada 2 do modelo OSI?",
        o: ["Frame (quadro)", "Pacote", "Segmento", "Datagrama"],
        c: 0,
        e: "Cada camada tem seu PDU: Camada 4 = Segmento (TCP) ou Datagrama (UDP). Camada 3 = Pacote. Camada 2 = Frame (quadro). Camada 1 = Bits. O frame encapsula o pacote adicionando cabeçalho MAC e trailer (FCS).",
        x: "Frame Ethernet: Preâmbulo (8B) + MAC destino (6B) + MAC origem (6B) + Tipo/Len (2B) + Payload (46–1500B) + FCS (4B). Tamanho total: 64–1518 bytes.",
      },
      {
        q: "Em qual camada do modelo OSI opera o protocolo HTTP?",
        o: [
          "Camada 7 — Aplicação",
          "Camada 4 — Transporte",
          "Camada 3 — Rede",
          "Camada 6 — Apresentação",
        ],
        c: 0,
        e: "HTTP opera na Camada 7 (Aplicação), que interage diretamente com o usuário/software. Outros protocolos L7: HTTPS, FTP, SMTP, DNS, SSH, Telnet, SNMP. No TCP/IP, corresponde à camada de Aplicação (que engloba L5-L7 do OSI).",
        x: "Protocolos por camada OSI: L7: HTTP, FTP, DNS, SMTP. L6: SSL/TLS (debate), JPEG, MPEG. L5: NetBIOS, RPC. L4: TCP, UDP. L3: IP, ICMP, OSPF. L2: Ethernet, Wi-Fi. L1: RS-232, DSL.",
      },
      {
        q: "Qual camada do modelo OSI é responsável por endereços MAC?",
        o: [
          "Camada 2 — Enlace de Dados",
          "Camada 3 — Rede",
          "Camada 1 — Física",
          "Camada 4 — Transporte",
        ],
        c: 0,
        e: "A Camada 2 (Enlace de Dados) usa endereços MAC (Media Access Control) para encaminhar quadros dentro da rede local. O MAC é um endereço físico de 48 bits gravado na placa de rede (NIC), ex: AA:BB:CC:DD:EE:FF.",
        x: "Camada 2: MAC (físico, 48 bits, fixo na NIC). Camada 3: IP (lógico, 32/128 bits, atribuído). Switch usa MAC. Roteador usa IP. Para enviar dados, o host precisa de ambos (MAC local + IP destino).",
      },
      {
        q: "Qual protocolo de transporte é orientado a conexão?",
        o: ["TCP", "UDP", "ICMP", "ARP"],
        c: 0,
        e: "TCP (Transmission Control Protocol) é orientado a conexão: estabelece uma conexão (three-way handshake) antes de transmitir dados, garantindo entrega confiável, ordem correta e retransmissão em caso de perda.",
        x: "TCP: confiável, orientado a conexão, controle de fluxo e congestionamento. UDP: não confiável, sem conexão, mais rápido, sem retransmissão. TCP: HTTP, FTP, SSH. UDP: DNS, VoIP, streaming.",
      },
    ],
    Médio: [
      {
        q: "No modelo TCP/IP, a camada de Transporte trabalha com quais dois protocolos principais?",
        o: ["TCP e UDP", "HTTP e FTP", "IP e ICMP", "ARP e RARP"],
        c: 0,
        e: "TCP (Transmission Control Protocol): orientado a conexão, confiável, com controle de fluxo e retransmissão. UDP (User Datagram Protocol): sem conexão, não confiável, mais rápido. Ambos operam na camada de Transporte do modelo TCP/IP.",
        x: "TCP: usado em HTTP, FTP, SSH, email — quando confiabilidade importa. UDP: usado em DNS, VoIP, streaming, games — quando velocidade importa. TCP usa three-way handshake (SYN → SYN-ACK → ACK).",
      },
      {
        q: "Qual protocolo da camada de rede envia mensagens de erro e diagnóstico?",
        o: [
          "ICMP (Internet Control Message Protocol)",
          "TCP (Transmission Control Protocol)",
          "ARP (Address Resolution Protocol)",
          "HTTP (HyperText Transfer Protocol)",
        ],
        c: 0,
        e: "ICMP é usado para mensagens de controle e erro: 'Destination Unreachable' (inacessível), 'Time Exceeded' (TTL expirou, usado pelo traceroute), 'Echo Request/Reply' (usado pelo ping).",
        x: "Ping: ICMP Echo Request (tipo 8) → Echo Reply (tipo 0). Traceroute: TTL incrementando → ICMP Time Exceeded (tipo 11). Tipos comuns: 0, 3, 5, 8, 11.",
      },
      {
        q: "Qual é a função do three-way handshake do TCP?",
        o: [
          "Estabelecer uma conexão confiável entre dois hosts antes da transmissão de dados",
          "Encerrar uma conexão TCP",
          "Verificar a identidade dos hosts via certificados",
          "Dividir os dados em segmentos",
        ],
        c: 0,
        e: "Three-way handshake estabelece conexão TCP: 1) SYN: cliente envia SYN. 2) SYN-ACK: servidor responde. 3) ACK: cliente confirma. Após isso, dados podem fluir. Encerramento usa four-way handshake (FIN).",
        x: "SYN (seq=100) → SYN-ACK (seq=300, ack=101) → ACK (seq=101, ack=301). SYN flood attack: enviar milhares de SYN sem completar o handshake, esgotando recursos do servidor.",
      },
      {
        q: "O que é ARP (Address Resolution Protocol) e para que serve?",
        o: [
          "Protocolo que resolve endereço IP para endereço MAC na rede local",
          "Protocolo que resolve nomes de domínio para IPs",
          "Protocolo de roteamento dinâmico",
          "Protocolo de criptografia de tráfego",
        ],
        c: 0,
        e: "ARP mapeia IP → MAC na rede local. Quando um host quer enviar dados a outro IP na mesma sub-rede, envia ARP Request (broadcast) perguntando 'quem tem esse IP?'. O dono responde com ARP Reply (unicast) informando seu MAC.",
        x: "ARP Request: broadcast (FF:FF:FF:FF:FF:FF) → 'Quem tem 192.168.1.5?' ARP Reply: unicast → '192.168.1.5 está em AA:BB:CC:DD:EE:FF'. Cache ARP: armazena mapeamentos. ARP spoofing: ataque MitM.",
      },
      {
        q: "Qual é a função da Camada 5 (Sessão) do modelo OSI?",
        o: [
          "Estabelecer, gerenciar e encerrar sessões de comunicação entre aplicações",
          "Criptografar os dados transmitidos",
          "Definir o endereçamento lógico dos hosts",
          "Converter dados entre formatos diferentes",
        ],
        c: 0,
        e: "A Camada 5 (Sessão) gerencia diálogos entre aplicações: estabelece, mantém e encerra sessões. Controla modos de comunicação (simplex, half-duplex, full-duplex) e sincronização com checkpoints. Exemplos: NetBIOS, RPC, sessões SIP.",
        x: "Na prática, muitas funções de L5/L6 são absorvidas por protocolos de L7 no TCP/IP. Por isso o TCP/IP funde L5+L6+L7 em uma camada só (Aplicação). L5 é mais conceitual que implementado separadamente.",
      },
      {
        q: "O que é o TTL (Time to Live) em um pacote IP?",
        o: [
          "Contador que limita o número de roteadores (hops) por onde o pacote pode passar",
          "Tempo máximo de conexão TCP",
          "Tamanho máximo do pacote",
          "Tempo de validade do cache DNS",
        ],
        c: 0,
        e: "TTL é decrementado a cada roteador (hop). Se chegar a 0, o pacote é descartado e um ICMP Time Exceeded é enviado. Previne loops infinitos. Valor inicial comum: 64 (Linux), 128 (Windows), 255 (roteadores).",
        x: "TTL inicial: 64 (Linux), 128 (Windows). A cada hop: TTL−1. TTL = 0 → descartado + ICMP Time Exceeded. Traceroute usa TTL incremental (1, 2, 3...) para descobrir cada roteador no caminho.",
      },
      {
        q: "Qual número de porta TCP é padrão do HTTPS?",
        o: ["443", "80", "8080", "22"],
        c: 0,
        e: "HTTPS (HTTP Secure) usa a porta TCP 443 por padrão. HTTP usa porta 80. Outras portas comuns: SSH=22, FTP=21, SMTP=25, DNS=53, Telnet=23, POP3=110, IMAP=143.",
        x: "Well-known ports (0-1023): HTTP=80, HTTPS=443, SSH=22, DNS=53, FTP=21, SMTP=25. Registered (1024-49151): 3306=MySQL, 5432=PostgreSQL. Dynamic (49152-65535): portas efêmeras.",
      },
    ],
    Difícil: [
      {
        q: "Em qual camada do modelo OSI ocorre o encapsulamento de dados em 'segmentos'?",
        o: [
          "Camada 4 — Transporte",
          "Camada 3 — Rede",
          "Camada 2 — Enlace",
          "Camada 5 — Sessão",
        ],
        c: 0,
        e: "O encapsulamento segue: Camada 7/6/5 → Dados. Camada 4 (Transporte) → Segmentos (TCP) ou Datagramas (UDP). Camada 3 (Rede) → Pacotes. Camada 2 (Enlace) → Quadros/Frames. Camada 1 (Física) → Bits. Cada camada adiciona seu cabeçalho.",
        x: "PDU (Protocol Data Unit) por camada: L7-L5: Data. L4: Segment (TCP) / Datagram (UDP). L3: Packet. L2: Frame. L1: Bits. Processo inverso = desencapsulamento.",
      },
      {
        q: "O que é o MTU (Maximum Transmission Unit) e o que acontece quando um pacote excede o MTU?",
        o: [
          "Tamanho máximo do pacote que o enlace suporta; pacotes maiores são fragmentados ou descartados",
          "Velocidade máxima da conexão; pacotes são enfileirados",
          "Número máximo de hops; pacotes são roteados por caminho alternativo",
          "Tempo máximo de vida do pacote; descartados silenciosamente",
        ],
        c: 0,
        e: "MTU é o tamanho máximo de pacote que um enlace transporta. Ethernet padrão: 1500 bytes. Se excede o MTU: IPv4 fragmenta; IPv6 descarta com ICMP 'Packet Too Big' (proíbe fragmentação em trânsito).",
        x: "Ethernet MTU: 1500 bytes. Jumbo frames: até 9000 bytes. IPv4: roteador fragmenta (flag DF → ICMP Type 3 Code 4). IPv6: NUNCA fragmenta em trânsito. Path MTU Discovery descobre o menor MTU do caminho.",
      },
      {
        q: "Como funciona o mecanismo de janela deslizante (sliding window) do TCP?",
        o: [
          "Permite enviar múltiplos segmentos antes de receber confirmação, ajustando o tamanho conforme a rede",
          "Envia um segmento por vez e espera confirmação",
          "Descarta pacotes duplicados automaticamente",
          "Prioriza pacotes conforme tipo de tráfego",
        ],
        c: 0,
        e: "Sliding window: o transmissor envia até N segmentos (tamanho da janela) sem esperar ACK. A janela desliza conforme ACKs chegam. O receptor anuncia rwnd (receive window). Congestion window (cwnd) limita baseado na rede.",
        x: "Window=3: envia seg 1,2,3 → ACK 1 → desliza → envia seg 4. Congestion control: slow start → congestion avoidance → fast retransmit/recovery. rwnd × cwnd determinam a taxa efetiva.",
      },
      {
        q: "O que é o MSS (Maximum Segment Size) e como se relaciona com o MTU?",
        o: [
          "Tamanho máximo de dados TCP em um segmento; MSS = MTU − cabeçalhos IP e TCP",
          "Tamanho máximo de um pacote na Camada 2",
          "Número máximo de segmentos enviados sem ACK",
          "Velocidade máxima de transferência do enlace",
        ],
        c: 0,
        e: "MSS = MTU − cabeçalho IP (20B) − cabeçalho TCP (20B). Com MTU Ethernet de 1500 bytes, MSS = 1460 bytes. O MSS é negociado durante o three-way handshake (opção no campo TCP Options do SYN).",
        x: "MTU 1500 → MSS 1460 (sem opções). Com timestamps TCP: MSS 1448. VPN (overhead do túnel): MTU menor → MSS menor. MSS clamping: roteador ajusta o MSS para evitar fragmentação em túneis.",
      },
      {
        q: "Quais são as fases do controle de congestionamento do TCP?",
        o: [
          "Slow Start, Congestion Avoidance, Fast Retransmit e Fast Recovery",
          "Handshake, Transfer e Teardown",
          "SYN, DATA e FIN",
          "Connect, Transmit, Disconnect e Retry",
        ],
        c: 0,
        e: "1) Slow Start: cwnd dobra a cada RTT (crescimento exponencial). 2) Congestion Avoidance: após ssthresh, cwnd cresce linearmente (+1 MSS/RTT). 3) Fast Retransmit: 3 ACKs duplicados → retransmite sem esperar timeout. 4) Fast Recovery: reduz cwnd pela metade ao invés de reiniciar.",
        x: "Algoritmos: Tahoe (slow start após perda), Reno (fast recovery), CUBIC (Linux padrão, baseado em função cúbica), BBR (Google, baseado em bandwidth/RTT). cwnd inicial: tipicamente 10 MSS (RFC 6928).",
      },
      {
        q: "O que é Path MTU Discovery (PMTUD) e por que é importante?",
        o: [
          "Mecanismo que descobre o menor MTU do caminho para evitar fragmentação",
          "Protocolo que descobre a rota mais rápida",
          "Método de compressão de pacotes",
          "Ferramenta de diagnóstico de rede",
        ],
        c: 0,
        e: "PMTUD envia pacotes com flag DF (Don't Fragment) e descobre o menor MTU do caminho através de ICMP 'Packet Too Big' (tipo 3, código 4 em IPv4; tipo 2 em ICMPv6). Ajusta o tamanho dos pacotes para evitar fragmentação.",
        x: "Host envia pacote com DF=1. Se excede MTU de um link, roteador descarta e envia ICMP 'Fragmentation Needed' com MTU do link. Host reduz tamanho e retenta. Problema: firewalls que bloqueiam ICMP quebram PMTUD.",
      },
      {
        q: "O que diferencia TCP CUBIC de TCP Reno no controle de congestionamento?",
        o: [
          "CUBIC usa função cúbica baseada no tempo; Reno usa crescimento linear baseado em RTT",
          "São idênticos",
          "Reno é mais moderno que CUBIC",
          "CUBIC só funciona com IPv6",
        ],
        c: 0,
        e: "TCP Reno: cresce cwnd linearmente (+1 MSS/RTT) em Congestion Avoidance — depende do RTT. TCP CUBIC (Linux padrão desde 2.6.19): usa função cúbica do tempo desde a última redução, independente do RTT. CUBIC é mais justo em links de alta largura de banda.",
        x: "Reno: AIMD (Additive Increase, Multiplicative Decrease) — janela depende do RTT. CUBIC: baseado no tempo (RTT-independent) — melhor para links fat (alta banda, alto delay). BBR (Google): baseado em bandwidth estimada + RTT mínimo.",
      },
    ],
  },

  // ── Protocolos de Roteamento ──
  "Protocolos de Roteamento": {
    Fácil: [
      {
        q: "Qual é a diferença entre roteamento estático e dinâmico?",
        o: [
          "Estático: rotas configuradas manualmente. Dinâmico: rotas aprendidas automaticamente por protocolos",
          "Estático é mais lento que dinâmico",
          "Dinâmico não usa tabela de roteamento",
          "Estático só funciona em redes locais",
        ],
        c: 0,
        e: "Roteamento estático: o administrador configura manualmente cada rota. Simples, sem overhead, mas não se adapta a mudanças. Roteamento dinâmico: protocolos (OSPF, BGP, EIGRP) trocam informações entre roteadores e atualizam rotas automaticamente.",
        x: "Estático: `ip route 10.0.0.0 255.255.255.0 192.168.1.1` (manual). Dinâmico: roteadores OSPF descobrem vizinhos e calculam melhores rotas automaticamente. Usado em redes grandes e complexas.",
      },
      {
        q: "O que é uma tabela de roteamento?",
        o: [
          "Lista com os caminhos disponíveis para alcançar diferentes redes",
          "Tabela com endereços MAC dos dispositivos",
          "Lista de portas abertas no firewall",
          "Registro de todos os pacotes que passaram pelo roteador",
        ],
        c: 0,
        e: "A tabela de roteamento contém: rede de destino, máscara, próximo salto (next hop), interface de saída e métrica. O roteador consulta essa tabela para decidir o encaminhamento de cada pacote.",
        x: "Comando: `ip route` (Linux). Fontes: C (connected), S (static), O (OSPF), R (RIP), B (BGP). O roteador escolhe a rota mais específica (longest prefix match).",
      },
      {
        q: "O que é o gateway padrão (default gateway) em uma rede?",
        o: [
          "Endereço IP do roteador que encaminha tráfego para redes externas",
          "Endereço do servidor DNS",
          "Endereço IP do switch principal",
          "Endereço de broadcast da rede",
        ],
        c: 0,
        e: "O gateway padrão é o IP do roteador que o dispositivo usa para enviar pacotes a redes fora da sub-rede local. Quando não há rota específica, o pacote vai ao default gateway. Geralmente é .1 ou .254.",
        x: "PC 192.168.1.10/24, gateway 192.168.1.1. Pacote para 10.0.0.5 → não está na sub-rede → envia para 192.168.1.1 (roteador) → roteador encaminha para a próxima rede.",
      },
      {
        q: "O que é o 'next hop' (próximo salto) em uma tabela de roteamento?",
        o: [
          "IP do roteador vizinho para onde o pacote deve ser encaminhado",
          "Endereço MAC do destino final",
          "Número da porta TCP do serviço",
          "Velocidade do link de saída",
        ],
        c: 0,
        e: "Next hop é o endereço IP do próximo roteador no caminho até o destino. O pacote é encaminhado salto a salto (hop by hop) até chegar à rede de destino. Se o destino está diretamente conectado, o next hop é a própria interface.",
        x: "Tabela: Rede 10.0.0.0/8 → Next Hop 192.168.1.2 → Interface eth0. 'Directly connected' = sem next hop. Default route (0.0.0.0/0) → next hop = gateway padrão.",
      },
      {
        q: "O que significa uma rede estar 'convergida' em roteamento dinâmico?",
        o: [
          "Todos os roteadores têm visão consistente e atualizada da topologia da rede",
          "Todos os links estão na velocidade máxima",
          "O firewall está sincronizado com o roteador",
          "O DNS resolveu todos os nomes corretamente",
        ],
        c: 0,
        e: "Convergência é o estado em que todos os roteadores concordam sobre as rotas disponíveis após uma mudança na topologia. OSPF converge rapidamente (segundos); RIP converge lentamente (minutos). Durante a convergência, can haver loops temporários.",
        x: "Tempo de convergência: RIP = até minutos (count-to-infinity). OSPF = segundos (SPF rápido). EIGRP = subsegundos (Feasible Successor). Rede não convergida = risco de loops e black holes.",
      },
      {
        q: "O que é o protocolo RIP e qual sua principal limitação?",
        o: [
          "Protocolo distance-vector que usa contagem de hops como métrica, limitado a 15 hops",
          "Protocolo link-state limitado a 30 roteadores",
          "Protocolo de transporte limitado a redes locais",
          "Protocolo de aplicação limitado a 100 Mbps",
        ],
        c: 0,
        e: "RIP (Routing Information Protocol) é um protocolo distance-vector que usa hop count como métrica (máximo 15 hops — 16 = inalcançável). Simples de configurar, mas converge lentamente e sofre com count-to-infinity.",
        x: "RIPv1: classful, broadcast. RIPv2: classless, multicast (224.0.0.9), suporta VLSM e autenticação. RIPng: versão para IPv6. Atualiza tabela a cada 30 segundos. Quase obsoleto — substituído por OSPF/EIGRP.",
      },
      {
        q: "O que é uma rota padrão (default route)?",
        o: [
          "Rota 0.0.0.0/0 usada quando não há rota específica na tabela para o destino",
          "Primeira rota inserida na tabela de roteamento",
          "Rota com maior número de hops",
          "Rota exclusiva para tráfego local",
        ],
        c: 0,
        e: "A default route (0.0.0.0/0) é a rota 'coringa' — usada quando nenhuma rota mais específica combina com o destino. Aponta para o gateway de último recurso. Todo host tem uma (apontando para o default gateway).",
        x: "Cisco: `ip route 0.0.0.0 0.0.0.0 192.168.1.1`. Linux: `ip route add default via 192.168.1.1`. Longest prefix match: default route (/0) é a menos específica, usada apenas como fallback.",
      },
    ],
    Médio: [
      {
        q: "O protocolo OSPF é classificado como qual tipo de protocolo de roteamento?",
        o: [
          "Link-state (estado de enlace)",
          "Distance-vector (vetor de distância)",
          "Path-vector (vetor de caminho)",
          "Hybrid (híbrido)",
        ],
        c: 0,
        e: "OSPF (Open Shortest Path First) é um protocolo link-state: cada roteador conhece a topologia completa da rede e calcula o melhor caminho usando o algoritmo de Dijkstra. Diferente de distance-vector (RIP), onde roteadores conhecem apenas vizinhos diretos.",
        x: "Link-state: OSPF, IS-IS — cada roteador tem mapa completo, usa SPF/Dijkstra. Distance-vector: RIP — conhece apenas distância (hops) até destinos via vizinhos. Path-vector: BGP — usado entre sistemas autônomos (internet).",
      },
      {
        q: "Qual é a principal diferença entre OSPF e RIP como protocolos de roteamento?",
        o: [
          "OSPF usa estado de enlace e Dijkstra; RIP usa vetor de distância com máximo 15 hops",
          "OSPF é mais simples que RIP",
          "RIP suporta mais roteadores que OSPF",
          "Ambos usam o mesmo algoritmo",
        ],
        c: 0,
        e: "OSPF (link-state): cada roteador conhece a topologia completa e calcula o melhor caminho com Dijkstra. Converge rápido. RIP (distance-vector): conhece apenas vizinhos, métrica = hops (máximo 15). Converge lento. OSPF é preferido em redes grandes.",
        x: "RIP: máx 15 hops, atualização a cada 30s, count-to-infinity. OSPF: sem limite de hops, convergência rápida, áreas hierárquicas, métrica baseada em bandwidth. RIPv1: classful. RIPv2: classless.",
      },
      {
        q: "O que é métrica em roteamento e como diferentes protocolos a calculam?",
        o: [
          "Valor numérico do custo de um caminho; RIP usa hops, OSPF usa largura de banda",
          "É a velocidade da interface de rede",
          "É o número de VLANs no caminho",
          "É o tempo de resposta do ping",
        ],
        c: 0,
        e: "Métrica é o critério para comparar rotas. RIP = hop count. OSPF = custo baseado em bandwidth (10⁸/BW). EIGRP = composto (bandwidth, delay, reliability, load). Se duas rotas existem, escolhe-se a de menor métrica.",
        x: "RIP: link 100 Mbps ou 10 Gbps = 1 hop (não diferencia). OSPF: 100 Mbps = custo 1, 10 Mbps = custo 10 (ajustável). EIGRP: fórmula composta permite ajuste fino.",
      },
      {
        q: "O que é distância administrativa (AD) em roteamento?",
        o: [
          "Valor de confiabilidade de uma fonte de rota; menor AD = mais confiável",
          "Distância física entre roteadores",
          "Número de hops até o destino",
          "Largura de banda do link",
        ],
        c: 0,
        e: "Distância administrativa prioriza fontes de rota. Valores padrão (Cisco): Connected = 0, Static = 1, EIGRP = 90, OSPF = 110, RIP = 120, BGP externo = 20. Se há duas rotas de protocolos diferentes, vence a de menor AD.",
        x: "Exemplo: rota para 10.0.0.0/8 via OSPF (AD 110) e RIP (AD 120) → OSPF vence. Se OSPF cai, RIP assume. AD não é métrica — métrica compara rotas DENTRO do mesmo protocolo.",
      },
      {
        q: "O que significa 'longest prefix match' no roteamento IP?",
        o: [
          "O roteador escolhe a rota com máscara mais longa (mais específica) para o destino",
          "Escolhe a rota com menor número de hops",
          "Seleciona a rota mais antiga na tabela",
          "Prefere rotas estáticas sobre dinâmicas",
        ],
        c: 0,
        e: "Longest prefix match: se existem rotas 10.0.0.0/8 e 10.1.0.0/16 e o destino é 10.1.2.3, o roteador escolhe /16 (mais específica). Quanto maior o prefixo, mais específica a rota. /32 = host route (mais específica possível).",
        x: "Pacote para 10.1.2.3: /8 (match), /16 (match), /24 (match se existir) → escolhe a mais específica. Default route 0.0.0.0/0 = menor prefixo, usada quando nada mais combina.",
      },
      {
        q: "O que são áreas no OSPF e qual a função da Área 0?",
        o: [
          "Divisões lógicas da rede que reduzem overhead; Área 0 (backbone) interconecta todas as outras",
          "Grupos de VLANs; Área 0 é a VLAN padrão",
          "Segmentos físicos; Área 0 é o datacenter",
          "Zonas de firewall; Área 0 é a DMZ",
        ],
        c: 0,
        e: "OSPF divide a rede em áreas para limitar a propagação de LSAs e reduzir o processamento. A Área 0 (backbone) é obrigatória e todas as outras áreas devem se conectar a ela (diretamente ou via virtual link).",
        x: "Benefícios de áreas: menos LSAs por área → tabelas menores → SPF mais rápido. Tipos de área: Stub (sem LSA 5), NSSA (permite LSA 7), Totally Stubby (só rota padrão).",
      },
      {
        q: "O que é o algoritmo de Dijkstra utilizado pelo OSPF?",
        o: [
          "Algoritmo que calcula o caminho mais curto de um nó a todos os outros em um grafo ponderado",
          "Algoritmo de criptografia de rotas",
          "Método de compressão de tabelas de roteamento",
          "Protocolo de autenticação entre roteadores",
        ],
        c: 0,
        e: "O algoritmo SPF (Shortest Path First) de Dijkstra constrói uma árvore de caminhos mínimos a partir do roteador local. Cada roteador OSPF executa Dijkstra sobre seu LSDB (Link-State Database) para calcular as melhores rotas.",
        x: "Complexidade: O(n² + m) ou O(n log n + m) com heap. OSPF executa SPF a cada mudança de topologia. Para evitar cálculos frequentes, há SPF delay timers e incremental SPF (iSPF).",
      },
    ],
    Difícil: [
      {
        q: "Em uma rede OSPF multi-área, qual é a função do ABR (Area Border Router)?",
        o: [
          "Conectar diferentes áreas OSPF e sumarizar rotas entre elas",
          "Redistribuir rotas de outros protocolos para o OSPF",
          "Eleger o DR e BDR da rede",
          "Gerar a rota padrão para a área 0",
        ],
        c: 0,
        e: "O ABR (Area Border Router) é um roteador que pertence a pelo menos duas áreas OSPF (uma delas é a área 0 — backbone). Ele injeta LSAs tipo 3 (Summary LSAs) na outra área, permitindo que roteadores conheçam rotas de áreas diferentes. Também pode sumarizar rotas, reduzindo o tamanho das tabelas.",
        x: "ASBR (Autonomous System Boundary Router): redistribui rotas externas → LSA tipo 5. ABR: conecta áreas → LSA tipo 3. DR/BDR: eleitos por prioridade/Router ID em redes multi-acesso, reduzindo adjacências.",
      },
      {
        q: "O que é redistribuição de rotas e quando ela é necessária?",
        o: [
          "Compartilhar rotas entre protocolos diferentes; necessária quando a rede usa múltiplos protocolos",
          "Balancear tráfego entre rotas iguais",
          "Replicar a tabela de roteamento para backup",
          "Comprimir rotas para economizar memória",
        ],
        c: 0,
        e: "Redistribuição injeta rotas de um protocolo em outro (ex: OSPF no EIGRP). Necessária quando partes da rede usam protocolos diferentes (fusão de empresas, migração). Cuidados: loops, métricas incompatíveis.",
        x: "Cisco: `router ospf 1` → `redistribute eigrp 100 subnets`. Riscos: routing loops, suboptimal routing. Soluções: route maps, distribute-lists, métricas seed configuradas.",
      },
      {
        q: "No BGP, o que são os atributos AS_PATH e NEXT_HOP?",
        o: [
          "AS_PATH lista os ASes atravessados (menor = preferido); NEXT_HOP indica o próximo roteador",
          "AS_PATH é a velocidade do link; NEXT_HOP é o DNS",
          "Ambos são opcionais e não influenciam a seleção",
          "AS_PATH é usado apenas em iBGP; NEXT_HOP apenas em eBGP",
        ],
        c: 0,
        e: "AS_PATH: lista ordenada dos Autonomous Systems que a rota atravessou. Menor AS_PATH = rota preferida. Também previne loops (se o AS local já está no path, descarta). NEXT_HOP: IP do próximo roteador BGP para alcançar o destino.",
        x: "Rota 8.8.8.0/24: AS_PATH 64500 64501 15169 (3 saltos) vs 64500 15169 (2 saltos) → segunda preferida. Seleção BGP: Weight → Local Pref → AS_PATH → MED.",
      },
      {
        q: "Qual a diferença entre iBGP e eBGP?",
        o: [
          "iBGP é entre roteadores do mesmo AS; eBGP é entre ASes diferentes",
          "iBGP usa TCP e eBGP usa UDP",
          "eBGP só funciona em IPv6",
          "iBGP não usa atributos de caminho",
        ],
        c: 0,
        e: "eBGP (external): peering entre roteadores de ASes diferentes (ex: ISPs). TTL=1 por padrão. iBGP (internal): peering dentro do mesmo AS. Propaga rotas aprendidas externamente internamente. iBGP não altera o NEXT_HOP por padrão e requer full-mesh ou route reflectors.",
        x: "iBGP full-mesh: n(n-1)/2 sessões. Soluções: Route Reflectors (RR) ou Confederações. eBGP: altera AS_PATH a cada salto. iBGP: não altera AS_PATH (regra split-horizon do BGP).",
      },
      {
        q: "O que é ECMP (Equal-Cost Multi-Path) em roteamento?",
        o: [
          "Balanceamento de carga entre múltiplas rotas de custo igual para o mesmo destino",
          "Protocolo de redundância de gateway",
          "Método de criptografia de rotas",
          "Técnica de compressão de tabela de roteamento",
        ],
        c: 0,
        e: "ECMP permite usar várias rotas com o mesmo custo simultaneamente, distribuindo o tráfego entre elas. Aumenta a largura de banda efetiva e provê redundância. OSPF, IS-IS e BGP (com configuração) suportam ECMP.",
        x: "OSPF permite até 4 rotas ECMP por padrão (ajustável). Balanceamento: per-packet (risco de reordenamento) ou per-flow (hash 5-tupla). ECMP é base do roteamento em data centers (Clos/Fat-Tree).",
      },
      {
        q: "O que são Route Reflectors no iBGP e por que são necessários?",
        o: [
          "Roteadores que refletem rotas iBGP para evitar full-mesh entre todos os peers do AS",
          "Servidores que armazenam backup das rotas BGP",
          "Dispositivos que criptografam sessões BGP",
          "Switches que redistribuem rotas entre VLANs",
        ],
        c: 0,
        e: "No iBGP, rotas recebidas de um peer não são repassadas a outros peers (split-horizon). Isso exige full-mesh (n(n-1)/2 sessões). Route Reflectors quebram essa regra: recebem rotas de clientes e as refletem para outros clientes e non-clients.",
        x: "RR cluster: RR + seus clientes. Atributos: ORIGINATOR_ID (evita loops), CLUSTER_LIST (rastreio de clusters). Hierarquia de RRs possível. Alternativa: Confederações BGP (dividem AS em sub-ASes).",
      },
      {
        q: "O que é o protocolo IS-IS e como ele difere do OSPF?",
        o: [
          "Protocolo link-state baseado em OSI que encapsula diretamente em L2, sem depender de IP",
          "Protocolo distance-vector mais rápido que o RIP",
          "Versão do OSPF para redes sem fio",
          "Protocolo de roteamento exclusivo para IPv6",
        ],
        c: 0,
        e: "IS-IS (Intermediate System to Intermediate System) é um protocolo link-state que roda diretamente sobre L2 (não precisa de IP). Usa TLVs extensíveis, suporta IPv4 e IPv6 nativamente. Preferido por grandes ISPs pela escalabilidade.",
        x: "IS-IS vs OSPF: IS-IS roda sobre L2 (OSPF sobre IP). IS-IS usa TLVs (fácil extensão). IS-IS: 2 níveis (L1 intra-área, L2 inter-área). OSPF: área backbone + áreas stub/NSSA. ISPs preferem IS-IS; empresas preferem OSPF.",
      },
    ],
  },

  // ── Redes Sem Fio ──
  "Redes Sem Fio": {
    Fácil: [
      {
        q: "Qual padrão Wi-Fi opera exclusivamente na frequência de 5 GHz?",
        o: ["802.11a", "802.11b", "802.11g", "802.11n"],
        c: 0,
        e: "802.11a: 5 GHz (até 54 Mbps). 802.11b: 2,4 GHz (até 11 Mbps). 802.11g: 2,4 GHz (até 54 Mbps). 802.11n (Wi-Fi 4): dual-band 2,4/5 GHz (até 600 Mbps). 802.11a foi um dos primeiros a usar 5 GHz, mas teve menor alcance.",
        x: "2,4 GHz: maior alcance, mais interferência (micro-ondas, Bluetooth). 5 GHz: menor alcance, mais canais, menos interferência. 802.11ac (Wi-Fi 5) = apenas 5 GHz. 802.11ax (Wi-Fi 6) = dual-band.",
      },
      {
        q: "O que é o SSID de uma rede Wi-Fi?",
        o: [
          "Nome da rede sem fio que aparece na lista de redes disponíveis",
          "Senha da rede Wi-Fi",
          "Endereço MAC do roteador",
          "Frequência do canal Wi-Fi",
        ],
        c: 0,
        e: "SSID (Service Set Identifier) é o nome que identifica uma rede Wi-Fi. É o que aparece quando você procura redes disponíveis. Cada access point pode ter um ou múltiplos SSIDs.",
        x: "SSID pode ser ocultado (hidden), mas não é segurança real — ferramentas capturam facilmente. Boas práticas: WPA3, senha forte, nome não revelador.",
      },
      {
        q: "Qual a diferença entre as frequências 2,4 GHz e 5 GHz em redes Wi-Fi?",
        o: [
          "2,4 GHz tem maior alcance mas mais interferência; 5 GHz tem menor alcance mas mais velocidade",
          "2,4 GHz é mais rápido que 5 GHz",
          "5 GHz tem maior alcance que 2,4 GHz",
          "Não há diferença prática",
        ],
        c: 0,
        e: "2,4 GHz: maior alcance, melhor penetração em paredes, mas apenas 3 canais não sobrepostos (1, 6, 11) e mais interferência. 5 GHz: menor alcance, mais canais (23+), menos interferência e maiores velocidades.",
        x: "2,4 GHz: canais 1-14 (3 não sobrepostos). 5 GHz: canais 36-165 (23+). Wi-Fi 6: dual-band. Wi-Fi 6E: adiciona 6 GHz. Dual-band: AP opera em ambas simultaneamente.",
      },
      {
        q: "O que significa Wi-Fi 6 em termos de padrão IEEE?",
        o: ["802.11ax", "802.11ac", "802.11n", "802.11ad"],
        c: 0,
        e: "Wi-Fi 6 = 802.11ax: dual-band (2,4/5 GHz), até 9,6 Gbps teóricos, OFDMA, MU-MIMO 8×8, BSS Coloring e TWT. Wi-Fi 5 = 802.11ac. Wi-Fi 4 = 802.11n. A Wi-Fi Alliance simplificou os nomes.",
        x: "Wi-Fi 4 (11n): 600 Mbps. Wi-Fi 5 (11ac): 6,9 Gbps, só 5 GHz. Wi-Fi 6 (11ax): 9,6 Gbps, dual-band. Wi-Fi 6E: adiciona 6 GHz. Wi-Fi 7 (11be): 46 Gbps, tri-band, MLO.",
      },
      {
        q: "O que é um canal em redes Wi-Fi?",
        o: [
          "Faixa de frequência específica dentro da banda usada para transmissão de dados",
          "Cabo físico que conecta o AP ao switch",
          "Tipo de criptografia usada na rede",
          "Número máximo de dispositivos conectados",
        ],
        c: 0,
        e: "Um canal Wi-Fi é uma faixa de frequência dentro da banda (2,4 ou 5 GHz). Na banda 2,4 GHz existem 14 canais, mas só 3 não se sobrepõem (1, 6, 11). Na 5 GHz há mais canais sem sobreposição.",
        x: "2,4 GHz: cada canal tem 20 MHz de largura, espaçados 5 MHz → sobreposição. Canais 1, 6 e 11 não se sobrepõem. 5 GHz: canais de 20, 40, 80 ou 160 MHz. Mais largo = mais velocidade, menos canais.",
      },
      {
        q: "O que é um access point (AP) em redes Wi-Fi?",
        o: [
          "Dispositivo que conecta clientes sem fio à rede cabeada, atuando como ponte",
          "Servidor que distribui endereços IP",
          "Equipamento que filtra tráfego malicioso",
          "Software de gerenciamento de rede",
        ],
        c: 0,
        e: "O access point (AP) é o dispositivo central em redes Wi-Fi infrastructure mode. Ele recebe conexões dos clientes wireless e as encaminha para a rede cabeada (e vice-versa). APs corporativos suportam múltiplos SSIDs e VLANs.",
        x: "AP doméstico: geralmente integrado ao roteador (roteador wireless). AP corporativo: dispositivo separado, gerenciado por WLC. Modos: AP autônomo (standalone) ou Lightweight (controlado por WLC via CAPWAP).",
      },
      {
        q: "O que significa a sigla WPA em redes Wi-Fi?",
        o: [
          "Wi-Fi Protected Access, protocolo de segurança que criptografa a comunicação wireless",
          "Wireless Public Authentication, método de login em redes abertas",
          "Wide Protocol Adapter, interface de rede",
          "Web Privacy Algorithm, criptografia de navegação",
        ],
        c: 0,
        e: "WPA (Wi-Fi Protected Access) é o padrão de segurança para redes Wi-Fi. Substituiu o WEP (vulnerável). WPA usa TKIP, WPA2 usa AES-CCMP e WPA3 usa SAE + AES-GCMP. Cada versão melhorou a segurança.",
        x: "Evolução: WEP (1997, quebrado) → WPA (2003, TKIP) → WPA2 (2004, AES-CCMP, padrão atual) → WPA3 (2018, SAE, forward secrecy). PSK = Personal (senha compartilhada). Enterprise = 802.1X/RADIUS.",
      },
    ],
    Médio: [
      {
        q: "Qual protocolo de segurança Wi-Fi é considerado seguro atualmente?",
        o: ["WPA3", "WEP", "WPA (TKIP)", "WPA2-PSK sem AES"],
        c: 0,
        e: "WPA3 é o protocolo mais seguro, usando SAE (Simultaneous Authentication of Equals) em vez de PSK, protegendo contra ataques de dicionário offline. WEP é trivial de quebrar. WPA (TKIP) tem vulnerabilidades conhecidas. WPA2-AES ainda é aceitável, mas WPA3 é preferido.",
        x: "Evolução: WEP (quebrado em minutos) → WPA/TKIP (vulnerável) → WPA2/AES (seguro, mas suscetível a KRACK) → WPA3/SAE (proteção forward secrecy e anti-dicionário offline).",
      },
      {
        q: "O que é roaming em redes Wi-Fi corporativas?",
        o: [
          "Transição automática do cliente entre access points sem perder a conexão",
          "Conectar-se a redes Wi-Fi públicas automaticamente",
          "Usar dados móveis quando o Wi-Fi cai",
          "Compartilhar a senha entre dispositivos",
        ],
        c: 0,
        e: "Roaming é a migração entre access points da mesma rede sem perda de conexão. Protocolos 802.11r (Fast BSS Transition) e 802.11k (neighbor reports) aceleram o processo. O controlador wireless (WLC) coordena os APs.",
        x: "Sem roaming otimizado: desconecta do AP1, reconecta no AP2. Com 802.11r: pré-autenticação no AP2 antes de sair do AP1 (handoff < 50ms). Essencial para VoIP em movimento.",
      },
      {
        q: "Qual a diferença entre os modos Infrastructure e Ad-hoc em redes Wi-Fi?",
        o: [
          "Infrastructure usa access point central; Ad-hoc conecta dispositivos diretamente entre si",
          "Infrastructure é mais lento que Ad-hoc",
          "Ad-hoc requer um servidor central",
          "Não há diferença prática",
        ],
        c: 0,
        e: "Infrastructure (BSS): dispositivos se conectam a um AP que coordena a comunicação e conecta à rede cabeada. Ad-hoc (IBSS): comunicação direta peer-to-peer sem AP. Infrastructure é o modo padrão.",
        x: "Infrastructure: celular → AP → internet (modo normal). Ad-hoc: notebook ↔ notebook (sem AP). WDS: APs comunicam-se entre si para estender a rede sem cabeamento adicional.",
      },
      {
        q: "O que é band steering em redes Wi-Fi dual-band?",
        o: [
          "Técnica que direciona dispositivos compatíveis para a banda 5 GHz automaticamente",
          "Ajuste automático da potência do sinal",
          "Balanceamento de carga entre APs",
          "Criptografia diferenciada por banda",
        ],
        c: 0,
        e: "Band steering detecta dispositivos dual-band e os 'empurra' para 5 GHz (menos congestionada, mais rápida). O AP reduz resposta aos probes do cliente em 2,4 GHz, forçando-o a conectar em 5 GHz. Dispositivos só 2,4 GHz não são afetados.",
        x: "Técnica: AP ignora Probe Request em 2,4 GHz de clientes dual-band → cliente tenta 5 GHz e conecta lá. Configurável no AP. Melhora a experiência geral ao desafogar 2,4 GHz.",
      },
      {
        q: "O que são beamforming e MU-MIMO em redes Wi-Fi?",
        o: [
          "Beamforming direciona o sinal ao cliente; MU-MIMO atende múltiplos clientes simultaneamente",
          "Ambos são protocolos de criptografia",
          "Beamforming é para 2,4 GHz e MU-MIMO para 5 GHz",
          "São técnicas de compressão de dados",
        ],
        c: 0,
        e: "Beamforming: o AP ajusta a fase das antenas para concentrar o sinal na direção do cliente (em vez de irradiar igualmente). MU-MIMO (Multi-User MIMO): permite que o AP transmita para vários clientes ao mesmo tempo usando streams espaciais independentes.",
        x: "SU-MIMO (11n/ac wave1): 1 cliente por vez. MU-MIMO (11ac wave2): até 4 clientes DL. Wi-Fi 6 (11ax): MU-MIMO 8×8 DL+UL. Beamforming explícito: AP usa feedback do cliente para otimizar.",
      },
      {
        q: "O que é um controlador wireless (WLC) em redes corporativas?",
        o: [
          "Equipamento centralizado que gerencia múltiplos APs, configurações e políticas de roaming",
          "Software antivírus para redes sem fio",
          "Roteador dedicado para tráfego wireless",
          "Protocolo de criptografia WPA3",
        ],
        c: 0,
        e: "O WLC (Wireless LAN Controller) centraliza a gestão de APs Lightweight. Controla configuração, canais, potência, segurança, roaming e load balancing. APs se conectam ao WLC via protocolo CAPWAP (porta UDP 5246/5247).",
        x: "Arquiteturas: Autônoma (cada AP independente) → Centralizada (WLC + Lightweight APs) → Cloud-managed (Meraki, Aruba Central). Split-MAC: AP lida com L1 (RF), WLC lida com L2+ (autenticação, roaming).",
      },
      {
        q: "O que é 802.11r (Fast BSS Transition) em redes Wi-Fi?",
        o: [
          "Padrão que acelera roaming entre APs com pré-autenticação antes da transição",
          "Protocolo de criptografia avançada para Wi-Fi",
          "Técnica de aumento de alcance do sinal",
          "Método de compressão de dados wireless",
        ],
        c: 0,
        e: "802.11r (FT — Fast BSS Transition) reduz o tempo de roaming ao realizar pré-autenticação e pré-associação com o AP de destino antes do handoff. O cliente negocia chaves antecipadamente, permitindo transição em menos de 50ms.",
        x: "Sem 802.11r: desconecta → reassocia → reaute (200-500ms). Com 802.11r: FT over-the-air ou over-the-DS (<50ms). Complemento: 802.11k (neighbor reports), 802.11v (BSS transition management). Essencial para VoIP wireless.",
      },
    ],
    Difícil: [
      {
        q: "Em redes Wi-Fi corporativas, o que caracteriza o modo WPA2/WPA3-Enterprise em relação ao Personal?",
        o: [
          "Usa servidor RADIUS para autenticação 802.1X individual por usuário",
          "Usa uma senha compartilhada mais longa",
          "É apenas para redes 5 GHz",
          "Não precisa de access point",
        ],
        c: 0,
        e: "WPA-Enterprise usa 802.1X com servidor RADIUS para autenticar cada usuário individualmente (credenciais únicas). WPA-Personal (PSK) usa uma senha compartilhada por todos. Enterprise permite auditoria, revogação individual e políticas por usuário. Usa EAP (PEAP, EAP-TLS) como framework de autenticação.",
        x: "Personal: todos compartilham a mesma PSK. Enterprise: User→AP→RADIUS→AD/LDAP. Protocolos EAP: PEAP (user/pass), EAP-TLS (certificados). Se um funcionário sai, revoga-se apenas suas credenciais.",
      },
      {
        q: "O que é um rogue access point e como o WIDS/WIPS ajuda a detectá-lo?",
        o: [
          "AP não autorizado na rede; WIDS/WIPS monitora o espectro e detecta APs desconhecidos",
          "AP com firmware atualizado; WIDS verifica versões",
          "AP configurado com WPA3; WIPS força atualização",
          "AP com múltiplos SSIDs; WIDS limita a quantidade",
        ],
        c: 0,
        e: "Rogue AP é um access point não autorizado na rede corporativa. WIDS (Wireless Intrusion Detection) monitora o espectro RF e detecta APs desconhecidos. WIPS (Prevention) pode desautenticar clientes conectados ao rogue AP.",
        x: "Detecção: WIDS compara APs detectados com lista de autorizados. Contenção: WIPS envia deauth frames. Prevenção: 802.1X + NAC impede dispositivos não autorizados.",
      },
      {
        q: "O que é o problema da estação oculta (hidden node) e como o RTS/CTS resolve?",
        o: [
          "Duas estações não se veem mas transmitem ao AP causando colisão; RTS/CTS reserva o canal",
          "Estação que esconde seu SSID; RTS/CTS força exibição",
          "Estação com sinal fraco; RTS/CTS amplifica o sinal",
          "Estação conectada a AP errado; RTS/CTS força roaming",
        ],
        c: 0,
        e: "Hidden node: A e C alcançam o AP (B) mas não se alcançam. Transmissões simultâneas causam colisão no AP. RTS/CTS: A envia RTS → AP responde CTS (ouvido por todos) → C espera → A transmite sem colisão.",
        x: "CSMA/CA sem RTS/CTS: A não ouve C e transmite → colisão. Com RTS/CTS: CTS indica NAV timer (período de silêncio). Overhead: útil apenas com frames grandes ou hidden nodes.",
      },
      {
        q: "O que é DFS (Dynamic Frequency Selection) na banda de 5 GHz?",
        o: [
          "Mecanismo que detecta sinais de radar e muda automaticamente de canal para evitá-los",
          "Seleção automática da melhor criptografia",
          "Ajuste dinâmico da potência de transmissão",
          "Protocolo de roaming entre APs",
        ],
        c: 0,
        e: "DFS é obrigatório em certos canais de 5 GHz (compartilhados com radares meteorológicos e militares). O AP monitora o canal; se detecta radar, deve mudar de canal em segundos. Canais DFS ficam indisponíveis por 30 minutos após detecção.",
        x: "Canais DFS (5 GHz): 52–64, 100–144 (depende do país). Canais não-DFS: 36–48, 149–165. DFS amplia os canais disponíveis, mas com risco de mudança repentina. Outdoor: DFS é mais crítico.",
      },
      {
        q: "O que é OFDMA no Wi-Fi 6 e como melhora a eficiência?",
        o: [
          "Divide o canal em sub-canais (Resource Units) para atender múltiplos clientes simultaneamente",
          "Aumenta a potência de transmissão do AP",
          "Criptografa cada pacote individualmente",
          "Reduz o número de antenas necessárias",
        ],
        c: 0,
        e: "OFDMA (Orthogonal Frequency-Division Multiple Access) divide o canal em Resource Units (RUs) menores, permitindo que o AP envie dados para vários clientes ao mesmo tempo no mesmo slot de tempo. Ideal para tráfego de baixa latência (IoT, VoIP).",
        x: "OFDM (Wi-Fi 5): canal inteiro para 1 cliente por vez. OFDMA (Wi-Fi 6): canal dividido em RUs (ex: 20 MHz → 9 RUs de 2 MHz). Cada RU atende 1 cliente. Similar ao LTE/5G. Melhora eficiência em ambientes densos.",
      },
      {
        q: "O que é BSS Coloring no Wi-Fi 6 e como melhora o desempenho?",
        o: [
          "Técnica que identifica BSSs vizinhos por 'cor', permitindo reúso espacial ao transmitir simultaneamente",
          "Método de colorir pacotes para priorização QoS",
          "Sistema de LEDs para indicar estado do AP",
          "Protocolo de balanceamento de carga entre APs",
        ],
        c: 0,
        e: "BSS Coloring atribui um identificador (cor, 1-63) a cada BSS. Ao detectar sinais com cor diferente abaixo de um limiar, o dispositivo pode transmitir simultaneamente (spatial reuse) em vez de esperar (CCA). Reduz latência em ambientes densos.",
        x: "Sem BSS Coloring: CCA detecta qualquer sinal → espera (defer). Com BSS Coloring: identifica OBSS (cor diferente) → se sinal fraco, transmite (SR). Parte do 802.11ax. Complementa OFDMA e MU-MIMO.",
      },
      {
        q: "O que é TWT (Target Wake Time) no Wi-Fi 6?",
        o: [
          "Mecanismo que agenda horários de comunicação entre AP e clientes para economizar energia",
          "Protocolo de sincronização de relógio entre APs",
          "Técnica de aumento de throughput em 5 GHz",
          "Método de detecção de interferência radar",
        ],
        c: 0,
        e: "TWT (Target Wake Time) permite que AP e cliente negociem janelas de tempo para comunicação. Fora dessas janelas, o cliente entra em modo sleep. Ideal para dispositivos IoT e sensores que transmitem dados esporadicamente.",
        x: "TWT individual: AP negocia com cada cliente. TWT broadcast: AP define janela para grupo. Economia: até 7x mais bateria em IoT. Wi-Fi 5: PS-Poll/DTIM (menos eficiente). TWT é similar ao DRX do LTE/5G.",
      },
    ],
  },

  // ── Segurança de Redes ──
  "Segurança de Redes": {
    Fácil: [
      {
        q: "O que é um ataque de phishing?",
        o: [
          "Tentativa de obter dados sensíveis se passando por entidade confiável",
          "Invadir redes Wi-Fi",
          "Atacar servidores com excesso de requisições",
          "Adivinhar senhas por tentativa e erro",
        ],
        c: 0,
        e: "Phishing é engenharia social: o atacante se disfarça de entidade confiável (banco, empresa) via email, SMS ou site falso para enganar a vítima e obter credenciais, dados bancários ou instalar malware. É o ataque mais comum na internet.",
        x: "Exemplo: email falso do 'seu banco' pedindo para atualizar dados em um link que leva a um site clone. Variantes: spear phishing (alvo específico), whaling (executivos), smishing (SMS), vishing (voz).",
      },
      {
        q: "O que é um ataque DDoS (Distributed Denial of Service)?",
        o: [
          "Ataque que sobrecarrega um servidor com tráfego de múltiplas fontes simultaneamente",
          "Ataque que rouba senhas de usuários",
          "Vírus que se espalha por email",
          "Interceptação de dados criptografados",
        ],
        c: 0,
        e: "DDoS usa milhares de máquinas comprometidas (botnet) para enviar tráfego massivo ao alvo, esgotando recursos e tornando o serviço indisponível. Diferente de DoS (uma máquina), DDoS é distribuído.",
        x: "DoS: uma máquina → alvo. DDoS: botnet (milhares) → alvo. Tipos: volumétrico (UDP flood), protocolo (SYN flood), aplicação (HTTP flood). Mitigação: CDN, rate limiting, Cloudflare, AWS Shield.",
      },
      {
        q: "O que é engenharia social em segurança da informação?",
        o: [
          "Técnica de manipulação psicológica para obter informações confidenciais",
          "Software que protege contra vírus",
          "Método de criptografia de dados",
          "Análise de logs de rede",
        ],
        c: 0,
        e: "Engenharia social explora o fator humano — persuade pessoas a revelar informações ou realizar ações inseguras. Inclui phishing, pretexting, tailgating, baiting. É a ameaça mais difícil de mitigar com tecnologia.",
        x: "Exemplos: ligar para HelpDesk fingindo ser diretor e pedir reset de senha. Deixar pen drive infectado no estacionamento. Seguir funcionário pela porta. Defesa: treinamento de security awareness.",
      },
      {
        q: "O que é malware?",
        o: [
          "Software malicioso que inclui vírus, trojans, worms e ransomware",
          "Hardware defeituoso que danifica a rede",
          "Técnica de engenharia social",
          "Protocolo de segurança desatualizado",
        ],
        c: 0,
        e: "Malware (malicious software) é qualquer software projetado para causar dano. Tipos: vírus (precisa de hospedeiro), worm (se espalha sozinho), trojan (disfarce), ransomware (sequestra dados), spyware (espiona), adware (propaganda).",
        x: "Vírus: infecta arquivos. Worm: replica pela rede (ex: WannaCry). Trojan: parece legítimo. Ransomware: criptografa + pede resgate. Rootkit: esconde presença no SO. Keylogger: captura digitação.",
      },
      {
        q: "O que é autenticação de dois fatores (2FA)?",
        o: [
          "Método que exige dois fatores diferentes para confirmar a identidade",
          "Usar duas senhas diferentes",
          "Autenticar em dois servidores ao mesmo tempo",
          "Login com usuário e email",
        ],
        c: 0,
        e: "2FA requer dois de três fatores: algo que você sabe (senha), algo que você tem (celular/token) ou algo que você é (biometria). Mesmo que a senha vaze, o atacante não acessa sem o segundo fator.",
        x: "Fatores: 1) Conhecimento (senha, PIN). 2) Posse (token, celular, smart card). 3) Inerência (digital, face, íris). MFA (Multi-Factor): 2+ fatores. Duas senhas = ainda só 1 fator (conhecimento).",
      },
      {
        q: "O que é um IDS (Sistema de Detecção de Intrusão)?",
        o: [
          "Sistema que monitora o tráfego da rede e detecta atividades suspeitas ou maliciosas",
          "Software que bloqueia todos os acessos externos",
          "Protocolo de criptografia de dados",
          "Ferramenta de backup automático",
        ],
        c: 0,
        e: "IDS (Intrusion Detection System) analisa o tráfego de rede ou logs de host em busca de padrões de ataque. Tipos: NIDS (baseado em rede) e HIDS (baseado em host). Ele DETECTA e alerta, mas não bloqueia automaticamente.",
        x: "NIDS: monitora tráfego na rede (Snort, Suricata). HIDS: monitora arquivos e logs no host (OSSEC, Wazuh). Detecção: por assinatura (known attacks) ou anomalia (desvio do normal). IDS é passivo; IPS é ativo.",
      },
      {
        q: "O que é criptografia e por que é importante em redes?",
        o: [
          "Técnica que transforma dados legíveis em código ilegível para proteger a confidencialidade",
          "Método de compressão de dados para economizar banda",
          "Protocolo de roteamento seguro",
          "Software que acelera a transferência de arquivos",
        ],
        c: 0,
        e: "Criptografia converte dados em formato ilegível (cifrado) para quem não possui a chave de decifração. Tipos: simétrica (mesma chave, AES) e assimétrica (par de chaves, RSA). Essencial para HTTPS, VPN, email seguro e armazenamento.",
        x: "Simétrica: AES-256, ChaCha20 — rápida, usada para dados em trânsito. Assimétrica: RSA, ECDSA — lenta, usada para troca de chaves e assinaturas digitais. Híbrido (TLS): assimétrica troca chave simétrica.",
      },
    ],
    Médio: [
      {
        q: "O que é um ataque Man-in-the-Middle (MitM)?",
        o: [
          "Interceptar e possivelmente alterar comunicação entre duas partes sem que elas saibam",
          "Sobrecarregar um servidor com requisições",
          "Capturar senhas de Wi-Fi",
          "Injetar código malicioso em websites",
        ],
        c: 0,
        e: "No MitM, o atacante se posiciona entre dois comunicantes, capturando e potencialmente modificando dados em trânsito. As vítimas acreditam estar se comunicando diretamente. Pode ocorrer via ARP spoofing, DNS spoofing, rogue access point ou SSL stripping.",
        x: "Alice↔Mallory↔Bob. Alice pensa que fala com Bob, mas Mallory intercepta. Proteções: HTTPS/TLS, certificate pinning, HSTS, DNSSEC. Em redes locais: ARP spoofing é o vetor mais comum.",
      },
      {
        q: "O que é um ataque de força bruta (brute force) e como se proteger?",
        o: [
          "Tentativa sistemática de todas as combinações de senha; proteção com lockout, 2FA e senhas longas",
          "Ataque que explora vulnerabilidades de software",
          "Interceptação de tráfego de rede",
          "Injeção de código malicioso em formulários",
        ],
        c: 0,
        e: "Brute force: atacante testa todas as combinações possíveis até encontrar a senha. Variante: dictionary attack (palavras comuns). Proteções: lockout após N tentativas, CAPTCHAs, 2FA/MFA, senhas longas e complexas.",
        x: "Senha de 4 dígitos = 10.000 combinações (segundos). 8 chars alfanuméricos = ~2,8 trilhões. Rate limiting: max 5 tentativas/min. Ferramentas: Hydra, John the Ripper, Hashcat.",
      },
      {
        q: "O que são os protocolos SSL e TLS e qual a diferença?",
        o: [
          "Protocolos de criptografia para comunicação segura; TLS é o sucessor mais seguro do SSL",
          "SSL é mais seguro que TLS",
          "Ambos são protocolos de roteamento",
          "SSL é usado em email e TLS apenas em web",
        ],
        c: 0,
        e: "SSL (Secure Sockets Layer) foi substituído pelo TLS (Transport Layer Security). SSL 3.0 teve vulnerabilidades graves (POODLE). TLS 1.2 e 1.3 são os padrões atuais, criptografando comunicação entre cliente e servidor.",
        x: "SSL 2.0/3.0: obsoletos. TLS 1.0/1.1: deprecated. TLS 1.2: amplamente usado. TLS 1.3: mais rápido (1-RTT handshake), mais seguro. 'HTTPS = HTTP + TLS'.",
      },
      {
        q: "O que é um ataque de SQL Injection?",
        o: [
          "Inserção de código SQL malicioso em campos de entrada para manipular o banco de dados",
          "Interceptação de consultas SQL na rede",
          "Quebra de criptografia de bancos de dados",
          "Sobrecarga do servidor de banco de dados com requisições",
        ],
        c: 0,
        e: "SQL Injection: o atacante insere comandos SQL em campos de formulário (login, busca). Se a aplicação não sanitiza inputs, o SQL malicioso executa no banco. Pode ler, alterar ou apagar dados, e até executar comandos no SO.",
        x: "Exemplo: campo login: ' OR '1'='1' -- \u2192 bypass de autenticação. Proteção: prepared statements (parameterized queries), ORM, WAF, validação de input, princípio do menor privilégio no DB.",
      },
      {
        q: "O que é 802.1X (controle de acesso baseado em porta)?",
        o: [
          "Protocolo que exige autenticação antes de conceder acesso à rede via porta de switch ou Wi-Fi",
          "Padrão de cabeamento estruturado",
          "Protocolo de roteamento seguro",
          "Método de criptografia de frames Ethernet",
        ],
        c: 0,
        e: "802.1X é o padrão IEEE para NAC (Network Access Control) baseado em porta. Componentes: Suplicante (cliente), Authenticator (switch/AP) e Authentication Server (RADIUS). Antes de autenticar, só permitido tráfego EAP.",
        x: "Fluxo: PC (suplicante) → Switch (authenticator) → RADIUS (auth server) → AD/LDAP. Se autenticado: porta do switch abre. Se não: porta bloqueada ou VLAN de quarentena.",
      },
      {
        q: "O que é um ataque de XSS (Cross-Site Scripting)?",
        o: [
          "Injeção de código JavaScript malicioso em páginas web para executar no navegador da vítima",
          "Sobrecarga de servidor com requisições simultâneas",
          "Interceptação de tráfego criptografado",
          "Quebra de senhas por força bruta",
        ],
        c: 0,
        e: "XSS permite que o atacante injete scripts maliciosos em páginas vistas por outros usuários. O navegador executa o script confiando na origem. Pode roubar cookies, credenciais ou redirecionar. Tipos: Reflected, Stored e DOM-based.",
        x: "Reflected: script na URL, executa ao clicar. Stored: script salvo no banco (comentários). DOM-based: manipulação do DOM no cliente. Proteção: output encoding, CSP (Content-Security-Policy), HttpOnly cookies, sanitização de input.",
      },
      {
        q: "O que é um IPS e como difere do IDS?",
        o: [
          "IPS bloqueia ameaças automaticamente (inline); IDS apenas detecta e alerta (passivo)",
          "IPS é mais lento que IDS",
          "IDS bloqueia e IPS apenas detecta",
          "Ambos são idênticos em funcionalidade",
        ],
        c: 0,
        e: "IDS (Detection) monitora tráfego e ALERTA sobre ameaças. IPS (Prevention) monitora E BLOQUEIA automaticamente. IPS fica inline (no caminho do tráfego); IDS fica em modo promiscuous/mirror. IPS pode causar latência mas reage em tempo real.",
        x: "IDS: modo mirror/span port → alerta → admin investiga. IPS: inline → drop packet automaticamente. Risco IPS: falso positivo bloqueia tráfego legítimo. Ferramentas: Snort, Suricata (ambos podem ser IDS ou IPS). NGFW integra IPS.",
      },
    ],
    Difícil: [
      {
        q: "Em uma rede corporativa, qual técnica previne ataques de ARP Spoofing?",
        o: [
          "Dynamic ARP Inspection (DAI) no switch",
          "Usar cabos Cat6A",
          "Aumentar o TTL dos pacotes",
          "Configurar DNS reverso",
        ],
        c: 0,
        e: "DAI (Dynamic ARP Inspection) intercepta respostas ARP no switch e as valida contra a tabela do DHCP Snooping. Pacotes ARP com mapeamentos IP-MAC inválidos são descartados. Requer DHCP Snooping habilitado para construir a binding table confiável.",
        x: "Defesa em camadas: 1) DHCP Snooping (tabela IP↔MAC confiável). 2) DAI (valida ARPs contra essa tabela). 3) IP Source Guard (valida IPs de origem). Configuração Cisco: `ip arp inspection vlan 10`.",
      },
      {
        q: "O que são honeypots e honeynets em segurança de redes?",
        o: [
          "Sistemas intencionalmente vulneráveis para atrair atacantes e estudar suas técnicas",
          "Firewalls que bloqueiam tráfego malicioso",
          "Redes Wi-Fi seguras para testes",
          "Servidores de backup redundantes",
        ],
        c: 0,
        e: "Honeypot é um sistema propositalmente vulnerável para atrair atacantes, estudar técnicas e detectar invasões. Honeynet é uma rede de honeypots. Qualquer acesso é suspeito, pois não há razão legítima para acessá-lo.",
        x: "Tipos: low-interaction (emula serviços, ex: Honeyd), high-interaction (sistema real). Honeynet = rede completa. Uso: pesquisa de ameaças, early warning, deception defense.",
      },
      {
        q: "O que é o princípio de defesa em profundidade (defense in depth)?",
        o: [
          "Múltiplas camadas de segurança sobrepostas para que a falha de uma não comprometa o sistema",
          "Instalar o firewall mais caro disponível",
          "Usar apenas um mecanismo de segurança muito forte",
          "Concentrar toda a segurança no perímetro da rede",
        ],
        c: 0,
        e: "Defense in depth: múltiplas camadas de proteção. Se uma falha, as outras continuam protegendo. Camadas: perímetro (firewall), rede (IDS/IPS, segmentação), host (antivírus), aplicação (WAF), dados (criptografia, backup).",
        x: "Analogia: castelo medieval — fosso, muralha, torre, portão. Na rede: firewall → IDS/IPS → VLAN → ACLs → antivírus → criptografia → backup. Zero Trust: 'nunca confie, sempre verifique'.",
      },
      {
        q: "O que é DNS Spoofing (DNS Cache Poisoning)?",
        o: [
          "Inserção de registros DNS falsos no cache para redirecionar tráfego a sites maliciosos",
          "Bloqueio de todas as consultas DNS",
          "Criptografia forçada de respostas DNS",
          "Sobrecarga do servidor DNS com requisições",
        ],
        c: 0,
        e: "DNS Cache Poisoning: o atacante insere registros falsos no cache de um resolver DNS, fazendo um domínio legítimo (ex: banco.com) apontar para um IP malicioso. Vítimas acessam o site falso sem perceber. Proteção: DNSSEC, DoH, DoT.",
        x: "Ataque Kaminsky (2008): explorou fraqueza do DNS para envenenar caches. DNSSEC: assinaturas digitais validam respostas DNS. DoH/DoT: criptografam consultas DNS. Ferramentas de detecção: Passive DNS monitoring.",
      },
      {
        q: "O que é SIEM e como auxilia a segurança de redes?",
        o: [
          "Sistema que centraliza, correlaciona e analisa logs de segurança em tempo real",
          "Firewall de última geração",
          "Software antivírus corporativo",
          "Protocolo de autenticação multifator",
        ],
        c: 0,
        e: "SIEM (Security Information and Event Management) coleta logs de múltiplas fontes (firewalls, IDS, servidores, endpoints), correlaciona eventos em tempo real e gera alertas de segurança. Essencial para SOC (Security Operations Center).",
        x: "Ferramentas: Splunk, IBM QRadar, Microsoft Sentinel, Elastic SIEM. Funções: coleta de logs, correlação de eventos, alertas, dashboard, compliance, forense. Regra SIEM: '5 falhas de login em 1 min do mesmo IP → alerta'.",
      },
      {
        q: "O que é Zero Trust Network Access (ZTNA)?",
        o: [
          "Modelo que verifica continuamente identidade e contexto antes de conceder acesso, sem confiar na rede",
          "VPN corporativa com criptografia dupla",
          "Firewall que bloqueia todo tráfego externo",
          "Protocolo de autenticação biométrica",
        ],
        c: 0,
        e: "ZTNA segue o princípio 'nunca confie, sempre verifique'. Cada acesso é autenticado e autorizado individualmente, independente da localização do usuário (interno ou externo). Substitui VPN tradicional em muitos cenários.",
        x: "VPN: acesso à rede inteira após autenticação. ZTNA: acesso granular por aplicação (micro-segmentação). Soluções: Zscaler Private Access, Cloudflare Access, Google BeyondCorp. SASE = ZTNA + CASB + FWaaS + SD-WAN.",
      },
      {
        q: "O que é um ataque de supply chain em software?",
        o: [
          "Comprometimento de componentes, bibliotecas ou atualizações de software para atingir usuários finais",
          "Roubo físico de equipamentos de rede",
          "Sobrecarga de servidores de download",
          "Engenharia social contra fornecedores de hardware",
        ],
        c: 0,
        e: "Supply chain attack compromete o software na cadeia de distribuição: bibliotecas (npm, PyPI), atualizações (SolarWinds Orion, 2020) ou ferramentas de build. O código malicioso é distribuído como atualização legítima para milhares de vítimas.",
        x: "SolarWinds (2020): backdoor em atualização → 18.000 organizações afetadas. Codecov (2021): script de CI comprometido. NPM typosquatting: pacotes maliciosos com nomes similares. Defesa: SBOM, assinatura de artefatos, Sigstore.",
      },
    ],
  },

  // ── Serviços de Rede ──
  "Serviços de Rede": {
    Fácil: [
      {
        q: "Qual porta padrão é utilizada pelo protocolo HTTP?",
        o: ["80", "443", "21", "25"],
        c: 0,
        e: "HTTP usa a porta 80 (não criptografado). HTTPS usa a porta 443 (criptografado com TLS/SSL). Portas bem conhecidas (well-known ports) vão de 0 a 1023 e são reservadas para serviços padrão.",
        x: "Portas comuns: HTTP=80, HTTPS=443, FTP=21, SSH=22, Telnet=23, SMTP=25, DNS=53, DHCP=67/68, POP3=110, IMAP=143, RDP=3389.",
      },
      {
        q: "Qual protocolo é usado para enviar emails?",
        o: [
          "SMTP (Simple Mail Transfer Protocol)",
          "POP3 (Post Office Protocol)",
          "FTP (File Transfer Protocol)",
          "HTTP (HyperText Transfer Protocol)",
        ],
        c: 0,
        e: "SMTP (porta 25 ou 587 com TLS) é usado para ENVIAR emails. POP3 (porta 110) e IMAP (porta 143) são usados para RECEBER/ler. SMTP funciona entre servidores de email e do cliente para o servidor.",
        x: "Enviar: SMTP (25/587). Receber: POP3 (110) baixa e apaga. IMAP (143) mantém no servidor. Versões seguras: SMTPS (465/587+STARTTLS), POP3S (995), IMAPS (993).",
      },
      {
        q: "O que é o protocolo SSH e para que ele é utilizado?",
        o: [
          "Protocolo de acesso remoto seguro com criptografia, porta 22",
          "Protocolo de transferência de arquivos, porta 21",
          "Protocolo de email, porta 25",
          "Protocolo de navegação web, porta 80",
        ],
        c: 0,
        e: "SSH (Secure Shell, porta 22) permite acesso remoto com criptografia forte. Substitui o Telnet (porta 23) que transmite em texto claro. SSH também faz tunneling e transferência de arquivos (SCP, SFTP).",
        x: "Telnet (23): texto claro = inseguro. SSH (22): criptografado. Usos: terminal remoto, SCP/SFTP, port forwarding. Autenticação: senha ou chave pública (mais seguro).",
      },
      {
        q: "O que é o protocolo FTP e quais portas ele utiliza?",
        o: [
          "Protocolo de transferência de arquivos; porta 21 (controle) e porta 20 (dados)",
          "Protocolo de email; porta 25",
          "Protocolo de acesso remoto; porta 22",
          "Protocolo de resolução DNS; porta 53",
        ],
        c: 0,
        e: "FTP (File Transfer Protocol) transfere arquivos entre cliente e servidor. Usa porta 21 para comandos (controle) e porta 20 para transferência de dados (modo ativo). No modo passivo, o servidor indica uma porta alta aleatória para dados.",
        x: "Modo ativo: cliente abre porta alta → servidor conecta de volta na porta 20. Modo passivo (PASV): servidor indica porta alta → cliente conecta. Passivo funciona melhor com firewalls/NAT.",
      },
      {
        q: "Por que o Telnet é considerado inseguro e qual protocolo o substitui?",
        o: [
          "Transmite tudo em texto claro (inclusive senha); substituído pelo SSH",
          "Não suporta IPv6; substituído pelo HTTP",
          "É muito lento; substituído pelo FTP",
          "Não funciona em Linux; substituído pelo RDP",
        ],
        c: 0,
        e: "Telnet (porta 23) transmite TUDO em texto claro, incluindo usuário e senha — qualquer sniffer na rede captura as credenciais. SSH (porta 22) criptografa toda a sessão. Telnet só deve ser usado em redes isoladas de lab.",
        x: "Demonstração: `tcpdump -A port 23` captura login/senha em texto. Com SSH: dados criptografados, ilegíveis. Telnet ainda usado para testar portas: `telnet servidor 80` (verifica conectividade).",
      },
      {
        q: "O que é o protocolo ICMP e para que serve o comando ping?",
        o: [
          "Protocolo de controle que envia mensagens de diagnóstico; ping usa ICMP para testar conectividade",
          "Protocolo de transferência de arquivos; ping envia arquivos",
          "Protocolo de criptografia; ping verifica certificados",
          "Protocolo de roteamento; ping calcula melhores rotas",
        ],
        c: 0,
        e: "ICMP (Internet Control Message Protocol) envia mensagens de erro e diagnóstico. Ping envia Echo Request e recebe Echo Reply para testar se um host está acessível e medir latência. Traceroute/tracert também usa ICMP.",
        x: "Ping: ICMP tipo 8 (Echo Request) → tipo 0 (Echo Reply). Traceroute: envia pacotes com TTL incremental; cada roteador retorna ICMP Time Exceeded (tipo 11). Outros: Destination Unreachable (tipo 3), Redirect (tipo 5).",
      },
      {
        q: "O que é o protocolo ARP e qual sua função?",
        o: [
          "Protocolo que resolve endereços IP em endereços MAC na rede local",
          "Protocolo que converte nomes de domínio em IPs",
          "Protocolo de roteamento entre sub-redes",
          "Protocolo de criptografia de tráfego local",
        ],
        c: 0,
        e: "ARP (Address Resolution Protocol) descobre o endereço MAC correspondente a um IP na mesma sub-rede. O dispositivo envia um ARP Request em broadcast ('quem tem o IP X?') e recebe ARP Reply com o MAC correspondente.",
        x: "ARP Request: broadcast (ff:ff:ff:ff:ff:ff). ARP Reply: unicast. Tabela ARP: cache local IP↔MAC. Comando: `arp -a`. Problema: ARP Spoofing — atacante envia ARP Reply falso. Proteção: DAI no switch.",
      },
    ],
    Médio: [
      {
        q: "Qual é a diferença principal entre FTP e SFTP?",
        o: [
          "SFTP usa SSH para criptografia; FTP transmite dados em texto claro",
          "SFTP é mais rápido que FTP",
          "FTP usa porta 22 e SFTP usa porta 21",
          "Não há diferença prática",
        ],
        c: 0,
        e: "FTP (porta 21) transmite dados e credenciais em texto claro — vulnerável a interceptação. SFTP (porta 22) opera sobre SSH, criptografando toda a comunicação. Há também FTPS (FTP sobre TLS, portas 990/989), que é diferente de SFTP.",
        x: "FTP: porta 21 (controle) + porta 20 (dados/ativo). SFTP: porta 22 (via SSH, um único canal). FTPS: FTP + TLS, portas 990/989 (implícito) ou 21 (explícito/STARTTLS).",
      },
      {
        q: "Qual a diferença entre POP3 e IMAP para recebimento de emails?",
        o: [
          "POP3 baixa emails e remove do servidor; IMAP sincroniza e mantém no servidor",
          "POP3 é mais seguro que IMAP",
          "Ambos são protocolos de envio de email",
          "IMAP usa porta 25 e POP3 usa porta 80",
        ],
        c: 0,
        e: "POP3 (porta 110): baixa emails para o dispositivo e remove do servidor. Ideal para um único dispositivo. IMAP (porta 143): mantém no servidor e sincroniza em múltiplos dispositivos (celular + notebook + web).",
        x: "POP3: offline, local, sem sync multi-device. IMAP: online, servidor, sincronização completa. Gmail/Outlook usam IMAP por padrão. Portas seguras: POP3S=995, IMAPS=993.",
      },
      {
        q: "O que é o protocolo NTP e por que a sincronização de horário é importante?",
        o: [
          "Protocolo de sincronização de relógio; essencial para logs, certificados e autenticação",
          "Protocolo de transferência de arquivos",
          "Protocolo de backup automático",
          "Protocolo de compressão de dados",
        ],
        c: 0,
        e: "NTP (Network Time Protocol, porta 123/UDP) sincroniza os relógios de dispositivos com servidores de tempo. Horário preciso é essencial para: logs (forense), certificados SSL/TLS, Kerberos (tolerância 5 min) e protocolos de roteamento.",
        x: "Stratum: 0 (relógio atômico), 1 (servidor direto), 2, 3... Precisão: ms em LAN, dezenas ms em WAN. Cisco: `ntp server 200.160.0.8`. Linux: chrony ou ntpd.",
      },
      {
        q: "O que é HTTPS e como difere do HTTP?",
        o: [
          "HTTP com criptografia TLS; protege dados em trânsito na porta 443",
          "Versão mais rápida do HTTP sem criptografia",
          "Protocolo exclusivo para transferência de arquivos",
          "HTTP com compressão de dados na porta 8080",
        ],
        c: 0,
        e: "HTTPS = HTTP + TLS (Transport Layer Security). Criptografa a comunicação entre navegador e servidor (porta 443). Protege contra interceptação (MitM), garante integridade e autentica o servidor via certificado digital.",
        x: "HTTP (80): texto claro, vulnerável. HTTPS (443): criptografado, certificado SSL/TLS. Chrome marca HTTP como 'Não seguro'. Let's Encrypt: certificados gratuitos. HSTS: força HTTPS no navegador.",
      },
      {
        q: "O que é LDAP e para que é usado em redes corporativas?",
        o: [
          "Protocolo de acesso a diretórios para gerenciar usuários e recursos (ex: Active Directory)",
          "Protocolo de transferência de arquivos entre servidores",
          "Protocolo de monitoramento de rede",
          "Protocolo de backup automatizado",
        ],
        c: 0,
        e: "LDAP (Lightweight Directory Access Protocol, porta 389) acessa e mantém serviços de diretório distribuídos. O Active Directory da Microsoft usa LDAP. Armazena usuários, grupos, políticas e recursos. LDAPS (porta 636) = LDAP com TLS.",
        x: "Estrutura LDAP: DC=empresa,DC=com → OU=TI → CN=joao. Operações: Bind (login), Search, Add, Modify, Delete. Alternativa moderna: Azure AD (Entra ID) com protocolos web (OAuth/OIDC).",
      },
      {
        q: "O que é um reverse proxy e como difere de um forward proxy?",
        o: [
          "Reverse proxy fica na frente dos servidores protegendo-os; forward proxy fica na frente dos clientes",
          "Ambos são idênticos em funcionalidade",
          "Reverse proxy acelera downloads; forward proxy bloqueia vírus",
          "Forward proxy é para servidores; reverse proxy é para clientes",
        ],
        c: 0,
        e: "Forward proxy: intermediário entre clientes e internet (controle de acesso, cache, anonimato). Reverse proxy: intermediário entre internet e servidores internos (load balancing, SSL termination, cache, proteção).",
        x: "Forward: Cliente → Proxy → Internet (ex: Squid). Reverse: Internet → Reverse Proxy → Servidores (ex: Nginx, HAProxy, Cloudflare). CDN é um tipo de reverse proxy distribuído globalmente.",
      },
      {
        q: "O que é o protocolo RDP e para que é utilizado?",
        o: [
          "Protocolo de acesso remoto gráfico da Microsoft, porta 3389, para controlar desktops Windows",
          "Protocolo de transferência de arquivos criptografados",
          "Protocolo de monitoramento de rede",
          "Protocolo de backup remoto de servidores",
        ],
        c: 0,
        e: "RDP (Remote Desktop Protocol, porta 3389/TCP) permite acesso remoto com interface gráfica a computadores Windows. Transmite tela, teclado, mouse, áudio e até redirecionamento de dispositivos USB.",
        x: "RDP: porta 3389. Alternativas: VNC (multi-plataforma, porta 5900), SSH com X11 forwarding (Linux), TeamViewer/AnyDesk. Segurança: NLA (Network Level Authentication), não expor 3389 na internet, usar VPN.",
      },
    ],
    Difícil: [
      {
        q: "O que é o protocolo SNMP e para que serve o conceito de 'community string'?",
        o: [
          "Protocolo de gerenciamento de rede; community string é a senha de acesso aos dados do dispositivo",
          "Protocolo de roteamento; community string define a área OSPF",
          "Protocolo de email; community string é o domínio de envio",
          "Protocolo de DNS; community string identifica a zona",
        ],
        c: 0,
        e: "SNMP (Simple Network Management Protocol) monitora e gerencia dispositivos de rede (switches, roteadores, servidores). A community string funciona como senha: 'public' (leitura — padrão perigoso) e 'private' (leitura/escrita). SNMPv3 adicionou autenticação real e criptografia.",
        x: "SNMPv1/v2c: community string em texto claro (inseguro). SNMPv3: autenticação (SHA/MD5) + criptografia (AES/DES). Componentes: Manager (NMS), Agent (no dispositivo), MIB (banco de dados de objetos gerenciáveis).",
      },
      {
        q: "O que é QoS (Quality of Service) e como o DSCP prioriza tráfego?",
        o: [
          "Mecanismo que prioriza tipos de tráfego; DSCP marca pacotes com valores de prioridade",
          "QoS aumenta a banda total disponível; DSCP é protocolo de roteamento",
          "QoS funciona apenas em Wi-Fi; DSCP apenas em cabo",
          "QoS e DSCP são a mesma coisa",
        ],
        c: 0,
        e: "QoS prioriza tráfego crítico (VoIP, vídeo) sobre menos prioritário. DSCP (Differentiated Services Code Point) usa 6 bits do cabeçalho IP para marcar prioridade. Switches e roteadores leem o DSCP e enfileiram conforme a prioridade.",
        x: "DSCP EF (46): VoIP (máxima prioridade). AF: 4 classes × 3 drop probabilities. CS: compatível com IP Precedence. Sem QoS: best-effort (todos iguais, VoIP sofre).",
      },
      {
        q: "Qual a diferença entre Syslog e SNMP para monitoramento de rede?",
        o: [
          "Syslog envia logs unidirecionais; SNMP permite consultas bidirecionais e coleta métricas",
          "Ambos são idênticos",
          "Syslog usa SNMP internamente",
          "SNMP é apenas para Windows e Syslog para Linux",
        ],
        c: 0,
        e: "Syslog (porta 514/UDP): dispositivos enviam mensagens de log a um servidor centralizado, unidirecional. SNMP (porta 161/162): manager consulta agents (polling) e agents enviam traps, bidirecional, coleta métricas (CPU, memória, tráfego).",
        x: "Syslog: severidades 0-7 (Emergency→Debug). SNMP: GetRequest, GetNext, Set, Trap. Juntos: SNMP monitora métricas + Syslog registra eventos. Ferramentas: Zabbix/PRTG (SNMP), ELK/Graylog (Syslog).",
      },
      {
        q: "O que é o protocolo RADIUS e como é usado em controle de acesso?",
        o: [
          "Protocolo AAA centralizado: autenticação, autorização e contabilização de acesso à rede",
          "Protocolo de roteamento dinâmico",
          "Protocolo de transferência criptografada de arquivos",
          "Protocolo de sincronização de relógio",
        ],
        c: 0,
        e: "RADIUS (Remote Authentication Dial-In User Service) centraliza AAA: Autenticação (quem é?), Autorização (o que pode fazer?) e Contabilização (o que fez?). Usado com 802.1X para controle de acesso em switches e Wi-Fi empresarial.",
        x: "RADIUS: porta 1812/1813 (UDP). TACACS+ (Cisco): porta 49 (TCP), criptografa todo o payload. RADIUS criptografa só a senha. 802.1X + RADIUS + AD = NAC completo. FreeRADIUS: implementação open-source.",
      },
      {
        q: "O que é NetFlow/sFlow e como difere do SNMP para análise de tráfego?",
        o: [
          "Capturam metadados de fluxos de tráfego (quem fala com quem); SNMP coleta métricas de dispositivos",
          "São versões diferentes do SNMP",
          "NetFlow substitui o Syslog",
          "sFlow é exclusivo para redes Wi-Fi",
        ],
        c: 0,
        e: "NetFlow (Cisco) e sFlow (padrão multi-vendor) exportam informações de fluxos: IP origem/destino, portas, protocolo, bytes, pacotes. Permitem análise detalha de 'quem fala com quem'. SNMP foca em métricas de dispositivos (CPU, interfaces).",
        x: "NetFlow: amostra todos os pacotes (ou amostrado). sFlow: amostragem estatística (1:N). IPFIX: evolução padronizada do NetFlow v9. Ferramentas: ntopng, ElastiFlow, SolarWinds NTA. Uso: detecção de anomalias, planejamento de capacidade.",
      },
      {
        q: "O que é o protocolo TFTP e como difere do FTP?",
        o: [
          "Protocolo simples via UDP (porta 69), sem autenticação; usado para boot de rede e firmware",
          "Versão criptografada do FTP",
          "Protocolo de email simplificado",
          "FTP com compressão automática",
        ],
        c: 0,
        e: "TFTP (Trivial FTP, porta 69/UDP) é extremamente simples: sem autenticação, sem listagem de diretórios, apenas leitura/escrita de arquivos. Usado para PXE boot (boot pela rede), atualização de firmware de switches e transferências em ambientes controlados.",
        x: "FTP: TCP, portas 20/21, autenticação, diretórios, modos ativo/passivo. TFTP: UDP, porta 69, sem auth, só get/put. TFTP + PXE: switch boots firmware via TFTP. Inseguro — usar apenas em redes isoladas.",
      },
      {
        q: "O que é o protocolo MQTT e onde é utilizado?",
        o: [
          "Protocolo leve de mensageria publish/subscribe usado em IoT e ambientes com banda limitada",
          "Protocolo de transferência de vídeo em tempo real",
          "Protocolo de roteamento para redes móveis",
          "Protocolo de autenticação multifator",
        ],
        c: 0,
        e: "MQTT (Message Queuing Telemetry Transport, porta 1883/8883) é um protocolo pub/sub leve, ideal para IoT. Clientes publicam em tópicos e assinam tópicos via broker central. Consome pouca banda e energia.",
        x: "Modelo: Publisher → Broker (Mosquitto, HiveMQ) → Subscriber. QoS: 0 (at most once), 1 (at least once), 2 (exactly once). Alternativas: AMQP (mais robusto), CoAP (RESTful para IoT). AWS IoT Core usa MQTT.",
      },
    ],
  },

  // ── VPN e Túneis ──
  "VPN e Túneis": {
    Fácil: [
      {
        q: "Qual é a principal finalidade de uma VPN?",
        o: [
          "Criar um túnel criptografado entre dois pontos através de uma rede pública",
          "Acelerar a velocidade da internet",
          "Substituir o uso de roteadores",
          "Bloquear anúncios em sites",
        ],
        c: 0,
        e: "VPN (Virtual Private Network) cria um 'túnel' criptografado sobre a internet pública, permitindo comunicação segura como se os dispositivos estivessem na mesma rede privada. Protege confidencialidade e integridade dos dados em trânsito.",
        x: "Exemplo: funcionário em home office usa VPN para acessar servidores da empresa como se estivesse no escritório. Tráfego é criptografado e encapsulado, invisível a terceiros na internet.",
      },
      {
        q: "O que é um túnel VPN?",
        o: [
          "Canal criptografado dentro de uma rede pública que protege os dados em trânsito",
          "Cabo físico subterrâneo entre dois sites",
          "Tipo de firewall para redes remotas",
          "Protocolo de roteamento dinâmico",
        ],
        c: 0,
        e: "Um túnel VPN encapsula dados em um protocolo de tunelamento (IPsec, OpenVPN, WireGuard), criptografando todo o conteúdo. O pacote original fica dentro de um novo pacote, como carta em envelope lacrado.",
        x: "Protocolos: IPsec, OpenVPN (SSL/TLS), WireGuard, L2TP, PPTP (obsoleto). O tráfego encapsulado parece normal para observadores externos na rede pública.",
      },
      {
        q: "Cite dois usos comuns de VPN no dia a dia.",
        o: [
          "Acesso remoto ao trabalho e proteção em redes Wi-Fi públicas",
          "Acelerar downloads e aumentar velocidade da internet",
          "Bloquear vírus e substituir o antivírus",
          "Aumentar o alcance do Wi-Fi e melhorar o sinal",
        ],
        c: 0,
        e: "Usos comuns: 1) Home office — acessar rede corporativa com segurança. 2) Wi-Fi público — proteção contra interceptação. 3) Acesso a conteúdo geo-restrito. 4) Privacidade de navegação.",
        x: "Corporativo: site-to-site (escritórios) e remote access (funcionários). Pessoal: NordVPN, ExpressVPN para privacidade. VPN não torna anônimo — o provedor de VPN vê o tráfego.",
      },
      {
        q: "O que acontece com seus dados quando você se conecta a uma VPN?",
        o: [
          "São criptografados antes de sair do dispositivo e viajam por um túnel seguro",
          "São comprimidos para economizar banda",
          "Ficam armazenados no servidor VPN para sempre",
          "São duplicados para redundância",
        ],
        c: 0,
        e: "Com VPN ativa, todos os dados (ou parte, no split tunnel) são criptografados no dispositivo ANTES de saírem pela rede. Viajam pelo túnel VPN até o servidor VPN, que decifra e encaminha ao destino. Na volta, o processo é inverso.",
        x: "Fluxo: App → Criptografia (VPN client) → Internet (túnel criptografado) → VPN Server → Decifra → Destino. Observadores na rede local ou ISP veem apenas dados cifrados.",
      },
      {
        q: "O que é um concentrador VPN?",
        o: [
          "Dispositivo que gerencia múltiplas conexões VPN simultâneas",
          "Cabo especial para VPN",
          "Software antivírus com VPN integrada",
          "Roteador que bloqueia VPNs",
        ],
        c: 0,
        e: "O concentrador VPN (VPN gateway/headend) é o servidor ou appliance que aceita e gerencia múltiplas conexões VPN simultaneamente. Em empresas: Cisco ASA, FortiGate, pfSense. Gerencia autenticação, criptografia e roteamento dos túneis.",
        x: "Concentrador é o ponto central (hub). Funcionários remotos (spokes) conectam-se ao concentrador. Capacidade: centenas ou milhares de túneis simultâneos. Redundância: HA (high availability) com failover.",
      },
      {
        q: "O que é PPTP e por que não é recomendado atualmente?",
        o: [
          "Protocolo VPN antigo com vulnerabilidades de criptografia conhecidas; substituído por IPsec/WireGuard",
          "Protocolo VPN mais seguro disponível",
          "Protocolo de roteamento dinâmico",
          "Método de compressão de dados",
        ],
        c: 0,
        e: "PPTP (Point-to-Point Tunneling Protocol, porta TCP 1723) foi um dos primeiros protocolos VPN. Sua criptografia (MS-CHAPv2) tem vulnerabilidades graves e pode ser quebrada. Não deve ser usado em ambientes que exigem segurança.",
        x: "PPTP: rápido de configurar, mas inseguro. MS-CHAPv2 quebrável com ferramentas como chapcrack. Alternativas seguras: IPsec, OpenVPN, WireGuard, L2TP/IPsec. PPTP ainda presente em equipamentos legados.",
      },
      {
        q: "O que é L2TP e como é combinado com IPsec?",
        o: [
          "Protocolo de tunelamento L2 sem criptografia própria; combinado com IPsec (L2TP/IPsec) para segurança",
          "Protocolo de criptografia que substitui o IPsec",
          "Protocolo de roteamento para VPNs",
          "Software de gerenciamento de túneis",
        ],
        c: 0,
        e: "L2TP (Layer 2 Tunneling Protocol) encapsula dados na camada 2 mas NÃO criptografa. Por isso é combinado com IPsec: L2TP cria o túnel e IPsec fornece criptografia e autenticação. L2TP/IPsec usa porta UDP 1701.",
        x: "L2TP sozinho: tunelamento sem segurança. L2TP/IPsec: encapsula L2TP dentro de ESP (IPsec). Duplo encapsulamento = mais overhead vs OpenVPN/WireGuard. Suporte nativo: Windows, macOS, iOS, Android.",
      },
    ],
    Médio: [
      {
        q: "Qual a diferença entre VPN site-to-site e VPN de acesso remoto?",
        o: [
          "Site-to-site conecta redes inteiras; acesso remoto conecta um usuário individual à rede",
          "Ambas são idênticas",
          "Site-to-site não usa criptografia",
          "Acesso remoto é mais seguro",
        ],
        c: 0,
        e: "Site-to-site: conecta duas redes inteiras (ex: escritórios de uma empresa em cidades diferentes) de forma permanente. Usa roteadores/firewalls nas pontas. Acesso remoto: um usuário individual se conecta à rede corporativa (ex: home office) via software cliente VPN. Conexão sob demanda.",
        x: "Site-to-site: Escritório SP ↔ Escritório RJ (sempre ligado, roteador-a-roteador). Acesso remoto: Notebook de José → Internet → VPN Server da empresa (sob demanda, cliente VPN no notebook).",
      },
      {
        q: "Quais são as principais diferenças entre IPsec e OpenVPN?",
        o: [
          "IPsec opera na camada 3 (kernel); OpenVPN opera na camada 7 (SSL/TLS, user-space)",
          "Ambos são idênticos em funcionamento",
          "IPsec é open-source e OpenVPN é proprietário",
          "OpenVPN é mais rápido em todos os cenários",
        ],
        c: 0,
        e: "IPsec: camada 3, integrado ao kernel, usa IKE para negociação. Complexo mas rápido. OpenVPN: camada 7, SSL/TLS, user-space, mais fácil de configurar e atravessar firewalls (porta 443). WireGuard é alternativa mais nova e rápida.",
        x: "IPsec: kernel-space, UDP 500/4500, suporte nativo em roteadores. OpenVPN: user-space, TCP/UDP 1194 ou 443. WireGuard: kernel, UDP, mais simples que ambos.",
      },
      {
        q: "O que é split tunneling em VPN e quais os riscos?",
        o: [
          "Parte do tráfego vai pela VPN e parte direto pela internet; risco de vazamento de dados",
          "Usar duas VPNs simultaneamente",
          "Dividir a banda entre upload e download",
          "Conectar a duas redes corporativas ao mesmo tempo",
        ],
        c: 0,
        e: "Split tunneling: apenas tráfego corporativo passa pela VPN; o restante vai direto pela internet. Reduz carga no concentrador VPN, mas cria risco: malware na internet pode acessar a rede corporativa via dispositivo dual-homed.",
        x: "Full tunnel: TODO tráfego → VPN (mais seguro, mais lento). Split tunnel: só corporativo → VPN, resto → internet (menos seguro, mais rápido). Risco: PC infectado vira ponte.",
      },
      {
        q: "O que é WireGuard e quais suas vantagens?",
        o: [
          "Protocolo VPN moderno, simples (~4000 linhas de código), rápido e com criptografia moderna",
          "Versão atualizada do IPsec",
          "Protocolo VPN exclusivo para Windows",
          "Firewall que inclui VPN integrada",
        ],
        c: 0,
        e: "WireGuard é um protocolo VPN moderno com apenas ~4000 linhas de código (vs 600K do OpenVPN). Usa criptografia de última geração (ChaCha20, Curve25519, BLAKE2s). Integrado ao kernel Linux. Mais rápido e simples de auditar.",
        x: "IPsec: complexo, muitas opções. OpenVPN: modular, user-space. WireGuard: minimalista, kernel-space, UDP. Throughput: WireGuard > IPsec > OpenVPN. Adotado: Cloudflare WARP, Mullvad, Tailscale.",
      },
      {
        q: "O que é NAT-T (NAT Traversal) em VPN IPsec?",
        o: [
          "Encapsula pacotes IPsec em UDP porta 4500 para atravessar dispositivos NAT",
          "Protocolo de roteamento para VPNs",
          "Técnica de compressão de pacotes VPN",
          "Método de autenticação multifator para VPN",
        ],
        c: 0,
        e: "IPsec usa protocolo ESP (IP 50) que não tem portas — incompatível com NAT. NAT-T detecta NAT no caminho e encapsula ESP dentro de UDP porta 4500, permitindo que o tráfego passe por roteadores NAT normalmente.",
        x: "Sem NAT-T: ESP (prot 50) → NAT altera IP → checksum inválido → falha. Com NAT-T: [IP][UDP 4500][ESP][Dados] → NAT traduz normalmente. IKE negocia NAT-T automaticamente (RFC 3947).",
      },
      {
        q: "O que é Perfect Forward Secrecy (PFS) em VPN?",
        o: [
          "Propriedade que garante que comprometimento de uma chave não compromete sessões anteriores",
          "Método de compressão de dados em VPN",
          "Protocolo de redundância de túneis",
          "Técnica de balanceamento de carga entre VPNs",
        ],
        c: 0,
        e: "PFS gera chaves de sessão efemeras via Diffie-Hellman a cada sessão. Se a chave privada de longo prazo for comprometida, sessões passadas permanecem seguras. IKEv2 suporta PFS nativamente.",
        x: "Sem PFS: chave master comprometida → todas as sessões gravadas podem ser decifradas. Com PFS: cada sessão gera chave DH única → impossível decifrar sessões passadas. TLS 1.3 também exige PFS (ECDHE).",
      },
      {
        q: "O que é SSL VPN e como difere do IPsec VPN?",
        o: [
          "VPN baseada em SSL/TLS que funciona via navegador ou cliente leve; mais fácil de atravessar firewalls",
          "Versão mais antiga do IPsec",
          "VPN exclusiva para redes locais",
          "Protocolo de roteamento com criptografia",
        ],
        c: 0,
        e: "SSL VPN usa TLS (porta 443) e pode funcionar via navegador (clientless/portal) ou cliente leve. Atravessa firewalls facilmente (porta 443 geralmente aberta). IPsec requer cliente específico e portas UDP 500/4500.",
        x: "SSL VPN clientless: acessa apps web via portal HTTPS (sem instalar nada). SSL VPN full-tunnel: cliente leve, acesso completo à rede. Cisco AnyConnect, FortiClient, Pulse Secure. IPsec: mais performance, SSL VPN: mais flexibilidade.",
      },
    ],
    Difícil: [
      {
        q: "Qual a diferença entre os modos Túnel e Transporte no IPsec?",
        o: [
          "Modo Túnel encapsula o pacote IP inteiro com novo cabeçalho; Modo Transporte protege apenas o payload",
          "Não há diferença prática",
          "Modo Transporte é usado apenas em IPv6",
          "Modo Túnel não criptografa dados",
        ],
        c: 0,
        e: "Modo Transporte: protege apenas o payload (dados) do pacote IP original, mantendo o cabeçalho IP original. Usado em comunicação host-to-host. Modo Túnel: encapsula o pacote IP INTEIRO (cabeçalho + dados) dentro de um novo pacote com novo cabeçalho IP. Usado em VPN site-to-site e gateway-to-gateway.",
        x: "Transporte: [IP_orig][ESP/AH][Payload_criptografado]. Túnel: [Novo_IP][ESP/AH][IP_orig_criptografado][Payload_criptografado]. Túnel esconde o IP original interno, essencial em VPNs site-to-site.",
      },
      {
        q: "O que é IKE (Internet Key Exchange) e qual seu papel no IPsec?",
        o: [
          "Protocolo que negocia parâmetros de segurança e troca chaves criptográficas para IPsec",
          "Protocolo de roteamento para VPNs",
          "Algoritmo de criptografia simétrica",
          "Método de autenticação via RADIUS",
        ],
        c: 0,
        e: "IKE negocia os Security Associations (SAs) do IPsec: Fase 1 (IKE SA) autentica os peers e estabelece canal seguro. Fase 2 (IPsec SA) negocia parâmetros do túnel. IKEv2 simplifica e suporta MOBIKE (mobilidade).",
        x: "IKEv1: Main Mode (6 msgs) ou Aggressive (3). IKEv2: 4 mensagens (IKE_SA_INIT + IKE_AUTH). Porta UDP 500, 4500 (NAT-T). Autenticação: PSK ou certificados.",
      },
      {
        q: "Qual a diferença entre GRE e IPsec e por que são combinados?",
        o: [
          "GRE encapsula mas não criptografa; IPsec criptografa mas não suporta multicast. GRE over IPsec combina ambos",
          "GRE é mais seguro que IPsec",
          "Ambos são protocolos de roteamento",
          "GRE substitui o IPsec em redes modernas",
        ],
        c: 0,
        e: "GRE (protocolo 47): tunela qualquer protocolo (multicast, IPv6 over IPv4) mas SEM criptografia. IPsec (ESP protocolo 50): criptografa e autentica mas não suporta multicast nativamente. GRE over IPsec: tunelamento GRE + criptografia IPsec.",
        x: "GRE: encapsula, sem criptografia. IPsec: criptografa, sem multicast. GRE over IPsec: OSPF/EIGRP + criptografia. mGRE + IPsec = DMVPN (Dynamic Multipoint VPN).",
      },
      {
        q: "O que é DMVPN (Dynamic Multipoint VPN) e qual sua vantagem?",
        o: [
          "Permite túneis hub-and-spoke e spoke-to-spoke dinâmicos sem configuração ponto-a-ponto",
          "VPN que só funciona em redes locais",
          "Protocolo de roteamento para VPNs",
          "VPN que não requer criptografia",
        ],
        c: 0,
        e: "DMVPN (Cisco) usa mGRE + NHRP + IPsec. Spokes constroem túneis sob demanda diretamente entre si (spoke-to-spoke), sem passar pelo hub. Elimina configuração manual ponto-a-ponto em redes com muitas filiais.",
        x: "Fases: Phase 1 (hub-spoke), Phase 2 (spoke-spoke via NHRP), Phase 3 (spoke-spoke com sumário/default). NHRP: Next-Hop Resolution Protocol — mapeia tunnel IP → NBMA address (IP real).",
      },
      {
        q: "Qual a diferença entre MPLS VPN e IPsec VPN?",
        o: [
          "MPLS VPN usa rótulos na rede da operadora (sem criptografia nativa); IPsec criptografa sobre internet pública",
          "Ambas são idênticas",
          "MPLS é gratuito e IPsec é pago",
          "IPsec funciona apenas em redes locais",
        ],
        c: 0,
        e: "MPLS VPN (L3VPN): operadora cria VRFs isoladas na rede MPLS — tráfego privado sem criptografia (depende da confiança na operadora). IPsec VPN: criptografa sobre a internet pública (mais barato, menos SLA). Combinação: MPLS + IPsec = privacidade + criptografia.",
        x: "MPLS L3VPN: PE (Provider Edge) + CE (Customer Edge) + VRF. QoS garantido, SLA da operadora, custo alto. IPsec: internet, custo baixo, sem SLA. SD-WAN: combina MPLS + internet + IPsec + políticas inteligentes.",
      },
      {
        q: "O que é SD-WAN e como se relaciona com VPNs?",
        o: [
          "Tecnologia que virtualiza a WAN combinando múltiplos links com políticas inteligentes de roteamento",
          "Versão sem fio do IPsec",
          "Protocolo de roteamento exclusivo para VPNs",
          "Firewall dedicado para tráfego VPN",
        ],
        c: 0,
        e: "SD-WAN (Software-Defined WAN) abstrai o transporte (MPLS, internet, 4G/5G) e aplica políticas inteligentes: tráfego crítico via MPLS, bulk via internet. Inclui VPN IPsec automática entre sites, simplificando a gestão.",
        x: "Sem SD-WAN: MPLS caro, configuração manual. Com SD-WAN: orquestração centralizada, failover automático. Vendors: Cisco Viptela, VMware VeloCloud, Fortinet, Silver Peak. SASE = SD-WAN + segurança (ZTNA, CASB, FWaaS).",
      },
      {
        q: "O que é VXLAN e como estende redes L2 sobre L3?",
        o: [
          "Protocolo overlay que encapsula frames Ethernet em UDP/IP, criando até 16 milhões de segmentos",
          "Protocolo de criptografia para VLANs",
          "Versão estendida do IPsec",
          "Técnica de compressão de tráfego de rede",
        ],
        c: 0,
        e: "VXLAN (Virtual Extensible LAN, RFC 7348) encapsula frames L2 em pacotes UDP/IP (porta 4789), permitindo estender domínios L2 sobre redes L3. Usa VNI (VXLAN Network Identifier) de 24 bits = ~16 milhões de segmentos (vs 4096 VLANs).",
        x: "VLAN: 12 bits = 4094 IDs. VXLAN: 24 bits = ~16M VNIs. VTEP (VXLAN Tunnel Endpoint): encapsula/desencapsula frames. Usado em data centers e cloud (multi-tenant). Concorrentes: NVGRE, Geneve (preferêncial no Linux).",
      },
    ],
  },

  // ── VoIP ──
  VoIP: {
    Fácil: [
      {
        q: "O que significa VoIP?",
        o: [
          "Voice over Internet Protocol — voz transmitida pela internet",
          "Video over IP — vídeo pela internet",
          "Virtual Office IP — escritório virtual",
          "Voice over Intranet Protocol — voz em intranet",
        ],
        c: 0,
        e: "VoIP (Voice over Internet Protocol) é a tecnologia que permite transmitir chamadas de voz pela internet ou redes IP, em vez de usar a rede telefônica tradicional (PSTN). Exemplos: Skype, WhatsApp, Zoom, Microsoft Teams.",
        x: "A voz é digitalizada, comprimida em codecs (G.711, G.729), empacotada em RTP/UDP/IP e transmitida pela rede. Vantagens: custo menor, integração com dados, flexibilidade. Desafio: qualidade depende da rede.",
      },
      {
        q: "Cite um exemplo popular de aplicativo que usa tecnologia VoIP.",
        o: [
          "WhatsApp, Skype ou Zoom — chamadas de voz pela internet",
          "Microsoft Word — processador de texto",
          "Antivírus Kaspersky — proteção contra malware",
          "FileZilla — transferência de arquivos",
        ],
        c: 0,
        e: "WhatsApp, Skype, Zoom, Microsoft Teams, Google Meet e Discord usam VoIP para chamadas pela internet. Economizam custos em relação à telefonia tradicional (PSTN) e permitem chamadas internacionais gratuitas.",
        x: "Pessoal: WhatsApp, Telegram, FaceTime. Empresarial: Teams, Cisco Webex, Zoom Phone. Tradicional: Asterisk (PBX open-source). Softphone: app que simula telefone (Zoiper, Linphone).",
      },
      {
        q: "Qual a principal vantagem do VoIP em relação à telefonia convencional (PSTN)?",
        o: [
          "Custo menor e integração com dados — chamadas pela internet",
          "Qualidade de áudio sempre superior à PSTN",
          "Funciona sem internet",
          "Não requer nenhum equipamento especial",
        ],
        c: 0,
        e: "Vantagens: custo reduzido (especialmente internações), integração com sistemas (CRM, email), mobilidade, escalabilidade (ramais simples) e funcionalidades avançadas (gravação, URA, videoconferência).",
        x: "VoIP: custo por ligação ≈ 0 (internet). PSTN: tarifação por minuto. Desvantagens VoIP: depende da internet, latência, jitter, perda de pacotes. PSTN: qualidade garantida mas cara.",
      },
      {
        q: "Qual protocolo de transporte (TCP ou UDP) é usado nas chamadas VoIP e por quê?",
        o: [
          "UDP — menor latência e retransmissão não faz sentido em áudio em tempo real",
          "TCP — porque garante entrega de todos os pacotes",
          "Ambos são usados igualmente",
          "Nem TCP nem UDP — usa protocolo próprio",
        ],
        c: 0,
        e: "VoIP usa UDP porque áudio em tempo real não tolera atrasos de retransmissão do TCP. Se um pacote se perde, retransmiti-lo chegaria tarde demais. Melhor ignorar e continuar. RTP (sobre UDP) é o protocolo que transporta a mídia.",
        x: "TCP: confiável mas com retransmissões (atraso). UDP: sem garantia mas sem atraso. Para VoIP, pacote atrasado = inútil. Perda ≤ 1% é imperceptível. SIP (sinalização) pode usar TCP ou UDP.",
      },
      {
        q: "O que é um softphone?",
        o: [
          "Aplicativo que permite fazer chamadas VoIP usando computador ou celular",
          "Telefone com tela sensível ao toque",
          "Hardware especializado para VoIP",
          "Software de gravação de ligações",
        ],
        c: 0,
        e: "Softphone é um software que simula um telefone, permitindo fazer/receber chamadas VoIP pelo computador ou celular. Usa microfone e alto-falante do dispositivo. Exemplos: Zoiper, Linphone, Cisco Jabber, Microsoft Teams.",
        x: "Softphone vs Hardphone (telefone IP físico): softphone é mais flexível e barato. Hardphone: melhor qualidade de áudio, dedicado. Webphone: softphone no navegador (WebRTC). Todos registram-se no PBX via SIP.",
      },
      {
        q: "O que é latência em chamadas VoIP?",
        o: [
          "Atraso entre falar e a outra pessoa ouvir; deve ser menor que 150ms para boa qualidade",
          "Volume do áudio durante a chamada",
          "Número de chamadas simultâneas suportadas",
          "Qualidade do codec utilizado",
        ],
        c: 0,
        e: "Latência (delay) é o tempo total para a voz sair do falante e chegar ao ouvinte. Inclui: codificação, empacotamento, propagação na rede e jitter buffer. Até 150ms: imperceptível. 150-300ms: perceptível. >300ms: conversação difícil.",
        x: "Fontes de latência: codec (5-40ms), packetization (20ms), jitter buffer (20-80ms), propagação (5ms/1000km), serialization. Latência um sentido (one-way) < 150ms (ITU-T G.114). Satélite GEO: ~250ms só propagação.",
      },
      {
        q: "O que é SIP (Session Initiation Protocol)?",
        o: [
          "Protocolo de sinalização que inicia, modifica e encerra sessões de comunicação VoIP",
          "Protocolo que transporta o áudio da chamada",
          "Codec de compressão de voz",
          "Software de PBX para empresas",
        ],
        c: 0,
        e: "SIP (Session Initiation Protocol, porta 5060/5061) é o protocolo de sinalização dominante em VoIP. Ele estabelece, modifica e encerra chamadas. O áudio em si é transportado por RTP. SIP é baseado em texto, similar ao HTTP.",
        x: "Mensagens SIP: INVITE (iniciar), 200 OK (aceitar), ACK (confirmar), BYE (encerrar), REGISTER (registrar no servidor). SIP Proxy: roteamento de chamadas. SIP Registrar: mantém localização dos usuários.",
      },
    ],
    Médio: [
      {
        q: "Qual protocolo é responsável por transportar o áudio em tempo real nas chamadas VoIP?",
        o: [
          "RTP (Real-time Transport Protocol)",
          "SIP (Session Initiation Protocol)",
          "HTTP",
          "SMTP",
        ],
        c: 0,
        e: "RTP transporta o fluxo de áudio/vídeo em tempo real. SIP é responsável por sinalização (iniciar, modificar, encerrar chamadas), mas não carrega o áudio. RTP usa UDP para baixa latência e inclui timestamps e números de sequência para reordenação.",
        x: "SIP: sinalização (INVITE → 200 OK → ACK → BYE). RTP: transporte de mídia (áudio/vídeo em tempo real). RTCP: relatórios de qualidade (jitter, perda de pacotes). Porta RTP: dinâmica (tipicamente 16384-32767).",
      },
      {
        q: "Qual a diferença entre os protocolos SIP e H.323 em VoIP?",
        o: [
          "SIP é baseado em texto e mais simples; H.323 é binário e mais complexo",
          "Ambos são idênticos",
          "SIP é mais antigo que H.323",
          "H.323 é usado apenas em redes Wi-Fi",
        ],
        c: 0,
        e: "SIP: baseado em texto (similar ao HTTP), leve e flexível, amplamente usado. H.323: padrão ITU-T, binário (ASN.1/BER), mais complexo, em sistemas legados. SIP dominou o mercado por simplicidade.",
        x: "SIP: porta 5060 (UDP/TCP), 5061 (TLS). Mensagens: INVITE, ACK, BYE, REGISTER. H.323: Gateway, Gatekeeper, MCU. SIP domina o mercado atual.",
      },
      {
        q: "O que é um codec de áudio em VoIP e quais os mais comuns?",
        o: [
          "Algoritmo que comprime/descomprime áudio; G.711 (sem compressão) e G.729 (comprimido)",
          "Driver de placa de som para VoIP",
          "Tipo de microfone especial para chamadas",
          "Protocolo de rede para transmissão de áudio",
        ],
        c: 0,
        e: "Codec (COder/DECoder) comprime voz digitalizada. G.711: sem compressão, 64 kbps, melhor qualidade, mais banda. G.729: 8 kbps, boa qualidade, economiza banda. A escolha depende da banda disponível.",
        x: "G.711: 64 kbps, MOS ~4.4. G.729: 8 kbps, MOS ~3.9. G.722: HD voice, 64 kbps. Opus: moderno, adaptativo (6-510 kbps), WebRTC. MOS: Mean Opinion Score (1-5).",
      },
      {
        q: "O que é um PBX IP e como difere de um PBX tradicional?",
        o: [
          "PBX IP usa rede de dados (VoIP); PBX tradicional usa linhas telefônicas analógicas/digitais",
          "São a mesma coisa",
          "PBX IP é apenas para chamadas externas",
          "PBX tradicional é mais barato que IP",
        ],
        c: 0,
        e: "PBX (Private Branch Exchange) é a central telefônica privada. PBX IP usa rede de dados (Ethernet/Wi-Fi) e protocolo SIP. PBX tradicional usa fiação dedicada e troncos analógicos/ISDN. PBX IP é mais flexível, escalável e barato de manter.",
        x: "PBX IP: Asterisk (open-source), 3CX, Cisco CUCM. Cloud PBX: hospedado na nuvem (RingCentral, Vonage). PBX híbrido: suporta ramais analógicos e IP. Vantagens IP: URA, gravação, integração CRM.",
      },
      {
        q: "O que é NAT traversal em VoIP e por que é um desafio?",
        o: [
          "Técnica para VoIP funcionar através de NAT; necessária porque SIP embute IPs privados no payload",
          "Criptografia de chamadas VoIP",
          "Backup de configurações de PBX",
          "Protocolo de qualidade de serviço",
        ],
        c: 0,
        e: "SIP inclui endereços IP nos headers e SDP (corpo da mensagem). Atrás de NAT, esses IPs são privados e inacessíveis externamente. Soluções: STUN (descobre IP público), TURN (relay), ICE (combina STUN+TURN), SBC.",
        x: "STUN: cliente descobre seu IP público perguntando a servidor externo. TURN: relay quando STUN falha (NAT simétrico). ICE: framework que testa vários caminhos (host, srflx, relay). WebRTC usa ICE nativamente.",
      },
      {
        q: "O que é uma URA (Unidade de Resposta Audível) em sistemas VoIP?",
        o: [
          "Sistema automatizado que atende ligações e direciona o chamador por menus de voz",
          "Codec de áudio de alta qualidade",
          "Protocolo de criptografia de chamadas",
          "Hardware de amplificação de sinal",
        ],
        c: 0,
        e: "URA (IVR — Interactive Voice Response) é o sistema que atende automaticamente: 'Tecle 1 para vendas, 2 para suporte'. Pode integrar com bancos de dados, TTS (text-to-speech) e ASR (speech recognition). Reduz custo com atendentes.",
        x: "URA simples: menu por DTMF (teclas). URA avançada: reconhecimento de voz, NLU, chatbot por voz. Plataformas: Asterisk (open-source), Genesys, Five9. Tendência: voicebot com IA (Dialogflow, Amazon Connect).",
      },
      {
        q: "O que é SRTP e por que é importante em VoIP?",
        o: [
          "Versão segura do RTP que criptografa o áudio, protegendo contra interceptação de chamadas",
          "Protocolo de sinalização criptografada",
          "Codec de alta qualidade com baixa latência",
          "Método de compressão de áudio",
        ],
        c: 0,
        e: "SRTP (Secure RTP, RFC 3711) criptografa e autentica o fluxo de mídia (voz/vídeo). Sem SRTP, qualquer sniffer na rede pode gravar chamadas VoIP. SRTP usa AES para criptografia e HMAC-SHA1 para integridade.",
        x: "RTP: mídia em texto claro (vulnerável). SRTP: mídia criptografada. Troca de chaves: SDES (simples, via SDP), DTLS-SRTP (WebRTC, mais seguro), ZRTP (DH no mídia path). SRTP + SRTP = chamada end-to-end encriptada.",
      },
    ],
    Difícil: [
      {
        q: "Em VoIP, o que é jitter e como ele afeta a qualidade da chamada?",
        o: [
          "Variação no tempo de chegada dos pacotes, causando áudio entrecortado",
          "Perda total de pacotes de áudio",
          "Atraso fixo na transmissão",
          "Eco na ligação",
        ],
        c: 0,
        e: "Jitter é a variação (inconsistência) no atraso entre pacotes. Se pacotes chegam com intervalos irregulares, o áudio fica entrecortado, robotizado ou com gaps. Buffer de jitter (jitter buffer) armazena pacotes temporariamente para regularizar a entrega, mas aumenta a latência.",
        x: "Jitter ideal: < 30ms. Latência ideal: < 150ms. Perda de pacotes ideal: < 1%. QoS (DSCP EF — Expedited Forwarding) prioriza tráfego VoIP. Jitter buffer (fixo ou adaptativo) compensa variações.",
      },
      {
        q: "O que é QoS para VoIP e quais métricas devem ser priorizadas?",
        o: [
          "Priorização de tráfego de voz; latência < 150ms, jitter < 30ms, perda < 1%",
          "Apenas aumentar a largura de banda resolve",
          "QoS não tem efeito em VoIP",
          "Somente a latência importa para VoIP",
        ],
        c: 0,
        e: "QoS prioriza pacotes VoIP (RTP) sobre tráfego menos crítico. Métricas ideais: latência < 150ms, jitter < 30ms, perda < 1%. DSCP EF (valor 46) marca pacotes VoIP para tratamento prioritário em switches e roteadores.",
        x: "Sem QoS: download congestiona link → VoIP pica. Com QoS: fila prioritária (LLQ). Configuração Cisco: policy-map com class VoIP → priority. DSCP EF = encaminhamento acelerado.",
      },
      {
        q: "O que é um SBC (Session Border Controller) em redes VoIP?",
        o: [
          "Dispositivo na borda que controla sessões, fazendo segurança, NAT traversal e transcodificação",
          "Servidor que armazena mensagens de voz",
          "Switch especializado para áudio",
          "Codec de alta qualidade para chamadas",
        ],
        c: 0,
        e: "SBC fica na borda da rede VoIP, controlando sessões SIP/RTP. Funções: segurança (proteção contra ataques SIP), NAT traversal, transcodificação entre codecs, interoperabilidade entre redes e controle de admissão.",
        x: "SBC faz B2BUA (Back-to-Back User Agent): termina e re-origina sessões SIP. Funções: topology hiding, media anchoring, call admission control. Exemplos: Audiocodes, Oracle SBC, Ribbon.",
      },
      {
        q: "O que é WebRTC e como se relaciona com VoIP?",
        o: [
          "API que permite comunicação de voz/vídeo diretamente no navegador sem plugins",
          "Protocolo de roteamento para VoIP",
          "Codec de áudio de alta qualidade",
          "Software de PBX baseado em nuvem",
        ],
        c: 0,
        e: "WebRTC (Web Real-Time Communication) é um padrão aberto que permite áudio, vídeo e dados P2P diretamente no navegador, sem plugins. Usa SRTP (mídia criptografada), ICE/STUN/TURN (NAT traversal) e codec Opus/VP8/VP9.",
        x: "WebRTC: JavaScript API (getUserMedia, RTCPeerConnection). Sinalização: não define (pode usar WebSocket, SIP, XMPP). Mídia: SRTP obrigatório. Navegadores: Chrome, Firefox, Safari, Edge. Usado: Google Meet, Discord.",
      },
      {
        q: "O que é transcodificação em VoIP e quando é necessária?",
        o: [
          "Conversão entre codecs diferentes durante a chamada; necessária quando endpoints usam codecs incompatíveis",
          "Criptografia do áudio da chamada",
          "Compressão de sinalização SIP",
          "Conversão de voz em texto",
        ],
        c: 0,
        e: "Transcodificação: converter áudio de um codec para outro em tempo real (ex: G.711 ↔ G.729). Necessária quando dois endpoints não suportam o mesmo codec. Feita pelo PBX ou SBC. Consome CPU e pode degradar qualidade.",
        x: "Exemplo: Telefone IP (G.711) ↔ PBX (transcodifica) ↔ Celular SIP (G.729). Sem transcodificação: ambos usam mesmo codec (ideal). DSP (Digital Signal Processor): hardware dedicado para transcodificação em escala.",
      },
      {
        q: "O que é toll fraud em VoIP e como preveni-lo?",
        o: [
          "Uso não autorizado do sistema VoIP para fazer chamadas de longa distância; prevenção com senhas fortes e ACLs",
          "Interceptação de chamadas criptografadas",
          "Perda de pacotes durante a chamada",
          "Problema de eco em ligações",
        ],
        c: 0,
        e: "Toll fraud: atacante compromete PBX/SIP e faz chamadas internacionais caras (prejuízos de milhares a milhões). Vetores: senhas SIP fracas, ramais desprotegidos, troncos sem ACL. Detecção: monitoramento de CDRs e limites de gasto.",
        x: "Prevenção: senhas SIP fortes, fail2ban (bloqueia IPs), ACLs por IP/sub-rede, limitar destinos internacionais, alertas de gasto anormal. Asterisk: security events + fail2ban. PBX na nuvem: provedor gerencia segurança.",
      },
      {
        q: "Quais são os principais ataques contra infraestrutura SIP?",
        o: [
          "Registration hijacking, INVITE flooding e SIP scanning; mitigados com SBC, TLS e fail2ban",
          "Apenas ataques DDoS genéricos",
          "Somente interceptação de áudio",
          "Ataques exclusivamente físicos ao hardware",
        ],
        c: 0,
        e: "Registration hijacking: atacante registra-se com URI da vítima. INVITE flooding: DoS com milhares de INVITEs. SIP scanning: varredura de ramais válidos (SIPVicious). Eavesdropping: interceptação de RTP sem SRTP.",
        x: "Defesas: SBC (filtra, rate limit, topology hiding), SIP sobre TLS (SIPS, porta 5061), SRTP para mídia, fail2ban, ACLs, autenticação digest. SIPVicious: ferramenta de scanning/cracking SIP. Honey-SIP: honeypot para SIP.",
      },
    ],
  },
};
