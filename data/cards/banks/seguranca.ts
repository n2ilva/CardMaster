import type { SeedCard } from "../generator";

type UserLevel = "Fácil" | "Médio" | "Difícil";

// ─── Segurança da Informação · 12 categorias × 3 níveis × 7 questões (rodada 4/30) ───

const segurancaBankBase: Record<string, Record<UserLevel, SeedCard[]>> = {
  // ── Certificados Digitais e PKI ──
  "Certificados Digitais e PKI": {
    Fácil: [
      {
        q: "Qual é a função principal de um certificado digital?",
        o: [
          "Vincular uma identidade a uma chave pública de forma confiável",
          "Criptografar arquivos no disco",
          "Bloquear vírus",
          "Criar senhas fortes",
        ],
        c: 0,
        e: "O certificado digital é um documento eletrônico assinado por uma Autoridade Certificadora (CA) que vincula a identidade de uma pessoa/organização a uma chave pública. Permite verificar a autenticidade e estabelecer comunicações seguras (ex: HTTPS).",
        x: "Analogia: como um RG digital. A CA (cartório) atesta que a chave pública pertence realmente àquela pessoa/site. Formato padrão: X.509. Exemplo: cadeado verde no navegador = certificado SSL/TLS válido.",
      },
      {
        q: "O que é HTTPS e qual a relação com certificados digitais?",
        o: [
          "HTTP com criptografia TLS usando certificado digital para autenticar o servidor",
          "Versão mais rápida do HTTP",
          "Protocolo exclusivo para e-commerce",
          "HTTP com compressão de dados",
        ],
        c: 0,
        e: "HTTPS = HTTP + TLS/SSL. O certificado digital autentica o site e possibilita criptografia. O navegador verifica: CA confiável, não expirado, domínio correspondente. Cadeado = conexão segura.",
        x: "HTTP: texto claro (porta 80). HTTPS: criptografado com TLS (porta 443). Let's Encrypt: CA gratuita que democratizou HTTPS. Sem certificado válido: navegador exibe 'Conexão não é particular'.",
      },
      {
        q: "O que é uma Autoridade Certificadora (CA)?",
        o: [
          "Entidade confiável que emite e assina certificados digitais",
          "Software antivírus para websites",
          "Tipo de firewall para servidores",
          "Protocolo de criptografia",
        ],
        c: 0,
        e: "A CA verifica a identidade do solicitante e emite certificados assinados com sua chave privada. Navegadores confiam em CAs pré-instaladas (trust store). Exemplos: DigiCert, Let's Encrypt, GlobalSign.",
        x: "Processo: gera par de chaves → envia CSR (Certificate Signing Request) → CA verifica identidade → emite certificado. Tipos: DV (domínio), OV (organização), EV (validação estendida).",
      },
      {
        q: "O que acontece quando você acessa um site com certificado digital expirado?",
        o: [
          "O navegador exibe um aviso de segurança 'Conexão não é particular'",
          "O site carrega normalmente sem diferença",
          "O certificado é renovado automaticamente",
          "O firewall bloqueia o acesso",
        ],
        c: 0,
        e: "Certificado expirado significa que a CA não garante mais a identidade do site. O navegador mostra alerta de segurança e impede o acesso direto (usuário pode forçar, por sua conta e risco). A criptografia ainda funciona, mas a confiança na identidade está comprometida.",
        x: "Chrome: ERR_CERT_DATE_INVALID. Causa: admins esqueceram de renovar. Let's Encrypt: validade 90 dias (auto-renovação com certbot). DigiCert/Comodo: 1-2 anos. Monitorar expiração: ferramentas como Nagios, UptimeRobot.",
      },
      {
        q: "O que é a cadeia de confiança (chain of trust) em certificados digitais?",
        o: [
          "Hierarquia onde a CA Raiz assina a Intermediária, que assina o certificado do site",
          "Sequência de firewalls que protegem o certificado",
          "Lista de todos os sites que usam HTTPS",
          "Backup de certificados em múltiplos servidores",
        ],
        c: 0,
        e: "A cadeia de confiança vai do certificado do site até a CA Raiz (pre-instalada no navegador): Certificado do site → assinado pela CA Intermediária → assinada pela CA Raiz. Se qualquer elo é inválido, a conexão é rejeitada.",
        x: "Verificação: navegador recebe cert do site + intermediário. Busca CA Raiz no trust store local. Se confere: cadeado verde. Se falta intermediário: erro de chain incompleta. Comando: `openssl s_client -showcerts`.",
      },
      {
        q: "O que é uma assinatura digital?",
        o: [
          "Técnica que usa criptografia assimétrica para garantir autenticidade e integridade de um documento",
          "Imagem digitalizada de uma assinatura manuscrita",
          "Senha especial para documentos eletrônicos",
          "Software de edição de PDFs",
        ],
        c: 0,
        e: "Assinatura digital: o remetente calcula o hash do documento e cifra com sua chave privada. O destinatário decifra com a chave pública do remetente e compara o hash. Se confere: documento autêntico e íntegro.",
        x: "Processo: Hash(documento) → cifra com chave privada → assinatura. Verificação: decifra com chave pública → compara hash. Garante: autenticidade (quem assinou), integridade (não alterado), não-repúdio (não pode negar).",
      },
      {
        q: "O que é o protocolo TLS e onde é usado?",
        o: [
          "Protocolo que criptografa a comunicação entre cliente e servidor, usado em HTTPS, email e VPN",
          "Software de backup de dados",
          "Protocolo de roteamento seguro",
          "Firewall para aplicações web",
        ],
        c: 0,
        e: "TLS (Transport Layer Security) é o protocolo que fornece criptografia, integridade e autenticação entre aplicações. Substitui o SSL (inseguro). Versão atual: TLS 1.3 (mais rápido e seguro). Usado em HTTPS, SMTPS, IMAPS, VPNs.",
        x: "TLS handshake: ClientHello → ServerHello + certificado → troca de chaves (ECDHE) → chave simétrica → comunicação cifrada. TLS 1.3: 1-RTT handshake (vs 2-RTT no 1.2). 0-RTT resumption possível.",
      },
    ],
    Médio: [
      {
        q: "No modelo PKI (Public Key Infrastructure), qual é o papel da AC Raiz (Root CA)?",
        o: [
          "É a entidade de confiança máxima que assina certificados das ACs intermediárias",
          "É o servidor que armazena todas as senhas",
          "É o firewall principal da organização",
          "É o backup dos certificados expirados",
        ],
        c: 0,
        e: "A AC Raiz é o topo da cadeia de confiança. Ela auto-assina seu próprio certificado e assina certificados das ACs Intermediárias, que por sua vez assinam certificados de entidades finais. A AC Raiz geralmente fica offline para proteção máxima.",
        x: "Cadeia: AC Raiz → AC Intermediária → Certificado do site. Navegadores têm AC Raiz pré-instaladas (trust store). Se a AC Raiz for comprometida, toda a cadeia perde confiança. Ex no Brasil: ICP-Brasil → AC Raiz + ACs como Serasa, Certisign.",
      },
      {
        q: "O que é uma CRL (Certificate Revocation List) e para que serve?",
        o: [
          "Lista da CA contendo certificados revogados antes da expiração",
          "Lista de CAs confiáveis no navegador",
          "Log de todos os certificados emitidos",
          "Backup de chaves privadas",
        ],
        c: 0,
        e: "Quando um certificado é comprometido, a CA o revoga e publica na CRL. O cliente pode verificar se o certificado está revogado. Problema: CRLs podem ser grandes e a verificação adiciona latência.",
        x: "Motivos de revogação: chave privada comprometida, mudança de dados. CRL: lista completa. OCSP: consulta individual (mais eficiente). OCSP Stapling: servidor web busca e anexa resposta OCSP.",
      },
      {
        q: "Qual a diferença entre certificados DV, OV e EV?",
        o: [
          "DV valida só domínio; OV valida organização; EV faz validação estendida rigorosa",
          "São versões diferentes do mesmo certificado",
          "Apenas EV fornece criptografia",
          "DV é gratuito, OV e EV são pagos e mais seguros na criptografia",
        ],
        c: 0,
        e: "DV (Domain Validation): prova controle do domínio (automático, minutos). OV (Organization): verifica identidade da organização (dias). EV (Extended): verificação rigorosa (semanas). Todos criptografam igualmente — a diferença é no nível de confiança na identidade.",
        x: "DV: Let's Encrypt, gratuito. OV: exibe nome da empresa. EV: validação completa (menos visualmente distinto nos browsers modernos). Todos usam o mesmo TLS.",
      },
      {
        q: "O que é um CSR (Certificate Signing Request)?",
        o: [
          "Requisição enviada à CA contendo chave pública e dados de identidade para emissão do certificado",
          "Resposta da CA com o certificado pronto",
          "Lista de certificados revogados",
          "Chave privada do servidor",
        ],
        c: 0,
        e: "CSR é gerado no servidor e contém: chave pública, nome do domínio (CN), organização, localização. A CA recebe o CSR, valida a identidade e emite o certificado assinado. A chave privada NUNCA sai do servidor.",
        x: "Geração: `openssl req -new -key server.key -out server.csr`. CSR contém: Subject (CN, O, C), chave pública, algoritmo. CA assina com sua chave privada → certificado X.509 emitido.",
      },
      {
        q: "O que é OCSP (Online Certificate Status Protocol)?",
        o: [
          "Protocolo que verifica em tempo real se um certificado específico foi revogado",
          "Método de criptografia de certificados",
          "Protocolo de emissão automática de certificados",
          "Lista completa de todos os certificados válidos",
        ],
        c: 0,
        e: "OCSP permite ao cliente perguntar diretamente à CA: 'este certificado ainda é válido?' A resposta é individual (good, revoked, unknown), ao contrário da CRL que é uma lista completa. Mais eficiente, mas permite que a CA rastreie acessos.",
        x: "CRL: baixa lista inteira (pesada). OCSP: consulta individual (leve, mas privacidade). OCSP Stapling: servidor busca resposta OCSP e annexa ao TLS handshake → resolvie privacidade + performance.",
      },
      {
        q: "O que é o formato X.509 em certificados digitais?",
        o: [
          "Padrão que define a estrutura do certificado, incluindo sujeito, chave pública, CA e validade",
          "Algoritmo de criptografia simétrica",
          "Formato de arquivo exclusivo para chaves privadas",
          "Protocolo de transferência de certificados",
        ],
        c: 0,
        e: "X.509 é o padrão ITU-T/ISO para certificados digitais. Define campos como: versão, número serial, algoritmo de assinatura, emissor (CA), validade, sujeito, chave pública e extensões (SAN, Key Usage).",
        x: "Formatos de arquivo: PEM (Base64, .pem/.crt), DER (binário, .der), PKCS#12 (.p12/.pfx, inclui chave privada). Comando: `openssl x509 -in cert.pem -text -noout`. Versão atual: X.509v3.",
      },
      {
        q: "O que é Let's Encrypt e por que revolucionou o uso de HTTPS?",
        o: [
          "CA gratuita e automatizada que emite certificados DV, democratizando o acesso a HTTPS",
          "Navegador web com criptografia integrada",
          "Firewall gratuito para servidores web",
          "Software de VPN de código aberto",
        ],
        c: 0,
        e: "Let's Encrypt é uma Autoridade Certificadora gratuita, automatizada e aberta. Emite certificados DV com validade de 90 dias, renováveis automaticamente via protocolo ACME (certbot). Responsável por criptografar grande parte da web.",
        x: "Antes: certificados custavam $$/ano, instalação manual. Let's Encrypt (2015): gratuito + ACME (automático). Certbot: cliente oficial. Suporta wildcard (*.exemplo.com) via DNS-01 challenge. +300 milhões de sites protegidos.",
      },
    ],
    Difícil: [
      {
        q: "O que é OCSP Stapling e qual problema ele resolve em relação à verificação de revogação de certificados?",
        o: [
          "O servidor web consulta o OCSP e anexa a resposta ao handshake TLS, eliminando consulta do cliente ao CA",
          "O cliente armazena todos os CRLs localmente",
          "É uma forma de criptografia pós-quântica",
          "Substitui completamente os certificados X.509",
        ],
        c: 0,
        e: "Sem stapling: o navegador precisa consultar o servidor OCSP da CA para verificar se o certificado foi revogado, causando latência e problemas de privacidade (a CA sabe quais sites você visita). Com OCSP Stapling: o servidor web consulta periodicamente o OCSP e inclui a resposta assinada no TLS handshake. O cliente valida a resposta sem contatar a CA.",
        x: "CRL: lista completa de revogados (grande, lenta). OCSP: consulta individual (latência + privacidade). OCSP Stapling: melhor dos dois — resposta OCSP cacheada e servida pelo servidor web, assinada pela CA, com timestamp (válida por horas).",
      },
      {
        q: "O que é Certificate Transparency (CT) e como protege contra certificados fraudulentos?",
        o: [
          "Logs públicos onde CAs registram todos os certificados emitidos, permitindo auditoria",
          "Técnica para tornar certificados invisíveis",
          "Método para revogar certificados automaticamente",
          "Versão transparente do certificado sem dados privados",
        ],
        c: 0,
        e: "Certificate Transparency exige que CAs publiquem cada certificado em logs públicos (append-only). Navegadores como Chrome exigem SCTs. Proprietários de domínios podem monitorar logs para detectar certificados emitidos indevidamente.",
        x: "Sem CT: CA comprometida emite cert falso e ninguém percebe. Com CT: cert aparece no log → detectado → revogado. Sites como crt.sh permitem buscar certificados por domínio.",
      },
      {
        q: "O que é um HSM (Hardware Security Module) e qual seu papel em PKI?",
        o: [
          "Dispositivo físico dedicado a gerar, armazenar e proteger chaves criptográficas",
          "Software para gerenciar certificados",
          "Servidor de backup de chaves",
          "Protocolo de comunicação segura",
        ],
        c: 0,
        e: "HSM é um dispositivo tamper-resistant que gera e armazena chaves criptográficas. As chaves nunca deixam o HSM — operações criptográficas são executadas dentro do dispositivo. Essencial para proteger a chave privada da AC Raiz.",
        x: "HSM: chave nunca exportada, auto-destrói se adulterado. FIPS 140-2 Level 3/4. Cloud HSM: AWS CloudHSM, Azure Dedicated HSM. Uso: PKI, pagamentos, assinaturas digitais.",
      },
      {
        q: "O que é certificate pinning e por que é usado?",
        o: [
          "Técnica que associa um certificado específico a um domínio/app, prevenindo MitM com CAs comprometidas",
          "Método de fixar a data de expiração do certificado",
          "Backup de certificados em hardware",
          "Protocolo para compartilhar certificados entre servidores",
        ],
        c: 0,
        e: "Certificate pinning: o app/navegador aceita APENAS o certificado específico (ou CA específica) para aquele domínio, ignorando outras CAs do trust store. Protege contra CAs comprometidas ou ataques MitM corporativos. Comum em apps bancários.",
        x: "HPKP (HTTP Public Key Pinning): deprecado em navegadores (risco de DoS se pin errado). Apps móveis: ainda comum (Alamofire/iOS, OkHttp/Android). Desafio: atualizar pin quando certificado renova.",
      },
      {
        q: "Qual a diferença entre certificados wildcard e SAN (Subject Alternative Name)?",
        o: [
          "Wildcard cobre todos os subdomínios de um nível; SAN lista múltiplos domínios diferentes em um certificado",
          "São a mesma coisa com nomes diferentes",
          "Wildcard é gratuito e SAN é pago",
          "SAN só funciona com EV e wildcard com DV",
        ],
        c: 0,
        e: "Wildcard (*.exemplo.com): cobre qualquer subdomínio de primeiro nível (www, mail, api). Não cobre sub-subdomínios (dev.api.exemplo.com). SAN: um certificado lista vários domínios distintos (exemplo.com, empresa.net, loja.org) no campo Subject Alternative Name.",
        x: "Wildcard: *.exemplo.com cobre www.exemplo.com, api.exemplo.com. SAN: cert único para exemplo.com + exemplo.net + outrodominio.com. Combinação: wildcard + SAN no mesmo cert. Let's Encrypt suporta ambos.",
      },
      {
        q: "O que é mTLS (mutual TLS) e quando é usado?",
        o: [
          "Autenticação onde ambos os lados apresentam certificados; comum em APIs e microsserviços",
          "TLS com criptografia dupla",
          "Versão mais rápida do TLS",
          "TLS exclusivo para redes internas",
        ],
        c: 0,
        e: "No TLS normal, só o servidor apresenta certificado. No mTLS (mutual TLS), o cliente TAMBÉM apresenta certificado para o servidor. Garante autenticação bidirecional. Usado em comunicação entre microsserviços, APIs B2B e Zero Trust.",
        x: "mTLS: Client → cert + Server → cert. Service mesh (Istio, Linkerd): mTLS automático entre pods. APIs bancárias (Open Banking): mTLS obrigatório. Desafio: gerenciar certificados de todos os clientes.",
      },
      {
        q: "O que é o protocolo ACME usado pelo Let's Encrypt?",
        o: [
          "Protocolo que automatiza emissão e renovação de certificados via desafios de validação",
          "Algoritmo de criptografia pós-quântica",
          "Protocolo de backup de certificados",
          "Método de revogação automática",
        ],
        c: 0,
        e: "ACME (Automated Certificate Management Environment, RFC 8555) automatiza o ciclo de vida de certificados: solicitação, validação de domínio, emissão e renovação. Desafios: HTTP-01 (arquivo no webserver), DNS-01 (registro TXT no DNS).",
        x: "Fluxo ACME: cliente (certbot) → cria conta → solicita cert → CA envia desafio → cliente prova controle do domínio → CA emite cert. DNS-01: necessário para wildcard. HTTP-01: mais simples, arquivo em /.well-known/acme-challenge/.",
      },
    ],
  },

  // ── Cibersegurança ──
  Cibersegurança: {
    Fácil: [
      {
        q: "O que significa a tríade CIA na segurança da informação?",
        o: [
          "Confidencialidade, Integridade e Disponibilidade",
          "Criptografia, Internet e Autenticação",
          "Controle, Identidade e Acesso",
          "Certificação, Infraestrutura e Aplicação",
        ],
        c: 0,
        e: "CIA: Confidentiality (apenas pessoas autorizadas acessam a informação), Integrity (informação não é alterada indevidamente), Availability (informação está disponível quando necessária). São os três pilares fundamentais da segurança da informação.",
        x: "Confidencialidade → criptografia, controle de acesso. Integridade → hashes, assinaturas digitais. Disponibilidade → redundância, backups, DDoS protection. Toda política de segurança gira em torno da CIA.",
      },
      {
        q: "O que é autenticação de dois fatores (2FA)?",
        o: [
          "Uso de dois tipos de verificação para confirmar identidade (ex: senha + código SMS)",
          "Duas senhas diferentes para a mesma conta",
          "Login em dois dispositivos ao mesmo tempo",
          "Backup de senha em dois locais",
        ],
        c: 0,
        e: "2FA combina dois fatores diferentes: algo que você sabe (senha), algo que tem (celular, token) ou algo que é (biometria). Mesmo com senha vazada, o atacante precisa do segundo fator.",
        x: "Fatores: 1) Conhecimento (senha, PIN). 2) Posse (celular, token). 3) Inerência (digital, face). SMS é vulnerável a SIM swap. TOTP (Google Authenticator) ou FIDO2/WebAuthn são mais seguros.",
      },
      {
        q: "O que é um firewall e qual sua importância na segurança?",
        o: [
          "Sistema que filtra tráfego de rede com base em regras de segurança",
          "Programa que remove vírus do computador",
          "Hardware que aumenta a velocidade da internet",
          "Software de backup de dados",
        ],
        c: 0,
        e: "O firewall é a primeira linha de defesa entre redes. Filtra tráfego por IP, porta, protocolo e estado de conexão. Pode ser hardware (appliance), software (iptables) ou cloud (WAF).",
        x: "Tipos: packet filter, stateful inspection, WAF, NGFW (inspeção profunda + IPS + controle de apps). Regra básica: deny all por padrão, liberar apenas o necessário.",
      },
      {
        q: "O que é backup e por que é essencial para a segurança da informação?",
        o: [
          "Cópia de segurança dos dados para recuperação em caso de perda, corrupção ou ataque",
          "Software que remove vírus do sistema",
          "Técnica de criptografia de arquivos",
          "Firewall que bloqueia acessos suspeitos",
        ],
        c: 0,
        e: "Backup protege o pilar da Disponibilidade: garante recuperação após ransomware, falha de hardware, desastre ou erro humano. Regra 3-2-1: 3 cópias, em 2 mídias diferentes, 1 offsite (fora do local).",
        x: "Tipos: completo (tudo), incremental (só alterações desde último backup), diferencial (desde último completo). RPO (Recovery Point Objective): tolerância a perda de dados. RTO (Recovery Time Objective): tempo aceitável de restauração.",
      },
      {
        q: "O que significa 'vulnerabilidade' em segurança da informação?",
        o: [
          "Fraqueza em um sistema que pode ser explorada por uma ameaça",
          "Vírus que infecta o sistema",
          "Ataque de força bruta",
          "Tipo de firewall desatualizado",
        ],
        c: 0,
        e: "Vulnerabilidade é uma falha ou fraqueza (técnica, humana ou processual) que pode ser explorada. Ameaça é o agente que pode explorar. Risco = Ameaça × Vulnerabilidade × Impacto. Exemplos: software desatualizado, senha fraca, falta de criptografia.",
        x: "Vulnerabilidade: porta aberta. Ameaça: hacker. Risco: invasão. CVE (Common Vulnerabilities and Exposures): catálogo público de vulnerabilidades. CVSS: pontuação de severidade (0-10).",
      },
      {
        q: "O que é engenharia social em cibersegurança?",
        o: [
          "Técnica de manipulação psicológica para obter informações ou acesso não autorizado",
          "Software de proteção contra vírus",
          "Antivirus de última geração",
          "Ferramenta de análise de rede",
        ],
        c: 0,
        e: "Engenharia social explora o fator humano: convence pessoas a revelar informações, clicar em links maliciosos ou realizar ações inseguras. Inclui phishing, pretexting (história inventada), baiting (isca), tailgating (seguir alguém por porta).",
        x: "Phishing: email falso. Pretexting: 'sou do TI, preciso da sua senha'. Baiting: pen drive infectado no estacionamento. Tailgating: seguir funcionário pela porta. Defesa: treinamento de security awareness.",
      },
      {
        q: "O que é um antivírus e como ele protege o computador?",
        o: [
          "Software que detecta e remove malware usando assinaturas, heurística e análise comportamental",
          "Hardware que bloqueia tráfego malicioso",
          "Protocolo de criptografia de dados",
          "Firewall para redes domésticas",
        ],
        c: 0,
        e: "Antivírus usa múltiplas técnicas: assinaturas (padrões conhecidos de malware), heurística (comportamento suspeito) e sandboxing (execução isolada). Moderno: EDR (Endpoint Detection and Response) com IA e resposta automatizada.",
        x: "Assinatura: eficaz contra known threats. Heurística: detecta variações. Sandbox: executa em ambiente isolado. EDR: CrowdStrike, SentinelOne, Microsoft Defender for Endpoint. EPP + EDR = proteção completa.",
      },
    ],
    Médio: [
      {
        q: "O que caracteriza um ataque de ransomware?",
        o: [
          "Malware que criptografa dados da vítima e exige pagamento para desbloqueá-los",
          "Vírus que apaga todos os arquivos permanentemente",
          "Ataque que rouba largura de banda",
          "Software que monitora teclas digitadas",
        ],
        c: 0,
        e: "Ransomware criptografa arquivos da vítima usando criptografia forte e exige um resgate (geralmente em criptomoedas) para fornecer a chave de descriptografia. Exemplos famosos: WannaCry (2017), NotPetya, REvil. Defesas: backups offline, patching, treinamento de usuários.",
        x: "Cadeia: email phishing → download de malware → escalação de privilégio → criptografia de dados → nota de resgate. Prevenção: backups 3-2-1, segmentação de rede, EDR, patches em dia. Nunca garanta pagamento = dados de volta.",
      },
      {
        q: "O que é um ataque de phishing e como se proteger?",
        o: [
          "Email/site falso que imita entidade confiável para roubar dados; proteção: verificar URLs, 2FA",
          "Ataque que sobrecarrega servidores",
          "Vírus que criptografa dados",
          "Software que monitora teclado",
        ],
        c: 0,
        e: "Phishing usa engenharia social via email, SMS ou sites falsos para obter credenciais. Proteções: verificar URLs, usar 2FA, treinamento, filtros anti-phishing no email.",
        x: "Sinais: URL levemente diferente (g00gle.com), urgência forçada, erros de gramática. Variantes: spear phishing (alvo específico), whaling (executivos), vishing (telefone), smishing (SMS).",
      },
      {
        q: "O que é um SIEM (Security Information and Event Management)?",
        o: [
          "Sistema que coleta, correlaciona e analisa logs de segurança em tempo real",
          "Tipo de firewall para aplicações web",
          "Antivírus para servidores corporativos",
          "Protocolo de criptografia de emails",
        ],
        c: 0,
        e: "SIEM centraliza logs de firewalls, servidores, IDS/IPS e endpoints, aplica regras de correlação para detectar ameaças, gera alertas e permite análise forense. Exemplos: Splunk, IBM QRadar, Microsoft Sentinel.",
        x: "Regra exemplo: 'login falho 5x em 1min do mesmo IP' → alerta de brute force. SOAR (Security Orchestration, Automation and Response) automatiza as respostas aos alertas do SIEM.",
      },
      {
        q: "O que é um SOC (Security Operations Center)?",
        o: [
          "Centro que monitora, detecta e responde a incidentes de segurança 24/7",
          "Software de criptografia de dados",
          "Tipo de firewall de última geração",
          "Sala onde ficam os servidores",
        ],
        c: 0,
        e: "O SOC é uma equipe dedicada que opera 24/7, monitora alertas do SIEM, analisa incidentes, coordena respostas e melhora continuamente as defesas. Níveis: L1 (triagem), L2 (análise), L3 (threat hunting/forense).",
        x: "Ferramentas SOC: SIEM (Splunk/Sentinel), EDR (CrowdStrike), SOAR (Cortex XSOAR), TIP (Threat Intelligence Platform). KPIs: MTTD (Mean Time to Detect), MTTR (Mean Time to Respond).",
      },
      {
        q: "O que é um pentest (teste de penetração)?",
        o: [
          "Simulação autorizada de ataque para identificar vulnerabilidades em sistemas",
          "Antivírus que detecta malwares",
          "Backup de segurança criptografado",
          "Firewall que testa conexões",
        ],
        c: 0,
        e: "Pentest: profissional (pentester) simula ataques reais, com autorização, para encontrar vulnerabilidades antes que atacantes o façam. Tipos: black box (sem info), white box (acesso total), gray box (parcial). Resulta em relatório com achados e recomendações.",
        x: "Fases: Reconhecimento → Scanning → Exploração → Pós-exploração → Relatório. Ferramentas: Nmap, Burp Suite, Metasploit, SQLmap. Certificações: OSCP, CEH, PNPT.",
      },
      {
        q: "O que é Zero Trust em segurança da informação?",
        o: [
          "Modelo que não confia em nenhum usuário ou dispositivo por padrão, verificando continuamente",
          "Firewall que bloqueia todo o tráfego",
          "Software de criptografia total",
          "VPN exclusiva para redes internas",
        ],
        c: 0,
        e: "Zero Trust: 'nunca confie, sempre verifique'. Cada acesso é autenticado e autorizado com base em identidade, dispositivo, contexto e políticas — mesmo dentro da rede corporativa. Substitui o modelo de perímetro (confia no interno).",
        x: "Princípios: verificação explícita, menor privilégio, assume comprometimento. Pilares: identidade, dispositivo, rede, aplicação, dados. Soluções: ZTNA (Zscaler, Cloudflare), micro-segmentação, MFA everywhere.",
      },
      {
        q: "O que é EDR (Endpoint Detection and Response)?",
        o: [
          "Ferramenta que monitora endpoints, detecta ameaças avançadas e permite resposta automatizada",
          "Tipo de firewall para servidores",
          "Protocolo de backup de endpoints",
          "Antivírus tradicional com interface gráfica",
        ],
        c: 0,
        e: "EDR vai além do antivírus tradicional: monitora continuamente atividades nos endpoints, detecta comportamentos anômalos (fileless malware, movimentação lateral), permite investigação forense e resposta remota (isolamento de máquina).",
        x: "Antivírus: prevenção baseada em assinatura. EDR: detecção + resposta + forense. XDR: EDR + NDR + SIEM integrados. Ferramentas: CrowdStrike Falcon, SentinelOne, Microsoft Defender for Endpoint, Carbon Black.",
      },
    ],
    Difícil: [
      {
        q: "O que é uma APT (Advanced Persistent Threat) e como ela difere de ataques comuns?",
        o: [
          "Ataque sofisticado, prolongado e direcionado por grupos organizados com objetivos específicos",
          "Qualquer vírus que se espalha rapidamente",
          "Um tipo de firewall avançado",
          "Ataque automatizado sem alvo específico",
        ],
        c: 0,
        e: "APT: atacantes altamente qualificados (geralmente state-sponsored) que infiltram uma rede e permanecem por meses/anos, extraindo dados de forma lenta e silenciosa. Diferente de ataques oportunistas (rápidos, automatizados), APTs são direcionados, persistentes e usam técnicas avançadas (zero-days, supply chain attacks).",
        x: "Fases: Reconhecimento → Weaponization → Delivery → Exploitation → Installation → C2 (Command & Control) → Actions on Objectives. Exemplos: Stuxnet (nuclear iraniano), SolarWinds (supply chain), APT28/Fancy Bear (espionagem).",
      },
      {
        q: "O que é threat hunting e como difere da detecção convencional?",
        o: [
          "Busca proativa de ameaças sem esperar alertas; detecção convencional é reativa",
          "É o mesmo que varredura de antivírus",
          "Resposta a incidentes após invasão detectada",
          "Monitoramento passivo de tráfego",
        ],
        c: 0,
        e: "Threat hunting é busca proativa por ameaças que escaparam das defesas. O hunter formula hipóteses e busca evidências nos dados. Diferente de detecção reativa (SIEM aguardando alertas pré-definidos).",
        x: "Detecção: espera alerta → reage. Hunting: assume comprometimento → busca proativamente. Framework: MITRE ATT&CK (TTPs). Sqrrl Hunting Loop: hypothesize → investigate → discover → inform.",
      },
      {
        q: "O que é o framework MITRE ATT&CK e como é utilizado?",
        o: [
          "Base de conhecimento de táticas, técnicas e procedimentos (TTPs) de atacantes",
          "Software de antivírus corporativo",
          "Norma de certificação como ISO 27001",
          "Protocolo de comunicação entre firewalls",
        ],
        c: 0,
        e: "MITRE ATT&CK cataloga táticas (objetivos do atacante), técnicas (como alcança) e procedimentos (implementações específicas) de adversários reais. Usado para mapear defesas, detectar gaps e avaliar ferramentas de segurança.",
        x: "Táticas: Initial Access, Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access, Lateral Movement, Collection, Exfiltration, C2, Impact. Cada tática tem múltiplas técnicas.",
      },
      {
        q: "O que é Red Team vs Blue Team em cibersegurança?",
        o: [
          "Red Team simula atacantes; Blue Team defende; Purple Team integra ambos",
          "São níveis de certificação de segurança",
          "Tipos de firewall corporativo",
          "Classificação de malwares por cor",
        ],
        c: 0,
        e: "Red Team: equipe ofensiva que simula ataques reais (TTPs de adversários) para testar as defesas. Blue Team: equipe defensiva que monitora, detecta e responde. Purple Team: integra red+blue, garantindo que achados do red melhorem defesas do blue.",
        x: "Red: OSCP, Cobalt Strike, C2 frameworks. Blue: SIEM, EDR, forense, IR. Purple: red ataca, blue defende, ambos discutem gaps em tempo real. White Team: árbitros/management do exercício.",
      },
      {
        q: "O que é um supply chain attack e por que é tão perigoso?",
        o: [
          "Ataque via componente/software de terceiros confiável que atinge múltiplas organizações",
          "Ataque que derruba cadeias de produção físicas",
          "Roubo de mercadorias em trânsito",
          "Vírus que ataca apenas fornecedores",
        ],
        c: 0,
        e: "Supply chain attack compromete um fornecedor/componente que organizações confiam: biblioteca, atualização de software, hardware. O atacante injeta código malicioso na fonte, atingindo todos que usam aquele componente. Exemplo: SolarWinds (2020), CodeCov, Log4Shell.",
        x: "SolarWinds: backdoor na atualização Orion → 18.000 organizações infectadas. Prevenção: SBOM (Software Bill of Materials), assinatura de código, verificação de integridade, supply chain security frameworks.",
      },
      {
        q: "O que é SOAR e como complementa o SIEM?",
        o: [
          "Plataforma que automatiza respostas a incidentes com playbooks, orquestração e integrações",
          "Versão avançada do antivírus",
          "Protocolo de criptografia corporativa",
          "Firewall com inteligência artificial",
        ],
        c: 0,
        e: "SOAR (Security Orchestration, Automation and Response) automatiza a resposta a incidentes. SIEM detecta e alerta; SOAR executa playbooks automatizados (ex: bloquear IP no firewall, isolar endpoint, notificar analista).",
        x: "SIEM: detecta → alerta → analista manual. SOAR: detecta → playbook automático → remediação. Ferramentas: Cortex XSOAR (Palo Alto), Splunk SOAR, IBM Resilient. Reduz MTTR de horas para minutos.",
      },
      {
        q: "Quais são as fases do framework de resposta a incidentes do NIST?",
        o: [
          "Preparação, Detecção e Análise, Contenção/Erradicação/Recuperação, Pós-Incidente",
          "Apenas Detecção e Recuperação",
          "Planejamento, Execução, Monitoramento",
          "Auditoria, Remediação, Documentação",
        ],
        c: 0,
        e: "NIST SP 800-61: 1) Preparação (planos, ferramentas, treinamento). 2) Detecção e Análise (identificar e classificar incidente). 3) Contenção, Erradicação e Recuperação (limitar dano, remover ameaça, restaurar). 4) Atividades Pós-Incidente (lessons learned).",
        x: "Fase 1: IRP (Incident Response Plan), playbooks, contatos. Fase 2: alertas SIEM, triagem, escalonamento. Fase 3: isola máquina, remove malware, restaura backup. Fase 4: post-mortem, IOCs compartilhados, melhoria contínua.",
      },
    ],
  },

  // ── Criptografia ──
  Criptografia: {
    Fácil: [
      {
        q: "Qual a diferença entre criptografia simétrica e assimétrica?",
        o: [
          "Simétrica usa uma chave para cifrar/decifrar; assimétrica usa um par de chaves (pública/privada)",
          "Simétrica é mais segura que assimétrica",
          "Assimétrica usa apenas uma chave",
          "Não há diferença prática",
        ],
        c: 0,
        e: "Simétrica: mesma chave para cifrar e decifrar (AES, DES, 3DES). Rápida, mas o desafio é compartilhar a chave de forma segura. Assimétrica: usa par de chaves — pública (cifra/verifica) e privada (decifra/assina) — RSA, ECC. Mais lenta, mas resolve o problema de distribuição de chaves.",
        x: "Simétrica (AES-256): velocidade, usada para dados em trânsito/repouso. Assimétrica (RSA): troca de chaves, assinatura digital. HTTPS usa ambas: assimétrica no handshake TLS para trocar a chave simétrica de sessão.",
      },
      {
        q: "O que é criptografia e para que serve?",
        o: [
          "Técnica de transformar dados legíveis em ilegíveis para proteger contra acesso não autorizado",
          "Método para comprimir arquivos",
          "Software de backup de dados",
          "Protocolo de transferência de arquivos",
        ],
        c: 0,
        e: "Criptografia transforma plaintext (legível) em ciphertext (ilegível) usando algoritmos e chaves. Só quem possui a chave correta pode decifrar. Protege dados em trânsito (HTTPS) e em repouso (disco criptografado).",
        x: "Exemplo: 'OLÁ' → criptografia com chave → 'X7f#' → decriptação → 'OLÁ'. Histórico: Cifra de César, Enigma. Modernos: AES (simétrico), RSA (assimétrico), ChaCha20.",
      },
      {
        q: "O que é AES e por que é considerado seguro?",
        o: [
          "Algoritmo simétrico com chaves de 128/192/256 bits, padrão mundial atual",
          "Protocolo de rede segura",
          "Tipo de certificado digital",
          "Algoritmo de hash para senhas",
        ],
        c: 0,
        e: "AES (Advanced Encryption Standard) é o padrão mundial de criptografia simétrica, aprovado pelo NIST em 2001. Usa chaves de 128, 192 ou 256 bits. Nenhum ataque prático conhecido contra AES-256. Usado em HTTPS, WPA2/WPA3, BitLocker.",
        x: "DES (56 bits): obsoleto. 3DES (168 bits): lento, em desuso. AES-256: 2²⁵⁶ combinações — impossível força bruta. Modos: CBC, GCM (autenticado), CTR.",
      },
      {
        q: "O que é criptografia de ponta a ponta (end-to-end encryption)?",
        o: [
          "Apenas remetente e destinatário podem ler as mensagens; nem o provedor do serviço acessa",
          "Criptografia apenas no servidor",
          "Criptografia só durante a transmissão",
          "Backup criptografado das mensagens",
        ],
        c: 0,
        e: "Na E2EE (end-to-end encryption), os dados são criptografados no dispositivo do remetente e só decifrados no dispositivo do destinatário. O provedor do serviço (WhatsApp, Signal) não tem acesso ao conteúdo, pois não possui as chaves.",
        x: "WhatsApp: Signal Protocol (E2EE por padrão). Telegram: Secret Chats (E2EE opt-in). Signal: referência em privacidade. Sem E2EE: provedor pode ler mensagens. Desafio: backup — WhatsApp oferece backup E2EE opcional.",
      },
      {
        q: "O que são chave pública e chave privada na criptografia assimétrica?",
        o: [
          "Pública: compartilhada, usada para cifrar/verificar. Privada: secreta, usada para decifrar/assinar",
          "Ambas são idênticas e intercambiáveis",
          "Pública é para assinar e privada para cifrar",
          "São nomes diferentes para a mesma chave",
        ],
        c: 0,
        e: "Par de chaves matematicamente relacionadas: chave pública (distribuída livremente) cifra dados ou verifica assinaturas. Chave privada (mantida em segredo) decifra dados ou gera assinaturas. Quem cifra com a pública só pode decifrar com a privada.",
        x: "Analogia: chave pública = cadeado aberto (qualquer pessoa pode trancar). Chave privada = chave do cadeado (só o dono abre). Geração: `openssl genrsa -out priv.pem 4096` → `openssl rsa -pubout`.",
      },
      {
        q: "O que é RSA e para que é usado?",
        o: [
          "Algoritmo assimétrico baseado na fatoração de números primos, usado para troca de chaves e assinaturas",
          "Algoritmo simétrico para criptografia de disco",
          "Protocolo de rede segura",
          "Função hash de 256 bits",
        ],
        c: 0,
        e: "RSA (Rivest-Shamir-Adleman) é o algoritmo assimétrico mais difundido. Baseado na dificuldade de fatorar o produto de dois primos grandes. Usado em TLS (handshake), assinaturas digitais e certificados. Chaves: 2048 ou 4096 bits.",
        x: "RSA-2048: seguro até ~2030. RSA-4096: mais seguro, mais lento. Alternativa moderna: ECC (mesma segurança com chave menor). RSA é ~100x mais lento que AES → usado só para trocar chave simétrica (modelo híbrido).",
      },
      {
        q: "O que é um hash e para que serve?",
        o: [
          "Função que gera valor fixo a partir de dados para verificar integridade; qualquer alteração muda o hash",
          "Método de criptografia reversível",
          "Protocolo de transferência segura",
          "Tipo de chave de criptografia",
        ],
        c: 0,
        e: "Hash é uma função unidirecional que gera uma 'impressão digital' de tamanho fixo a partir de qualquer dado. Qualquer modificação no dado original produz hash completamente diferente. Usado para verificar integridade de arquivos, senhas e assinaturas.",
        x: "Exemplos: SHA-256 (seguro), MD5/SHA-1 (inseguros, colísões conhecidas). Uso: verificar downloads (checksum), armazenar senhas (com salt), blockchain (hash encadeados). Hash NÃO é criptografia — não é reversível.",
      },
    ],
    Médio: [
      {
        q: "O que é uma função hash e qual propriedade garante que dois arquivos diferentes NÃO gerem o mesmo hash?",
        o: [
          "Resistência a colisões",
          "Confidencialidade",
          "Reversibilidade",
          "Autenticação mútua",
        ],
        c: 0,
        e: "Hash: função que transforma dados de qualquer tamanho em uma saída de tamanho fixo (digest). Propriedades: 1) Determinística (mesma entrada = mesmo hash). 2) Irreversível (não é possível reverter). 3) Resistência a colisões (difícil encontrar duas entradas com mesmo hash). Exemplos: SHA-256, SHA-3.",
        x: "SHA-256('abc') = ba7816bf... (sempre 256 bits). Mudar 1 bit na entrada muda ~50% dos bits do hash (efeito avalanche). MD5 e SHA-1 têm colisões conhecidas e são inseguros. Use SHA-256 ou SHA-3.",
      },
      {
        q: "O que é uma assinatura digital e como funciona?",
        o: [
          "Hash do documento criptografado com chave privada do autor, verificável com a chave pública",
          "Imagem digitalizada de assinatura manuscrita",
          "Senha usada para assinar documentos",
          "Certificado que permite editar documentos",
        ],
        c: 0,
        e: "Assinatura digital: 1) Calcula hash do documento. 2) Hash é criptografado com chave privada. 3) Destinatário decifra com chave pública e compara hashes. Garante autenticidade e integridade.",
        x: "Autor: SHA-256(doc) = hash → RSA_encrypt(hash, privada) = assinatura. Verificação: RSA_decrypt(assinatura, pública) = hash → comparar. ICP-Brasil: validade jurídica.",
      },
      {
        q: "O que é HMAC e qual a diferença de um hash simples?",
        o: [
          "Hash com chave secreta que garante autenticidade além de integridade",
          "São a mesma coisa",
          "HMAC é mais rápido que hash",
          "Hash é mais seguro que HMAC",
        ],
        c: 0,
        e: "HMAC combina função hash com chave secreta. Hash simples garante apenas integridade (qualquer pessoa calcula). HMAC garante integridade E autenticidade (só quem tem a chave pode gerar/verificar).",
        x: "Hash: SHA-256(msg). HMAC: SHA-256(chave + msg). Uso: APIs (JWT HS256), cookies, tokens. Sem a chave, atacante não pode forjar HMAC válido.",
      },
      {
        q: "O que é 'salt' no contexto de hashing de senhas?",
        o: [
          "Valor aleatório adicionado à senha antes do hash para impedir ataques com rainbow tables",
          "Chave de criptografia simétrica",
          "Algoritmo de compressão de hash",
          "Senha temporária gerada automaticamente",
        ],
        c: 0,
        e: "Salt: valor aleatório único concatenado à senha antes do hash. Mesmo duas senhas iguais geram hashes diferentes (salts diferentes). Impede rainbow tables (tabelas pré-computadas de hashes) e ataques de dicionário em lote.",
        x: "Sem salt: hash('123456') = sempre o mesmo → rainbow table encontra. Com salt: hash('abc123' + '123456') = hash único. Salt armazenado junto ao hash (não precisa ser secreto). bcrypt, Argon2 incluem salt automaticamente.",
      },
      {
        q: "O que é criptografia de disco completo (full disk encryption)?",
        o: [
          "Criptografia de todo o disco/partição tornando dados ilegíveis sem autenticação",
          "Backup automático do disco",
          "Compressão de todos os arquivos",
          "Partição secreta no disco",
        ],
        c: 0,
        e: "Full Disk Encryption (FDE) criptografa todo o disco: SO, aplicações e dados. Sem a senha/TPM, o disco é inútil. Protege contra roubo/perda de dispositivos. Exemplos: BitLocker (Windows), FileVault (macOS), LUKS (Linux).",
        x: "BitLocker: AES-128/256, usa TPM para boot seguro. FileVault: XTS-AES-128. LUKS: padrão Linux (+cryptsetup). FDE não protege enquanto o SO está rodando — protege dados em repouso (at rest).",
      },
      {
        q: "O que é o protocolo Diffie-Hellman?",
        o: [
          "Método de troca de chaves que permite gerar chave compartilhada por canal inseguro",
          "Algoritmo de criptografia simétrica",
          "Protocolo de autenticação biométrica",
          "Função hash com chave secreta",
        ],
        c: 0,
        e: "Diffie-Hellman permite que dois participantes gerem uma chave secreta compartilhada mesmo comunicando-se por canal público. Nenhuma das partes transmite a chave diretamente. Vulnerável a MitM sem autenticação.",
        x: "Processo: Alice e Bob escolhem p e g públicos, geram valores privados, trocam valores públicos e computam chave compartilhada. ECDHE (Elliptic Curve DH Ephemeral): versão moderna com PFS, usada no TLS 1.3.",
      },
      {
        q: "O que é criptografia autenticada (AEAD)?",
        o: [
          "Combina criptografia e autenticação de integridade em uma operação; ex: AES-GCM",
          "Criptografia que requer biometria",
          "Método de autenticação sem criptografia",
          "Criptografia exclusiva para certificados",
        ],
        c: 0,
        e: "AEAD (Authenticated Encryption with Associated Data) cifra dados E garante integridade em uma operação. AES-GCM e ChaCha20-Poly1305 são exemplos. Detecta adulteração do ciphertext, prevenindo ataques como padding oracle.",
        x: "Sem AEAD: cifra com AES-CBC + HMAC separado (ordem importa, suscetível a problemas). Com AEAD: AES-GCM faz ambos. TLS 1.3 só aceita AEAD. Associated Data: dados autenticados mas não cifrados (headers).",
      },
    ],
    Difícil: [
      {
        q: "No protocolo TLS 1.3, quantos round trips (RTTs) são necessários para o handshake completo?",
        o: ["1 RTT (ou 0-RTT com resumption)", "3 RTTs", "2 RTTs", "4 RTTs"],
        c: 0,
        e: "TLS 1.3 reduziu o handshake para 1-RTT (vs 2-RTT no TLS 1.2). O cliente envia ClientHello com key shares, o servidor responde com ServerHello + certificado + finish em uma mensagem. Com 0-RTT (early data), conexões resumidas podem enviar dados no primeiro pacote, embora com risco de replay.",
        x: "TLS 1.2: ClientHello → ServerHello → Certificate → KeyExchange → Finished (2 RTT). TLS 1.3: ClientHello(+KeyShare) → ServerHello(+KeyShare+Cert+Finish) → Finished (1 RTT). 0-RTT: dados no primeiro pacote em resumptions.",
      },
      {
        q: "O que é criptografia homomórfica e qual sua aplicação?",
        o: [
          "Permite computar sobre dados criptografados sem decifrar; uso em cloud mantendo privacidade",
          "Criptografia que funciona apenas em computadores quânticos",
          "Método de compressão com criptografia simultânea",
          "Hash que permite reverter o processo",
        ],
        c: 0,
        e: "Criptografia homomórfica permite operações (soma, multiplicação) em dados criptografados. Resultados decifrados correspondem à operação nos dados originais. Permite processamento em cloud sem expor dados. Ainda computacionalmente cara.",
        x: "Enc(a) + Enc(b) = Enc(a+b). Cloud processa sem ver valores. Tipos: parcial (uma operação), fully (FHE, qualquer operação). Bibliotecas: Microsoft SEAL, Google FHE. Uso: saúde, finanças.",
      },
      {
        q: "Qual a diferença entre ECC (Elliptic Curve Cryptography) e RSA?",
        o: [
          "ECC oferece mesma segurança com chaves menores; ECC-256 ≈ RSA-3072",
          "RSA é mais rápido que ECC",
          "ECC usa chaves maiores que RSA",
          "Ambos são algoritmos simétricos",
        ],
        c: 0,
        e: "ECC baseia-se no logaritmo discreto em curvas elípticas; RSA na fatoração de primos. ECC atinge mesma segurança com chaves menores: ECC-256 ≈ RSA-3072. Resultado: ECC é mais rápido e consome menos recursos.",
        x: "ECC-256 ≈ RSA-3072 ≈ AES-128 (mesmo nível). TLS 1.3 prefere ECDHE+ECDSA. Curvas: P-256, P-384, Curve25519 (moderna, usada em WireGuard).",
      },
      {
        q: "O que é criptografia pós-quântica e por que é necessária?",
        o: [
          "Algoritmos resistentes a computadores quânticos que quebrariam RSA e ECC",
          "Criptografia que só funciona em computadores quânticos",
          "Versão mais rápida do AES",
          "Método de criptografia usando fótons",
        ],
        c: 0,
        e: "Computadores quânticos com algoritmo de Shor poderiam quebrar RSA e ECC. Criptografia pós-quântica usa problemas matemáticos resistentes a quânticos: lattices, códigos, hashes. NIST selecionou CRYSTALS-Kyber (encapsulação) e CRYSTALS-Dilithium (assinatura).",
        x: "Shor: quebra RSA/ECC. Grover: reduz segurança de AES pela metade (AES-256 → 128 bits quânticos). NIST PQC: Kyber (ML-KEM), Dilithium (ML-DSA). Hybrid: TLS com clássico + PQC simultaneamente. 'Colha agora, decifre depois' → urgência.",
      },
      {
        q: "O que são funções de derivação de chave como bcrypt, scrypt e Argon2?",
        o: [
          "Funções propositalmente lentas para dificultar força bruta em hashes de senhas",
          "Algoritmos rápidos de criptografia simétrica",
          "Métodos de compressão de chaves",
          "Protocolos de troca de chaves",
        ],
        c: 0,
        e: "KDFs (Key Derivation Functions) para senhas são intencionalmente lentas e consomem muita memória/CPU. bcrypt: custo configurável (rounds). scrypt: custo de memória. Argon2: vencedor do PHC (Password Hashing Competition), custo de tempo + memória + paralelismo.",
        x: "SHA-256(senha): bilhões/segundo em GPU. bcrypt(12 rounds): ~3/segundo. Argon2id: recomendado (resistência a GPU/ASIC). Configuração: pelo menos 250ms por hash. OWASP recomenda Argon2id.",
      },
      {
        q: "O que é o algoritmo de Shor e qual seu impacto na criptografia?",
        o: [
          "Algoritmo quântico que fatoriza primos em tempo polinomial, quebrando RSA e ECC",
          "Algoritmo clássico de criptografia simétrica",
          "Método de geração de números aleatórios",
          "Função hash resistente a colisões",
        ],
        c: 0,
        e: "O algoritmo de Shor (1994) pode fatorar números primos e resolver logaritmos discretos em tempo polinomial em um computador quântico. Isso quebraria RSA, ECC e Diffie-Hellman. Por isso a urgência em migrar para criptografia pós-quântica.",
        x: "RSA: segurança baseada em fatoração de primos. ECC: logaritmo discreto em curvas elípticas. Shor resolve ambos. AES é menos afetado (Grover: reduz segurança pela metade). Timeline: 10-20 anos para quantum prático, mas 'harvest now, decrypt later'.",
      },
      {
        q: "O que é Key Wrapping e como é usado em gerenciamento de chaves?",
        o: [
          "Técnica de criptografar uma chave com outra chave (KEK) para proteger chaves em trânsito ou armazenamento",
          "Método de geração de chaves aleatórias",
          "Protocolo de distribuição de chaves públicas",
          "Backup de chaves em hardware",
        ],
        c: 0,
        e: "Key Wrapping criptografa uma chave (DEK — Data Encryption Key) usando outra chave (KEK — Key Encryption Key). Permite armazenar e transportar chaves de forma segura. Algoritmo: AES Key Wrap (RFC 3394).",
        x: "Modelo envelope: dados cifrados com DEK → DEK cifrado com KEK → KEK protegido em HSM. AWS KMS: dados cifrados com data key, data key cifrada com master key (envelope encryption). Evita exposição da master key.",
      },
    ],
  },

  // ── Controle de Acesso ──
  "Controle de Acesso": {
    Fácil: [
      {
        q: "Qual conceito de segurança diz que um usuário deve ter apenas as permissões mínimas necessárias para realizar seu trabalho?",
        o: [
          "Princípio do menor privilégio (Least Privilege)",
          "Segregação de funções",
          "Defesa em profundidade",
          "Zero Trust",
        ],
        c: 0,
        e: "O princípio do menor privilégio (PoLP) limita o acesso de cada usuário, processo ou sistema ao mínimo necessário. Reduz a superfície de ataque e o impacto de contas comprometidas. Exemplo: um analista financeiro não precisa de acesso admin ao servidor.",
        x: "Aplicação prática: usar conta padrão (não admin) no dia a dia; dar acesso somente às pastas necessárias; usar sudo em vez de login como root. Se uma conta for comprometida, o dano é limitado.",
      },
      {
        q: "O que é autenticação em segurança da informação?",
        o: [
          "Processo de verificar a identidade de um usuário antes de conceder acesso",
          "Permissão para acessar qualquer recurso",
          "Registro de atividades do usuário",
          "Criptografia de dados do usuário",
        ],
        c: 0,
        e: "Autenticação verifica 'quem é você'. Métodos: senha (algo que sabe), token (algo que tem), biometria (algo que é). Diferente de autorização (o que pode fazer) e auditoria (o que fez). Juntos formam AAA.",
        x: "AAA: Authentication (quem é), Authorization (o que pode), Accounting (o que fez). Login com senha = autenticação. Acesso à pasta financeira = autorização. Log de arquivos abertos = auditoria.",
      },
      {
        q: "O que é MFA (Multi-Factor Authentication) e por que é importante?",
        o: [
          "Autenticação com dois ou mais fatores diferentes; protege mesmo se a senha for comprometida",
          "Usar múltiplas senhas para a mesma conta",
          "Login em múltiplos dispositivos",
          "Firewall com múltiplas regras",
        ],
        c: 0,
        e: "MFA exige fatores de categorias diferentes. Se a senha vaza, o atacante ainda precisa do segundo fator. FIDO2/WebAuthn é o padrão mais seguro (phishing-resistant).",
        x: "Segurança: SMS (SIM swap vulnerável) < TOTP (Google Authenticator) < FIDO2/hardware key. MFA ≠ duas senhas (mesmo fator). Fatores: Conhecimento, Posse, Inerência.",
      },
      {
        q: "Qual a diferença entre autenticação e autorização?",
        o: [
          "Autenticação verifica a identidade; autorização define o que o usuário pode acessar",
          "São a mesma coisa",
          "Autorização vem antes da autenticação",
          "Autenticação é para redes e autorização para aplicações",
        ],
        c: 0,
        e: "Autenticação (AuthN): 'quem é você?' (login). Autorização (AuthZ): 'o que você pode fazer?' (permissões). Primeiro autentica, depois autoriza. Exemplo: login (AuthN) → acesso à pasta financeira negado (AuthZ).",
        x: "OAuth 2.0 = AuthZ framework (access token). OIDC = AuthN layer (ID token). SAML = ambos. Erro comum: confundir os dois. Um usuário autenticado não necessariamente está autorizado.",
      },
      {
        q: "O que é uma política de senhas?",
        o: [
          "Conjunto de regras sobre comprimento mínimo, complexidade e renovação de senhas",
          "Software que gera senhas automáticas",
          "Lista de senhas proibidas",
          "Método de criptografia de senhas",
        ],
        c: 0,
        e: "Política de senhas define: comprimento mínimo (ex: 12+ caracteres), complexidade (maiúsculas, números, símbolos), histórico (não repetir), bloqueio após tentativas falhas. NIST 800-63 moderno: priorizar comprimento sobre complexidade.",
        x: "NIST atual: mín 8 chars, sem obrigar complexidade forçada, verificar contra listas de senhas vazadas, sem expirar forçada. Melhor: passphrase longa ('cavalo-bateria-grampo-correto') + MFA.",
      },
      {
        q: "O que é biometria e como é usada no controle de acesso?",
        o: [
          "Uso de características físicas únicas como impressão digital, rosto ou íris para autenticação",
          "Senha gerada por algoritmo matemático",
          "Certificado digital pessoal",
          "Cartão de acesso com chip RFID",
        ],
        c: 0,
        e: "Biometria usa características físicas ou comportamentais para autenticar. Tipos: impressão digital, reconhecimento facial, íris, voz, padrão de digitação. É o fator 'algo que você é' (inerência). Vantagem: não pode ser esquecida nem emprestada.",
        x: "FAR (False Acceptance Rate): aceitar impostores. FRR (False Rejection Rate): rejeitar usuários legítimos. CER (Crossover Error Rate): equilíbrio ideal. Problema: biometria comprometida não pode ser 'trocada' como senha.",
      },
      {
        q: "O que é bloqueio de conta (account lockout)?",
        o: [
          "Mecanismo que bloqueia temporariamente a conta após várias tentativas de login falhas",
          "Desativação permanente de conta inativa",
          "Criptografia de credenciais",
          "Backup de senhas no servidor",
        ],
        c: 0,
        e: "Account lockout bloqueia a conta após N tentativas falhas (ex: 5 falhas → bloqueio de 30 min). Previne força bruta. Risco: DoS intencional (atacante bloqueia contas legítimas). Mitigação: lockout progressivo, CAPTCHA.",
        x: "Configuração típica: 5 tentativas → lockout 15-30 min. Alternativas: rate limiting (limitar tentativas por IP), CAPTCHA após 3 falhas, MFA. AD: Account Lockout Policy (GPO). Monitorar via Event ID 4740.",
      },
    ],
    Médio: [
      {
        q: "Qual modelo de controle de acesso usa papéis (roles) para atribuir permissões aos usuários?",
        o: [
          "RBAC (Role-Based Access Control)",
          "DAC (Discretionary Access Control)",
          "MAC (Mandatory Access Control)",
          "ABAC (Attribute-Based Access Control)",
        ],
        c: 0,
        e: "RBAC: permissões são atribuídas a papéis (admin, editor, leitor), e usuários são atribuídos a papéis. Simplifica a gestão de permissões. DAC: o dono do recurso define permissões. MAC: acesso baseado em classificação (secreto, confidencial). ABAC: baseado em atributos (hora, local, departamento).",
        x: "RBAC: User → Role → Permission. Ex: 'Médico' tem permissão de 'ler prontuário' e 'prescrever'. Novo médico → atribui role 'Médico' → herda todas as permissões. Escalável e auditável.",
      },
      {
        q: "O que é o modelo AAA (Authentication, Authorization, Accounting)?",
        o: [
          "Framework que combina autenticação (quem é), autorização (o que pode) e contabilização (o que fez)",
          "Três tipos de firewall diferentes",
          "Classificação de risco em três níveis",
          "Três camadas de criptografia",
        ],
        c: 0,
        e: "AAA: Authentication (identidade), Authorization (permissões), Accounting (registro de ações). Implementado com RADIUS e TACACS+. Exemplo: login via RADIUS, permissões do papel, ações registradas.",
        x: "RADIUS (porta 1812): AuthN+AuthZ juntos, criptografa só a senha. TACACS+ (porta 49): separa os três, criptografa pacote inteiro. RADIUS: redes. TACACS+: dispositivos Cisco.",
      },
      {
        q: "O que é Single Sign-On (SSO) e quais seus benefícios?",
        o: [
          "Login único que dá acesso a múltiplos sistemas sem reautenticar",
          "Senha que funciona apenas uma vez",
          "Login que exige senha a cada ação",
          "Sistema que bloqueia acesso após uma tentativa",
        ],
        c: 0,
        e: "SSO permite login uma vez para acessar múltiplos sistemas. Benefícios: melhor experiência, menos senhas, controle centralizado. Protocolos: SAML, OAuth 2.0, OpenID Connect.",
        x: "Exemplo: login Google dá acesso a Gmail, Drive, YouTube. SAML (enterprise, XML), OAuth 2.0 (authorization), OIDC (authentication, JSON). Risco: conta SSO comprometida = acesso a tudo.",
      },
      {
        q: "O que é NAC (Network Access Control)?",
        o: [
          "Sistema que verifica conformidade do dispositivo antes de permitir acesso à rede",
          "Firewall de próxima geração",
          "Protocolo de criptografia de rede",
          "Software de monitoramento de tráfego",
        ],
        c: 0,
        e: "NAC verifica se o dispositivo atende às políticas de segurança antes de conceder acesso: antivírus atualizado, patches em dia, disk encryption, conformidade. Se não conforme: quarentena ou acesso limitado.",
        x: "Implementação: 802.1X + RADIUS + agent no endpoint. Pré-admission: verifica antes de dar acesso. Post-admission: monitora continuamente. Ferramentas: Cisco ISE, Aruba ClearPass, Forescout.",
      },
      {
        q: "O que é Segregação de Funções (Separation of Duties/SoD)?",
        o: [
          "Princípio em que nenhuma pessoa tem privilégios suficientes para cometer fraude sozinha",
          "Dividir a rede em segmentos",
          "Ter dois firewalls em série",
          "Usar senhas diferentes para cada sistema",
        ],
        c: 0,
        e: "SoD divide responsabilidades críticas entre múltiplas pessoas. Exemplo: quem solicita pagamento ≠ quem aprova ≠ quem executa. Previne fraude e erros. Complementar ao menor privilégio.",
        x: "DevOps: dev não faz deploy em prod sozinho. Financeiro: 4-eyes principle (dupla aprovação). IAM: RBAC com roles mutuamente exclusivas. SOX compliance exige SoD para empresas públicas.",
      },
      {
        q: "O que é SAML e onde é usado?",
        o: [
          "Protocolo baseado em XML para Single Sign-On em ambientes corporativos",
          "Algoritmo de criptografia simétrica",
          "Software de gerenciamento de senhas",
          "Firewall para aplicações web",
        ],
        c: 0,
        e: "SAML (Security Assertion Markup Language) é um protocolo baseado em XML que permite SSO entre Identity Provider (IdP) e Service Provider (SP). Muito usado em ambientes corporativos para login único em múltiplas aplicações.",
        x: "Fluxo: usuário acessa SP → redireciona para IdP (ex: Okta, Azure AD) → autentica → IdP envia SAML Assertion (assinada) → SP valida e dá acesso. SAML vs OIDC: SAML é XML (enterprise), OIDC é JSON/JWT (moderno).",
      },
      {
        q: "O que é IAM (Identity and Access Management)?",
        o: [
          "Sistema centralizado que gerencia identidades, autenticação, autorização e ciclo de vida de contas",
          "Tipo de firewall para aplicações",
          "Protocolo de criptografia",
          "Software de backup de credenciais",
        ],
        c: 0,
        e: "IAM é o framework que gerencia: criação e exclusão de contas, autenticação (MFA/SSO), autorização (RBAC/ABAC), auditoria e compliance. Centraliza o controle sobre quem acessa o quê em toda a organização.",
        x: "Componentes: Identity Provider (IdP), Directory (AD/LDAP), SSO, MFA, PAM, Identity Governance. Soluções: Azure AD (Entra ID), Okta, AWS IAM, Google Workspace. Onboarding/offboarding automatizado.",
      },
    ],
    Difícil: [
      {
        q: "No modelo Zero Trust, qual é o princípio fundamental que o diferencia do modelo de segurança perimetral?",
        o: [
          "Nunca confiar, sempre verificar — toda requisição é autenticada e autorizada independentemente da origem",
          "Confiar em tudo dentro da rede corporativa",
          "Usar apenas firewalls de próxima geração",
          "Eliminar senhas e usar apenas biometria",
        ],
        c: 0,
        e: "Zero Trust elimina o conceito de 'rede confiável'. Mesmo dentro da rede corporativa, cada requisição é autenticada, autorizada e criptografada. Assume que qualquer dispositivo/usuário pode estar comprometido. Pilares: verificação contínua, menor privilégio, microsegmentação, MFA.",
        x: "Modelo antigo: 'dentro da rede = confiável'. Zero Trust: 'ninguém é confiável por padrão'. Implementação: IAM robusto, MFA, microsegmentação, cifração end-to-end, monitoramento contínuo. Frameworks: NIST SP 800-207, Google BeyondCorp.",
      },
      {
        q: "Como funciona o OAuth 2.0 e qual a diferença para OpenID Connect (OIDC)?",
        o: [
          "OAuth 2.0 é para autorização (access tokens); OIDC adiciona autenticação (ID tokens)",
          "OAuth é mais seguro que OIDC",
          "Ambos são protocolos de criptografia",
          "OIDC substituiu completamente o OAuth",
        ],
        c: 0,
        e: "OAuth 2.0: framework de autorização — permite apps acessarem recursos em nome do usuário (access token), sem expor senha. NÃO autentica. OIDC: camada de identidade sobre OAuth 2.0 com ID token (JWT).",
        x: "OAuth: 'app X pode acessar suas fotos' (autorização). OIDC: 'faça login com Google' (autenticação). Grant types: authorization code, implicit, client credentials. OAuth sozinho não diz quem é o usuário.",
      },
      {
        q: "O que é PAM (Privileged Access Management) e por que é essencial?",
        o: [
          "Gerenciamento de contas privilegiadas para controlar, monitorar e auditar acessos admin",
          "Software antivírus para administradores",
          "Plugin de autenticação para Linux",
          "Módulo de autorização em servidores web",
        ],
        c: 0,
        e: "PAM protege contas privilegiadas (admin, root, DBA). Cofre de senhas, rotação automática, sessões gravadas, acesso just-in-time. Contas privilegiadas são o alvo #1 de atacantes.",
        x: "Sem PAM: admin compartilha senha root. Com PAM: solicita acesso → aprovação → senha temporária → sessão gravada → revogado. Ferramentas: CyberArk, BeyondTrust, HashiCorp Vault.",
      },
      {
        q: "O que é ABAC (Attribute-Based Access Control) e como difere do RBAC?",
        o: [
          "ABAC usa atributos (horário, localização, risco) para decisões; mais granular que RBAC baseado em papéis",
          "São idênticos",
          "ABAC é mais simples que RBAC",
          "RBAC usa atributos e ABAC usa papéis",
        ],
        c: 0,
        e: "RBAC: User → Role → Permission. ABAC: avalia atributos do sujeito (cargo, departamento), recurso (classificação), ação (ler/escrever) e contexto (horário, localização, risco) para cada decisão. ABAC é mais flexível mas mais complexo.",
        x: "RBAC: 'Médico pode ler prontuário'. ABAC: 'Médico pode ler prontuário SE no horário de expediente E no hospital E é seu paciente'. Políticas XACML ou OPA (Open Policy Agent). AWS IAM usa ABAC.",
      },
      {
        q: "O que é JIT (Just-In-Time) access em controle de acesso?",
        o: [
          "Acesso privilegiado concedido temporariamente sob demanda e revogado automaticamente",
          "Acesso permanente a recursos críticos",
          "Login imediato sem autenticação",
          "Backup just-in-time de credenciais",
        ],
        c: 0,
        e: "JIT access: privilégios elevados são concedidos apenas quando necessários, por tempo limitado, com aprovação. Após o período, acesso é revogado automaticamente. Reduz a janela de exposição de contas privilegiadas.",
        x: "Sem JIT: admin tem acesso 24/7 (risco). Com JIT: solicita → justificativa → aprovação → acesso por 4h → revogado. Azure AD PIM (Privileged Identity Management) e AWS IAM Identity Center suportam JIT.",
      },
      {
        q: "O que é microsegmentação e como melhora o controle de acesso?",
        o: [
          "Divisão da rede em segmentos granulares com políticas individuais, limitando movimentação lateral",
          "Uso de múltiplos firewalls em série",
          "Criptografia de cada segmento separadamente",
          "Backup segmentado por departamento",
        ],
        c: 0,
        e: "Microsegmentação cria zonas de segurança granulares (até nível de workload/container). Cada segmento tem políticas de acesso próprias. Se um atacante compromete um segmento, não consegue mover-se lateralmente para outros.",
        x: "VLAN: segmentação macro. Microsegmentação: políticas por workload (VM, container, bare-metal). Ferramentas: VMware NSX, Illumio, Guardicore. Zero Trust: microsegmentação é pilar fundamental.",
      },
      {
        q: "O que é FIDO2/WebAuthn e por que é resistente a phishing?",
        o: [
          "Padrão de autenticação com chave pública vinculada ao domínio; chave privada nunca sai do dispositivo",
          "Versão avançada de senhas de uso único",
          "Protocolo de criptografia de email",
          "Método de autenticação por SMS",
        ],
        c: 0,
        e: "FIDO2/WebAuthn usa criptografia de chave pública: a chave privada fica no dispositivo (hardware key ou biometria), vinculada ao domínio específico. Site falso com domínio diferente não consegue se autenticar → phishing-resistant.",
        x: "Fluxo: registro gera par de chaves (privada no dispositivo, pública no servidor). Login: servidor envia challenge → dispositivo assina com privada → servidor verifica com pública. Hardware: YubiKey, Titan Key. Passwordless: futuro da autenticação (passkeys).",
      },
    ],
  },

  // ── Forense Digital ──
  "Forense Digital": {
    Fácil: [
      {
        q: "Qual é o primeiro passo ao realizar uma investigação forense digital?",
        o: [
          "Preservar as evidências (cadeia de custódia)",
          "Deletar logs suspeitos",
          "Reiniciar o computador",
          "Instalar um antivírus",
        ],
        c: 0,
        e: "A preservação de evidências é fundamental: qualquer alteração pode invalidar a prova judicialmente. Deve-se isolar o dispositivo, fazer imagem forense bit-a-bit do disco e documentar cada ação (cadeia de custódia). Nunca trabalhe na evidência original.",
        x: "Cadeia de custódia: quem, quando, onde, o quê. Usar write-blockers para evitar alteração do disco. Criar imagem forense com dd ou FTK Imager. Calcular hash (SHA-256) da imagem para garantir integridade.",
      },
      {
        q: "O que é uma imagem forense de um disco?",
        o: [
          "Cópia bit-a-bit exata de todo o conteúdo do disco, incluindo dados deletados",
          "Screenshot da tela do computador",
          "Foto do equipamento apreendido",
          "Backup dos arquivos visíveis do disco",
        ],
        c: 0,
        e: "Imagem forense é clone exato bit-a-bit do disco, incluindo espaço livre e dados não alocados. Diferente de backup comum, que copia só arquivos visíveis. Usa-se write-blockers para não alterar o original.",
        x: "Ferramentas: dd (Linux), FTK Imager, EnCase. Hash SHA-256 garante integridade. Formatos: raw (.001), E01 (EnCase), AFF. Análise é feita na cópia, NUNCA no original.",
      },
      {
        q: "Para que serve um write-blocker em forense digital?",
        o: [
          "Impedir qualquer escrita no disco original durante a coleta de evidências",
          "Bloquear vírus no computador",
          "Impedir cópia de arquivos do disco",
          "Criptografar dados antes de copiar",
        ],
        c: 0,
        e: "Write-blocker (hardware ou software) permite apenas leitura do disco de evidência, impedindo alteração acidental. Essencial para manter integridade da evidência e validade legal da cadeia de custódia.",
        x: "Hardware: dispositivo físico entre disco e computador forense. Software: PALADIN, regras de somente-leitura. Sem write-blocker: montar o disco pode alterar timestamps e metadados.",
      },
      {
        q: "O que é hash em forense digital e para que serve?",
        o: [
          "Valor único gerado a partir de dados que garante a integridade da evidência",
          "Senha criptografada do disco",
          "Método de compressão de arquivos forenses",
          "Backup do disco de evidência",
        ],
        c: 0,
        e: "Hash (SHA-256, MD5) gera um valor fixo a partir de qualquer dado. Qualquer alteração gera hash diferente, provando que a evidência foi modificada. Deve-se calcular hash ao coletar e ao analisar.",
        x: "Fluxo: coletar disco → calcular SHA-256 → gerar imagem forense → calcular SHA-256 da imagem → comparar. Se hashes iguais = cópia íntegra. Ferramentas: sha256sum, md5sum, hashdeep.",
      },
      {
        q: "O que é cadeia de custódia em forense digital?",
        o: [
          "Documentação de todas as pessoas e ações realizadas sobre uma evidência",
          "Corrente usada para prender equipamentos apreendidos",
          "Sequência de senhas de acesso ao sistema",
          "Lista de softwares instalados no computador",
        ],
        c: 0,
        e: "Cadeia de custódia registra quem coletou, transportou, armazenou e analisou cada evidência, com datas e assinaturas. Qualquer falha invalida a prova judicialmente. Deve ser ininterrupta.",
        x: "Campos: data/hora, responsável, ação (coleta/transporte/análise), local, condição. Sem cadeia de custódia ⇒ advogado contesta integridade ⇒ prova rejeitada pelo juiz.",
      },
      {
        q: "O que é volatilidade de dados em forense digital?",
        o: [
          "Classificação dos dados conforme a rapidez com que se perdem ao desligar o dispositivo",
          "Capacidade de armazenamento do disco rígido",
          "Velocidade de leitura da memória RAM",
          "Taxa de falha de componentes eletrônicos",
        ],
        c: 0,
        e: "Dados voláteis (RAM, cache, registradores) se perdem ao desligar; dados não voláteis (disco, flash) persistem. A RFC 3227 define a ordem de coleta: mais volátil primeiro.",
        x: "Ordem de volatilidade (RFC 3227): registradores → cache → RAM → tabelas de roteamento → disco → mídias removíveis → logs remotos. RAM deve ser capturada ANTES de desligar com LiME ou winpmem.",
      },
      {
        q: "O que é a ferramenta Autopsy em forense digital?",
        o: [
          "Plataforma open-source de análise forense que examina discos, recupera arquivos e analisa artefatos",
          "Software para criptografar evidências digitais",
          "Antivírus especializado em forense",
          "Ferramenta de backup forense proprietária",
        ],
        c: 0,
        e: "Autopsy é plataforma GUI open-source baseada no Sleuth Kit para análise forense. Permite: examinar imagens de disco, recuperar arquivos deletados, analisar timeline, extrair artefatos web e e-mail.",
        x: "Autopsy + Sleuth Kit: padrão open-source. Funcionalidades: file carving, keyword search, hash filtering, EXIF extraction, timeline. Alternativas comerciais: EnCase, FTK (Forensic Toolkit), X-Ways.",
      },
    ],
    Médio: [
      {
        q: "O que são metadados em contexto forense e por que são importantes?",
        o: [
          "Dados sobre dados (autoria, data, localização) que podem revelar informações ocultas sobre um arquivo",
          "São os dados visíveis no conteúdo do arquivo",
          "São vírus escondidos em documentos",
          "São backups automáticos do sistema",
        ],
        c: 0,
        e: "Metadados são 'dados sobre dados': informações como data de criação/modificação, autor, localização GPS (em fotos), dispositivo usado, histórico de edições. Em forense, metadados revelam quem criou o arquivo, quando, onde e com qual software — mesmo que o conteúdo visível não mostre.",
        x: "Foto JPEG: EXIF contém modelo da câmera, data, coordenadas GPS. Documento Word: autor, datas, impressora, revisões. Email: headers com IPs de origem, rota, timestamps. Ferramenta: ExifTool, Autopsy.",
      },
      {
        q: "O que é esteganografia e como se relaciona com forense?",
        o: [
          "Técnica de esconder informações dentro de arquivos como imagens, sem alterar a aparência",
          "Criptografia de nível militar",
          "Técnica de compressão de dados",
          "Método de recuperar arquivos deletados",
        ],
        c: 0,
        e: "Esteganografia oculta dados dentro de outros arquivos (imagens, áudio) de forma imperceptível. Diferente de criptografia (esconde conteúdo), esteganografia esconde que há mensagem. Forense: detectar com steganalysis.",
        x: "Técnica: substituir bits menos significativos (LSB) de pixels. Foto parece normal mas contém dados ocultos. Detecção: StegDetect, zsteg, binwalk. Esteganografia + criptografia = muito difícil de detectar.",
      },
      {
        q: "O que são artefatos forenses em um sistema operacional?",
        o: [
          "Vestígios de atividade: registros, logs, arquivos temporários e histórico de navegação",
          "Hardware apreendido como evidência",
          "Vírus encontrados no sistema",
          "Backups automáticos do sistema",
        ],
        c: 0,
        e: "Artefatos são vestígios digitais: Windows Registry, prefetch (programas executados), browser history, LNK files (atalhos recentes), Event Logs, arquivos temporários, lixeira.",
        x: "Windows: Registry (NTUSER.DAT, SAM, SYSTEM), Prefetch, $MFT, Event Logs. Linux: /var/log, .bash_history, wtmp/btmp. Browser: SQLite (History, Cookies). Ferramentas: Autopsy, KAPE.",
      },
      {
        q: "O que é file carving em forense digital?",
        o: [
          "Técnica de recuperação de arquivos usando assinaturas de cabeçalho e rodapé em dados brutos",
          "Técnica de criptografia de disco",
          "Método de formatação segura",
          "Processo de compactação de evidências",
        ],
        c: 0,
        e: "File carving recupera arquivos de espaço não alocado do disco usando assinaturas (headers/footers) como JPEG (FF D8 FF), PDF (%PDF), ZIP (PK). Funciona mesmo sem sistema de arquivos intacto.",
        x: "Ferramentas: Scalpel, PhotoRec, Foremost. Cada tipo de arquivo tem magic bytes: JPEG=FF D8 FF, PNG=89 50 4E 47, EXE=4D 5A. Limitação: arquivos fragmentados podem ser recuperados incompletos.",
      },
      {
        q: "O que são logs de eventos do sistema operacional e qual sua importância forense?",
        o: [
          "Registros de atividades do SO essenciais para reconstruir ações do atacante",
          "Backup automático de arquivos do usuário",
          "Relatórios de antivírus",
          "Registros de garantia do hardware",
        ],
        c: 0,
        e: "Event Logs registram logins, execuções, erros e alterações. No Windows: Security (4624=login, 4625=falha, 4688=processo), System, Application. No Linux: auth.log, syslog, journalctl.",
        x: "Windows Event IDs críticos: 4624 (logon), 4625 (logon falho), 4648 (logon explícito), 4688 (novo processo), 1102 (log limpo = suspeito!). Ferramenta: EvtxECmd, LogParser, ELK Stack.",
      },
      {
        q: "O que é análise de registro (Registry) do Windows em forense?",
        o: [
          "Exame dos hives do Registry para identificar programas executados, dispositivos USB conectados e configurações alteradas",
          "Análise de logs de antivírus",
          "Verificação de integridade de drivers",
          "Recuperação de senhas do administrador",
        ],
        c: 0,
        e: "O Windows Registry armazena configurações do SO e rastros de atividade do usuário. Hives forenses: SAM (contas), SYSTEM (configuração), NTUSER.DAT (atividade do usuário), SOFTWARE (programas instalados).",
        x: "Artefatos: MRU (Most Recently Used), UserAssist (programas executados com contagem), ShellBags (pastas acessadas), USB (USBSTOR). Ferramentas: RegRipper, Registry Explorer, RECmd.",
      },
      {
        q: "O que é slack space e como pode conter evidências?",
        o: [
          "Espaço entre o fim lógico de um arquivo e o fim do cluster, podendo conter restos de dados anteriores",
          "Espaço livre no disco para novos arquivos",
          "Área de swap da memória RAM",
          "Partição oculta criada pelo sistema operacional",
        ],
        c: 0,
        e: "Quando um arquivo não preenche o cluster inteiro, o espaço restante (slack space) pode conter dados residuais de arquivos anteriores. É fonte valiosa de evidências que ferramentas forenses podem recuperar.",
        x: "Tipos: RAM slack (entre fim do arquivo e fim do setor) e file slack (entre fim do setor e fim do cluster). Ferramentas: EnCase, FTK, Sleuth Kit (`blkstat`). Dados em slack space sobrevivem a formatação rápida.",
      },
    ],
    Difícil: [
      {
        q: "O que é uma análise de memória volátil (RAM forensics) e quando ela é preferível à análise de disco?",
        o: [
          "Análise do conteúdo da RAM que captura processos em execução, chaves de criptografia e malware fileless não presente no disco",
          "Análise mais rápida do disco rígido",
          "Verificação de integridade de hardware",
          "Recuperação de arquivos deletados do disco",
        ],
        c: 0,
        e: "RAM forensics captura dados voláteis: processos ativos, conexões de rede, chaves de criptografia em uso, malware fileless (que existe apenas na memória). Essencial porque desligar o computador destrói esses dados. Ferramentas: Volatility Framework, Rekall. Um dump de RAM pode revelar senhas, URLs visitadas e artefatos que nunca tocam o disco.",
        x: "Captura: `winpmem` (Windows), `LiME` (Linux). Análise com Volatility: `pslist` (processos), `netscan` (conexões), `malfind` (código injetado), `hashdump` (hashes de senhas). Malware moderno é fileless — só existe na RAM.",
      },
      {
        q: "O que é anti-forensics e quais técnicas são utilizadas?",
        o: [
          "Técnicas para dificultar investigação forense: wiping, criptografia de disco, timestomping",
          "Ferramentas usadas pela polícia",
          "Antivírus especializado para forense",
          "Técnica de recuperação de dados deletados",
        ],
        c: 0,
        e: "Anti-forensics: técnicas para destruir, ocultar ou manipular evidências. Inclui: wiping seguro (sobrescrever dados), criptografia de disco (VeraCrypt), esteganografia, timestomping (alterar timestamps), fileless malware, Tor/VPN.",
        x: "Ferramentas: Eraser/SDelete (wiping), timestomping (alterar datas NTFS), CCleaner (limpar artefatos), VeraCrypt (hidden volume), Tails Linux (sem disco). Contra-medida: captura de RAM antes de desligar.",
      },
      {
        q: "O que é análise de timeline forense e por que é importante?",
        o: [
          "Reconstrução cronológica de todos os eventos para entender a sequência de ações do atacante",
          "Verificação de datas de garantia do hardware",
          "Análise de desempenho do disco ao longo do tempo",
          "Monitoramento de backup em tempo real",
        ],
        c: 0,
        e: "Timeline reconstrói cronologicamente eventos: criação/modificação de arquivos, execução de programas, conexões de rede, logins. Permite entender desde a entrada até a exfiltração de dados.",
        x: "Ferramentas: plaso/log2timeline (super timeline), Autopsy. Fontes: $MFT, $UsnJrnl, Event Logs, prefetch, browser history. Timestomping tenta enganar, mas $UsnJrnl mantém registros.",
      },
      {
        q: "O que é análise de tráfego de rede (PCAP) em forense digital?",
        o: [
          "Captura e análise de pacotes de rede para identificar comunicação maliciosa e exfiltração de dados",
          "Análise de cabos de rede físicos",
          "Teste de velocidade da internet",
          "Verificação de configuração do roteador",
        ],
        c: 0,
        e: "Análise de PCAP (Packet Capture) reconstrói comunicações de rede: conexões C2 (command & control), exfiltração de dados, DNS tunneling, transferências de arquivos. Captura com tcpdump, Wireshark.",
        x: "Ferramentas: Wireshark, NetworkMiner, Zeek/Bro, tcpdump. Análise: filtrar IPs suspeitos, exportar objetos HTTP, detectar beacons C2 (conexões periódicas), DNS queries anômalas. Formato: .pcap, .pcapng.",
      },
      {
        q: "O que é live forensics e quando é preferível à análise post-mortem?",
        o: [
          "Investigação com sistema ligado para capturar dados voláteis e conexões ativas antes de desligar",
          "Análise feita em laboratório após desligar o sistema",
          "Forense realizada em tempo real por câmeras de vigilância",
          "Investigação de sistemas que já foram formatados",
        ],
        c: 0,
        e: "Live forensics coleta dados com sistema ativo: RAM (processos, chaves cripto), conexões de rede, discos criptografados montados, malware fileless. Necessária quando desligar destruiria evidências críticas.",
        x: "Ordem de volatilidade (RFC 3227): registradores > cache > RAM > disco > logs remotos. Live: netstat -anob, tasklist, dump RAM com winpmem. Risco: o investigador altera o sistema (footprint mínimo).",
      },
      {
        q: "O que é análise forense de containers e quais os desafios?",
        o: [
          "Investigação de containers efêmeros que exige captura em execução, logs do orquestrador e análise de camadas de imagem",
          "Análise física de servidores em data centers",
          "Verificação de integridade de contêineres de transporte",
          "Auditoria de máquinas virtuais tradicionais",
        ],
        c: 0,
        e: "Containers (Docker/K8s) são efêmeros: ao parar, dados não persistidos se perdem. Forense exige: capturar filesystem em execução (`docker export`), coletar logs do orquestrador, analisar camadas da imagem e volumes.",
        x: "Desafios: containers vivem segundos/minutos, sem persistência padrão, overlay filesystem. Ferramentas: `docker diff`, `docker logs`, Sysdig Inspect, Falco (runtime). K8s: audit logs do API server.",
      },
      {
        q: "O que é DFIR e como forense digital e resposta a incidentes se integram?",
        o: [
          "Digital Forensics and Incident Response: forense fornece evidências para entender o ataque enquanto IR contém a ameaça",
          "Software de backup e recuperação de desastres",
          "Certificação de segurança da informação",
          "Metodologia de desenvolvimento seguro",
        ],
        c: 0,
        e: "DFIR combina forense digital (coletar e analisar evidências) com resposta a incidentes (conter, erradicar, recuperar). IR precisa de forense para entender o vetor; forense precisa de IR para preservar evidências a tempo.",
        x: "Fluxo DFIR: detecção → triagem → contenção → coleta de evidências → análise → erradicação → recuperação → lições aprendidas. Ferramentas: Velociraptor, GRR, TheHive + Cortex. SANS DFIR e FIRST são referências.",
      },
    ],
  },

  // ── Gestão de Riscos ──
  "Gestão de Riscos": {
    Fácil: [
      {
        q: "Na gestão de riscos, qual é a fórmula básica para calcular o nível de risco?",
        o: [
          "Risco = Probabilidade × Impacto",
          "Risco = Ameaça + Vulnerabilidade",
          "Risco = Custo ÷ Benefício",
          "Risco = Ameaça × Custo",
        ],
        c: 0,
        e: "O risco é o produto da probabilidade de um evento ocorrer pelo impacto que ele causaria. Probabilidade alta + impacto alto = risco crítico. Probabilidade baixa + impacto baixo = risco aceitável. A matriz de riscos organiza isso visualmente.",
        x: "Exemplo: vazamento de dados de clientes. Probabilidade: média (3/5). Impacto: alto (5/5). Risco = 3 × 5 = 15 (alto). Ação: implementar criptografia, controle de acesso e treinamento.",
      },
      {
        q: "O que é uma vulnerabilidade em segurança da informação?",
        o: [
          "Fraqueza em um sistema que pode ser explorada por uma ameaça",
          "Tipo de vírus de computador",
          "Software de proteção de rede",
          "Relatório de segurança periódico",
        ],
        c: 0,
        e: "Vulnerabilidade é fraqueza em hardware, software, processo ou pessoas que pode ser explorada. Exemplos: software sem patches, configuração incorreta, senhas fracas. Ameaça explora vulnerabilidade para causar impacto.",
        x: "Ameaça × Vulnerabilidade = Risco. CVE: banco de vulnerabilidades conhecidas. CVSS: pontuação de severidade (0-10). Exemplo: CVE-2021-44228 (Log4Shell) = CVSS 10.0.",
      },
      {
        q: "O que é uma ameaça em segurança da informação?",
        o: [
          "Agente ou evento que pode explorar uma vulnerabilidade e causar dano",
          "Patch de segurança para sistemas",
          "Ferramenta de monitoramento de rede",
          "Tipo de controle de acesso",
        ],
        c: 0,
        e: "Ameaça é qualquer agente ou circunstância com potencial de causar dano. Tipos: natural (enchente), humana intencional (hacker), humana acidental (erro de configuração), ambiental (falha de energia).",
        x: "Hacker (intencional), funcionário desatento (acidental), ransomware (tecnológica), terremoto (natural). Risco = Ameaça × Vulnerabilidade × Impacto. Sem vulnerabilidade, ameaça não se materializa.",
      },
      {
        q: "O que é um ativo de informação?",
        o: [
          "Qualquer recurso com valor para a organização: dados, sistemas, pessoas, infraestrutura",
          "Apenas hardware físico da empresa",
          "Somente documentos impressos confidenciais",
          "Software antivírus instalado nos computadores",
        ],
        c: 0,
        e: "Ativo de informação inclui dados (banco de dados, planilhas), software (ERP, CRM), hardware (servidores, notebooks), pessoas (conhecimento), infraestrutura (datacenter, rede) e reputação.",
        x: "ISO 27001: inventariar todos os ativos, classificá-los (público, interno, confidencial, secreto) e atribuir proprietários. Ativo mais valioso atualmente: dados pessoais de clientes (LGPD, GDPR).",
      },
      {
        q: "O que significa risco residual?",
        o: [
          "Risco que permanece mesmo após a aplicação de controles de segurança",
          "Risco que foi completamente eliminado",
          "Risco que ainda não foi identificado",
          "Risco transferido para seguradoras",
        ],
        c: 0,
        e: "Risco residual é o que sobra após aplicar controles de mitigação. Risco inerente (sem controle) − eficácia dos controles = risco residual. Deve ser aceito formalmente pela gestão se estiver dentro do apetite ao risco.",
        x: "Exemplo: risco inerente de ransomware = alto. Controles: backup, antimalware, treinamento. Risco residual = médio (ainda existe, mas reduzido). Gestão aceita formalmente o risco residual.",
      },
      {
        q: "O que é mitigação de riscos?",
        o: [
          "Implementar controles para reduzir a probabilidade ou o impacto de um risco",
          "Eliminar completamente qualquer possibilidade de risco",
          "Transferir todos os riscos para terceiros",
          "Ignorar riscos de baixa probabilidade",
        ],
        c: 0,
        e: "Mitigação reduz o risco a um nível aceitável por meio de controles preventivos ou detectivos. É a estratégia de tratamento mais comum. Exemplos: instalar firewall, implementar MFA, treinar funcionários.",
        x: "Mitigação ≠ eliminação total. Sempre resta risco residual. Custo do controle deve ser menor que o impacto esperado. Controles compensatórios são usados quando o controle ideal é inviável.",
      },
      {
        q: "O que é transferência de risco?",
        o: [
          "Passar o impacto financeiro de um risco para terceiros, como seguradoras ou provedores",
          "Mover dados para outro servidor",
          "Deletar informações confidenciais",
          "Contratar mais funcionários de segurança",
        ],
        c: 0,
        e: "Transferência de risco repassa consequências financeiras a terceiros: seguro cyber (cobre custos de breach), outsourcing (SLA com penalidades), cláusulas contratuais. A responsabilidade legal geralmente permanece.",
        x: "Seguro cyber: cobre custos de notificação, forense, multas, perda de receita. SLA: provedor paga penalidade se indisponibilidade > limite. Atenção: transferência não elimina responsabilidade regulatória (LGPD).",
      },
    ],
    Médio: [
      {
        q: "Quais são as quatro estratégias básicas de tratamento de riscos?",
        o: [
          "Evitar, Mitigar, Transferir e Aceitar",
          "Prevenir, Detectar, Responder e Recuperar",
          "Negar, Ignorar, Escalar e Documentar",
          "Planejar, Executar, Verificar e Agir",
        ],
        c: 0,
        e: "1) Evitar: eliminar a atividade que gera o risco. 2) Mitigar: reduzir probabilidade e/ou impacto com controles. 3) Transferir: passar o risco a terceiro (seguro, outsourcing). 4) Aceitar: reconhecer o risco e não agir (quando o custo do controle > impacto). Cada risco recebe uma estratégia baseada em custo-benefício.",
        x: "Evitar: não coletar dados desnecessários. Mitigar: instalar firewall, MFA. Transferir: contratar seguro cyber. Aceitar: risco de queda de energia de 5min/ano em sistema não-crítico.",
      },
      {
        q: "O que é uma matriz de riscos e como é utilizada?",
        o: [
          "Ferramenta visual que cruza probabilidade e impacto para classificar riscos",
          "Planilha de inventário de ativos de TI",
          "Diagrama de rede da organização",
          "Lista de políticas de segurança",
        ],
        c: 0,
        e: "A matriz de riscos cruza probabilidade (eixo Y) e impacto (eixo X), resultando em níveis: baixo, médio, alto, crítico. Permite priorizar: riscos críticos recebem atenção imediata; baixos podem ser aceitos.",
        x: "Exemplo 5×5: probabilidade (raro a quase certo) × impacto (insignificante a catastrófico). Cores: verde (baixo), amarelo (médio), laranja (alto), vermelho (crítico).",
      },
      {
        q: "O que é BIA (Business Impact Analysis) e para que serve?",
        o: [
          "Análise que identifica processos críticos e o impacto de sua interrupção",
          "Software de backup empresarial",
          "Auditoria de conformidade legal",
          "Análise de performance de rede",
        ],
        c: 0,
        e: "BIA identifica processos críticos e avalia o impacto de sua interrupção. Define: RTO (tempo máximo de indisponibilidade) e RPO (perda de dados aceitável). Alimenta o Plano de Continuidade de Negócios (BCP/DRP).",
        x: "RTO = quanto tempo pode ficar fora? RPO = quantos dados pode perder? Sistema financeiro: RTO = 1h, RPO = 0. Email: RTO = 4h, RPO = 1h. BIA → BCP/DRP.",
      },
      {
        q: "O que é um registro de riscos (risk register)?",
        o: [
          "Documento que lista riscos identificados, classificação, responsáveis e ações de tratamento",
          "Software de monitoramento de rede",
          "Backup de logs do sistema",
          "Contrato com empresa de seguros",
        ],
        c: 0,
        e: "Risk register documenta cada risco: descrição, probabilidade, impacto, nível, proprietário, estratégia de tratamento, status e prazo. É atualizado periodicamente e revisado pela gestão.",
        x: "Colunas: ID | Risco | Probabilidade | Impacto | Nível | Proprietário | Tratamento | Status | Prazo. Alimenta: relatórios gerenciais, reuniões de comitê de risco, auditorias internas.",
      },
      {
        q: "O que é apetite ao risco (risk appetite)?",
        o: [
          "Nível de risco que a organização está disposta a aceitar para atingir seus objetivos",
          "Quantidade máxima de funcionários em TI",
          "Orçamento total destinado à segurança",
          "Número de incidentes de segurança por ano",
        ],
        c: 0,
        e: "Risk appetite é definido pela alta gestão e orienta todas as decisões de risco. Um banco tem apetite baixo (regulação rígida); uma startup pode aceitar mais risco para inovar. Tolerância ao risco é a variação aceitável.",
        x: "Apetite (estratégico, amplo) vs Tolerância (operacional, específica). Exemplo: 'aceitamos risco médio em TI' (apetite). 'Downtime máximo de 4h/mês' (tolerância). COSO ERM e ISO 31000 abordam risk appetite.",
      },
      {
        q: "O que é análise de cenários em gestão de riscos?",
        o: [
          "Simulação de situações hipotéticas para avaliar impacto de diferentes ameaças e preparar respostas",
          "Análise do desempenho financeiro passado",
          "Comparação de preços entre fornecedores de segurança",
          "Estudo da concorrência no mercado de TI",
        ],
        c: 0,
        e: "Análise de cenários (what-if) simula situações como 'e se houver um ransomware?', 'e se o datacenter pegar fogo?'. Permite avaliar impacto, testar planos de resposta e priorizar investimentos em segurança.",
        x: "Cenários: melhor caso, caso esperado, pior caso. Tabletop exercises: simulação sem impacto real. Exemplo: cenário de breach → equipe discute ações → identifica gaps. NIST SP 800-84 guia exercícios.",
      },
      {
        q: "O que são KRI (Key Risk Indicators)?",
        o: [
          "Métricas que sinalizam aumento de exposição a riscos antes que incidentes ocorram",
          "Indicadores de desempenho de funcionários de TI",
          "Classificações de vulnerabilidades em software",
          "Relatórios mensais de compliance",
        ],
        c: 0,
        e: "KRIs são métricas preditivas que alertam quando o risco está aumentando. Diferente de KPIs (medem desempenho passado), KRIs antecipam problemas. Exemplo: aumento de tentativas de login falhas pode indicar ataque iminente.",
        x: "Exemplos de KRI: % de patches pendentes, nº de tentativas de acesso não autorizado, tempo médio para corrigir vulnerabilidades, turnover de equipe de segurança. KRI → dashboard de riscos → ação proativa.",
      },
    ],
    Difícil: [
      {
        q: "Qual é a diferença entre análise de risco qualitativa e quantitativa?",
        o: [
          "Qualitativa classifica riscos em categorias (alto/médio/baixo); quantitativa atribui valores monetários e probabilidades numéricas",
          "Qualitativa é mais precisa que quantitativa",
          "Quantitativa não usa dados numéricos",
          "Ambas são idênticas na prática",
        ],
        c: 0,
        e: "Qualitativa: classifica riscos em escalas (1-5 ou alto/médio/baixo) por opinião de especialistas. Rápida, mas subjetiva. Quantitativa: calcula valores monetários (SLE = Single Loss Expectancy, ALE = Annual Loss Expectancy) e probabilidades reais. Mais precisa, mas requer dados históricos e é mais demorada.",
        x: "Quantitativa: Asset Value = R$1M. EF (Exposure Factor) = 30%. SLE = 1M × 0,3 = R$300K. ARO (Annual Rate of Occurrence) = 0,5. ALE = SLE × ARO = 300K × 0,5 = R$150K/ano. Se controle custa R$50K/ano → vale a pena.",
      },
      {
        q: "O que é RTO, RPO e MTPD no planejamento de continuidade?",
        o: [
          "RTO: tempo de recuperação. RPO: perda de dados aceitável. MTPD: período máximo tolerável de interrupção",
          "São três tipos de backup",
          "Métricas de performance de rede",
          "Classificações de certificados",
        ],
        c: 0,
        e: "RTO (Recovery Time Objective): tempo máximo para restaurar. RPO (Recovery Point Objective): perda máxima de dados (em tempo). MTPD (Maximum Tolerable Period of Disruption): tempo total que o negócio sobrevive sem o processo.",
        x: "Relação: RPO ≤ RTO ≤ MTPD. RPO = 1h (backup horário). RTO = 4h (restaurar em 4h). MTPD = 24h (negócio sobrevive 24h). RTO > MTPD = plano insuficiente.",
      },
      {
        q: "O que é a ISO 31000 e como se relaciona com segurança da informação?",
        o: [
          "Framework genérico de gestão de riscos; ISO 27005 o especializa para segurança da informação",
          "Norma de criptografia internacional",
          "Certificação de profissionais de segurança",
          "Protocolo de comunicação segura",
        ],
        c: 0,
        e: "ISO 31000: framework genérico de gestão de riscos (não certificável). ISO 27005: especializa para riscos de SI, integrando-se com ISO 27001 (SGSI). ISO 27001 cláusula 6.1.2 exige avaliação de riscos.",
        x: "ISO 31000: gestão de riscos genérica. ISO 27005: riscos de SI. NIST SP 800-30: alternativa americana. ISO 27001: SGSI (certificável). A 27005 detalha COMO fazer a avaliação de riscos exigida pela 27001.",
      },
      {
        q: "O que é o framework FAIR (Factor Analysis of Information Risk)?",
        o: [
          "Modelo quantitativo que decompõe risco em frequência de eventos de perda e magnitude de perdas",
          "Framework de desenvolvimento ágil",
          "Padrão de criptografia simétrica",
          "Metodologia de teste de software",
        ],
        c: 0,
        e: "FAIR quantifica risco em termos financeiros. Decompõe: LEF (Loss Event Frequency) × LM (Loss Magnitude). LEF = TEF (Threat Event Frequency) × Vulnerability. LM = Primary Loss + Secondary Loss.",
        x: "Exemplo FAIR: probabilidade de breach = 10%/ano. Perda primária (resposta): R$500K. Perda secundária (multas, reputação): R$2M. ALE = 10% × R$2,5M = R$250K/ano. Justifica controle de R$200K.",
      },
      {
        q: "O que é threat modeling e quais metodologias são utilizadas?",
        o: [
          "Identificação sistemática de ameaças a um sistema; metodologias incluem STRIDE, PASTA e DREAD",
          "Modelagem 3D de data centers",
          "Simulação de ataques DDoS",
          "Teste de carga em servidores",
        ],
        c: 0,
        e: "Threat modeling analisa arquitetura para encontrar ameaças antes que sejam exploradas. STRIDE (Microsoft): Spoofing, Tampering, Repudiation, Information Disclosure, DoS, Elevation. PASTA: 7 estágios focados em risco.",
        x: "STRIDE: modelo por ameaça. DREAD: classifica severidade (Damage, Reproducibility, Exploitability, Affected users, Discoverability). PASTA: Process for Attack Simulation and Threat Analysis. LINDDUN: privacidade.",
      },
      {
        q: "O que é o método Monte Carlo aplicado à gestão de riscos?",
        o: [
          "Simulação estatística que gera milhares de cenários aleatórios para estimar distribuição de probabilidades de perdas",
          "Método de criptografia baseado em números aleatórios",
          "Técnica de teste de penetração automatizado",
          "Algoritmo de balanceamento de carga em servidores",
        ],
        c: 0,
        e: "Monte Carlo executa milhares/milhões de simulações com variáveis aleatórias para gerar distribuição de resultados possíveis. Em riscos: estima intervalo de perdas financeiras com graus de confiança (ex: 95% de chance de perda < R$2M).",
        x: "Processo: definir variáveis (probabilidade, impacto) → atribuir distribuições → rodar 10.000+ simulações → gerar histograma de resultados. Ferramentas: @RISK, Crystal Ball, Python (NumPy/SciPy). FAIR usa Monte Carlo.",
      },
      {
        q: "O que é bow-tie analysis em gestão de riscos?",
        o: [
          "Diagrama visual que conecta ameaças ao evento de risco e consequências, mostrando barreiras preventivas e reativas",
          "Tipo de criptografia bidirecional",
          "Metodologia de desenvolvimento seguro",
          "Técnica de backup incremental e diferencial",
        ],
        c: 0,
        e: "Bow-tie mostra: à esquerda as ameaças com barreiras preventivas, no centro o evento de risco, à direita as consequências com barreiras de mitigação. Formato de gravata-borboleta. Visão clara de como prevenir e responder.",
        x: "Esquerda: ameaças → barreiras preventivas → EVENTO → barreiras reativas → consequências (direita). Cada barreira tem indicadores de degradação. Usado em óleo/gás, aviação e cybersecurity. Ferramentas: BowTieXP, CGE Risk.",
      },
    ],
  },

  // ── Governança e Compliance ──
  "Governança e Compliance": {
    Fácil: [
      {
        q: "O que significa 'compliance' no contexto de segurança da informação?",
        o: [
          "Estar em conformidade com leis, normas e regulamentações",
          "Compilar código-fonte sem erros",
          "Completar todos os treinamentos de segurança",
          "Comprar equipamentos certificados",
        ],
        c: 0,
        e: "Compliance é o ato de estar em conformidade com leis (LGPD, GDPR), normas (ISO 27001), regulamentações setoriais (PCI-DSS, HIPAA) e políticas internas. Envolve processos, controles e auditorias para garantir que a organização cumpre requisitos legais e regulatórios.",
        x: "Exemplos: PCI-DSS (cartões de crédito), HIPAA (saúde nos EUA), SOX (finanças), LGPD (dados pessoais no Brasil), GDPR (dados na UE). Não compliance → multas, processos, perda de reputação.",
      },
      {
        q: "O que é uma auditoria de segurança da informação?",
        o: [
          "Avaliação sistemática para verificar se controles estão implementados e funcionando",
          "Instalação de antivírus em todos os computadores",
          "Atualização de software do firewall",
          "Teste de velocidade da rede",
        ],
        c: 0,
        e: "Auditoria verifica se controles de segurança estão conforme políticas, normas e regulamentações. Pode ser interna (equipe própria) ou externa (auditores independentes). Gera relatório com achados e recomendações.",
        x: "Tipos: interna, externa, de certificação (ISO 27001). Etapas: planejamento → coleta de evidências → análise → relatório → acompanhamento.",
      },
      {
        q: "O que é PCI-DSS e a quem se aplica?",
        o: [
          "Padrão de segurança para empresas que processam dados de cartões de pagamento",
          "Lei brasileira de proteção de dados",
          "Certificação de profissionais de segurança",
          "Protocolo de criptografia bancária",
        ],
        c: 0,
        e: "PCI-DSS são requisitos de segurança para empresas que lidam com dados de cartões. Visa, MasterCard e outras bandeiras exigem conformidade. Inclui criptografia, controle de acesso, testes regulares e políticas de segurança.",
        x: "12 requisitos: firewall, proteção de dados, criptografia, antivírus, desenvolvimento seguro, controle de acesso, testes de penetração. Níveis: 1 (>6M transações) a 4 (<20K).",
      },
      {
        q: "O que é uma política de segurança da informação?",
        o: [
          "Documento formal que define diretrizes e regras de segurança para a organização",
          "Software de proteção contra vírus",
          "Contrato de seguro contra ataques",
          "Manual técnico de configuração de firewall",
        ],
        c: 0,
        e: "A política de segurança é o documento base que define princípios, responsabilidades e regras que todos devem seguir. Deve ser aprovada pela alta gestão e comunicada a todos os colaboradores.",
        x: "Hierarquia: Política (diretrizes gerais) → Normas (regras específicas) → Procedimentos (passo-a-passo). Exemplo: política diz 'senhas fortes'; norma define '12+ caracteres'; procedimento ensina como trocar.",
      },
      {
        q: "O que são controles de segurança da informação?",
        o: [
          "Medidas técnicas, administrativas ou físicas para proteger informações",
          "Apenas software antivírus",
          "Somente câmeras de vigilância",
          "Controle remoto de computadores",
        ],
        c: 0,
        e: "Controles podem ser: técnicos (firewall, criptografia, MFA), administrativos (políticas, treinamento, processos) e físicos (catracas, biometria, CFTV). ISO 27001 Anexo A lista 93 controles organizados em 4 temas.",
        x: "Preventivos (evitar incidente), Detectivos (identificar incidente), Corretivos (responder ao incidente). Exemplos: firewall (preventivo), IDS (detectivo), backup restore (corretivo).",
      },
      {
        q: "O que é HIPAA e a quem se aplica?",
        o: [
          "Lei americana que protege informações de saúde; aplica-se a hospitais, seguradoras e parceiros",
          "Lei brasileira de proteção de dados",
          "Certificação de segurança para redes",
          "Protocolo de criptografia médica",
        ],
        c: 0,
        e: "HIPAA (Health Insurance Portability and Accountability Act) protege informações de saúde (PHI) nos EUA. Aplica-se a covered entities (hospitais, clínicas, seguradoras) e business associates (parceiros que tratam PHI).",
        x: "HIPAA Security Rule: controles técnicos, administrativos e físicos para ePHI. Multas: $100 a $50.000 por violação (máx $1,5M/ano). Breach notification: 60 dias. Comparação: LGPD protege dados pessoais em geral.",
      },
      {
        q: "O que é um framework de segurança da informação?",
        o: [
          "Conjunto estruturado de diretrizes, práticas e controles para gerenciar e proteger informações",
          "Software de proteção contra vírus",
          "Linguagem de programação segura",
          "Hardware especializado em criptografia",
        ],
        c: 0,
        e: "Um framework fornece estrutura organizada para implementar segurança: define O QUE proteger, COMO proteger e COMO medir. Exemplos: NIST CSF, ISO 27001, CIS Controls. Cada organização escolhe conforme seu setor e maturidade.",
        x: "Principais: NIST CSF (5+1 funções), ISO 27001 (SGSI certificável), CIS Controls (18 controles priorizados), COBIT (governança de TI). Escolha: regulação exige? → ISO 27001/PCI-DSS. Maturidade baixa? → CIS Controls.",
      },
    ],
    Médio: [
      {
        q: "Qual framework de governança de TI é mais utilizado para alinhar serviços de TI às necessidades do negócio?",
        o: ["ITIL", "SCRUM", "Kanban", "XP"],
        c: 0,
        e: "ITIL (Information Technology Infrastructure Library) é o framework mais adotado para gerenciamento de serviços de TI (ITSM). Define práticas para alinhar serviços de TI às necessidades de negócio: gerenciamento de incidentes, problemas, mudanças, configuração, SLAs. COBIT é outra opção voltada para governança.",
        x: "ITIL v4 práticas: Incident Management, Problem Management, Change Enablement, Service Desk. COBIT: governança e gestão de TI (mais estratégico). ITIL: operacional. ISO 20000: certificação de ITSM baseada em ITIL.",
      },
      {
        q: "O que é o COBIT e para que serve?",
        o: [
          "Framework de governança e gestão de TI que alinha TI aos objetivos de negócio",
          "Linguagem de programação segura",
          "Certificação de segurança para redes",
          "Tipo de firewall empresarial",
        ],
        c: 0,
        e: "COBIT (Control Objectives for IT) é framework de governança do ISACA. Define objetivos de controle, métricas e modelos de maturidade. Complementa ITIL (operacional) com visão estratégica.",
        x: "COBIT 2019: 40 objetivos de governança e gestão. Princípios: atender necessidades das partes interessadas, cobrir ponta a ponta. COBIT → estratégico. ITIL → operacional.",
      },
      {
        q: "O que é segregação de funções (SoD) e por que é importante?",
        o: [
          "Separar responsabilidades para que ninguém controle todas as etapas de um processo crítico",
          "Dividir a equipe de TI em departamentos",
          "Separar redes com VLANs",
          "Usar senhas diferentes para cada sistema",
        ],
        c: 0,
        e: "SoD garante que nenhuma pessoa controle todo um processo crítico. Exemplo: quem solicita pagamento ≠ quem aprova ≠ quem executa. Previne fraudes, requisito de SOX, PCI-DSS e ISO 27001.",
        x: "Sem SoD: funcionário cria fornecedor fictício + aprova + recebe = fraude. Com SoD: etapas feitas por pessoas diferentes. Matrix RACI: Responsible, Accountable, Consulted, Informed.",
      },
      {
        q: "O que é um SLA (Service Level Agreement) em segurança da informação?",
        o: [
          "Acordo que define níveis de serviço, tempo de resposta e metas de disponibilidade",
          "Software de monitoramento de logs",
          "Certificação de segurança",
          "Tipo de firewall empresarial",
        ],
        c: 0,
        e: "SLA define métricas e metas entre provedor e cliente: disponibilidade (99,9%), tempo de resposta a incidentes (4h), RPO/RTO. Inclui penalidades por descumprimento. Essencial em contratos de cloud e outsourcing.",
        x: "SLA: 99,9% = 8,76h downtime/ano. 99,99% = 52min/ano. SLI (Service Level Indicator): métrica real. SLO (Objective): meta interna. SLA: compromisso contratual externo.",
      },
      {
        q: "O que é a lei SOX (Sarbanes-Oxley) e como afeta a área de TI?",
        o: [
          "Lei de governança corporativa dos EUA que exige controles internos sobre relatórios financeiros, incluindo TI",
          "Lei brasileira de segurança cibernética",
          "Certificação de profissionais de TI",
          "Protocolo de criptografia financeira",
        ],
        c: 0,
        e: "SOX (2002) exige que empresas listadas nos EUA tenham controles internos sobre relatórios financeiros. TI é afetada porque sistemas ERP, bancos de dados e acessos devem ter controles auditáveis.",
        x: "Seção 302: CEO/CFO atestam precisão dos relatórios. Seção 404: auditoria de controles internos. TI: controle de acesso ao ERP, logs de alteração, segregação de funções, backup de dados financeiros.",
      },
      {
        q: "O que é gestão de mudanças (change management) em TI?",
        o: [
          "Processo controlado para implementar alterações em sistemas minimizando riscos de interrupção",
          "Troca de fornecedores de hardware",
          "Mudança de escritório da empresa",
          "Atualização de políticas de RH",
        ],
        c: 0,
        e: "Change management controla alterações em sistemas de TI para evitar incidentes. Processo: solicitação → avaliação de impacto → aprovação (CAB) → implementação → revisão pós-implementação. Reduz riscos de downtime.",
        x: "ITIL Change Enablement: Normal (CAB aprova), Standard (pré-aprovada, baixo risco), Emergency (urgente, aprovação posterior). CAB = Change Advisory Board. Sem gestão de mudanças → 80% dos incidentes são causados por mudanças mal planejadas.",
      },
      {
        q: "O que é o GDPR e qual sua relação com a LGPD?",
        o: [
          "Regulamento europeu de proteção de dados que inspirou a LGPD brasileira",
          "Lei americana de segurança cibernética",
          "Protocolo de criptografia europeu",
          "Framework de governança de TI global",
        ],
        c: 0,
        e: "GDPR (2018) é o regulamento europeu de proteção de dados pessoais. Inspirou a LGPD brasileira. Ambas protegem dados pessoais, exigem bases legais, DPO e notificação de incidentes. GDPR tem multas maiores (até 4% do faturamento global).",
        x: "GDPR: 4% faturamento global ou €20M. LGPD: 2% faturamento Brasil ou R$50M. GDPR tem decisões de adequação; LGPD está regulamentando. GDPR: DPA (Data Protection Authority) = ANPD. Schrems II impactou transferências EUA-UE.",
      },
    ],
    Difícil: [
      {
        q: "Qual a relação entre COBIT, ITIL e ISO 27001 na governança corporativa de TI?",
        o: [
          "COBIT: governança estratégica. ITIL: gestão de serviços operacional. ISO 27001: sistema de gestão de segurança da informação",
          "São três versões do mesmo framework",
          "COBIT substitui ITIL e ISO 27001",
          "ISO 27001 inclui COBIT e ITIL integralmente",
        ],
        c: 0,
        e: "São complementares: COBIT (Control Objectives for IT) — framework de governança para alinhar TI ao negócio (nível estratégico). ITIL — melhores práticas para gestão de serviços de TI (nível operacional). ISO 27001 — sistema de gestão de segurança da informação (SGSI) com requisitos para implementar, manter e melhorar controles de segurança.",
        x: "COBIT → 'O que fazer' (objetivos, métricas). ITIL → 'Como fazer' (processos operacionais). ISO 27001 → 'Como proteger' (controles de segurança). Organizações maduras usam os três: COBIT para governança, ITIL para serviços, ISO 27001 para segurança.",
      },
      {
        q: "O que é o SOC 2 e quais são seus Trust Service Criteria?",
        o: [
          "Relatório de auditoria para provedores; critérios: Segurança, Disponibilidade, Integridade, Confidencialidade, Privacidade",
          "Certificação ISO para segurança",
          "Centro de operações de segurança",
          "Segundo nível de compliance SOX",
        ],
        c: 0,
        e: "SOC 2 avalia controles de provedores de serviço em 5 critérios: Segurança (obrigatório), Disponibilidade, Integridade de Processamento, Confidencialidade e Privacidade. Tipo I: design (momento). Tipo II: efetividade (período).",
        x: "SOC 1: controles financeiros. SOC 2: operacionais/segurança (mais solicitado por clientes cloud/SaaS). SOC 3: relatório público (resumido). SOC 2 Tipo II é o padrão do mercado.",
      },
      {
        q: "Qual a relação entre governança, gestão de riscos e compliance (GRC)?",
        o: [
          "Três disciplinas integradas: governança define direção, riscos avalia ameaças, compliance garante conformidade",
          "GRC é um tipo de firewall",
          "São três certificações independentes",
          "GRC é software de monitoramento",
        ],
        c: 0,
        e: "GRC integra: Governança (estrutura decisória), Riscos (identificar e tratar riscos) e Compliance (conformidade com leis). Abordagem integrada evita silos, reduz custos e melhora visão de riscos.",
        x: "Sem GRC integrado: cada área gerencia riscos isoladamente. Com GRC: visão unificada. Ferramentas: ServiceNow GRC, RSA Archer. Framework: COSO ERM para Enterprise Risk Management.",
      },
      {
        q: "O que é o NIST Cybersecurity Framework e como se estrutura?",
        o: [
          "Framework em 5 funções (Identify, Protect, Detect, Respond, Recover) para gestão de riscos cibernéticos",
          "Certificação de segurança do governo americano",
          "Software de detecção de intrusão",
          "Protocolo de comunicação segura",
        ],
        c: 0,
        e: "NIST CSF organiza segurança em 5 funções: Identify (inventário, riscos), Protect (controles preventivos), Detect (monitoramento), Respond (resposta a incidentes), Recover (restauração). Amplamente adotado internacionalmente.",
        x: "NIST CSF 2.0 (2024): adicionou Govern como 6ª função. Tiers: 1 (Parcial) a 4 (Adaptivo). Profiles: estado atual vs desejado. Complementa ISO 27001. NIST SP 800-53: catálogo de controles detalhados.",
      },
      {
        q: "O que é compliance as code e qual sua importância na governança?",
        o: [
          "Automação de verificações de compliance usando código e ferramentas; garante conformidade contínua",
          "Linguagem de programação para auditores",
          "Certificação de código-fonte",
          "Manual de compliance em formato digital",
        ],
        c: 0,
        e: "Compliance as Code automatiza verificações de conformidade: políticas escritas como código, testadas continuamente em pipelines CI/CD. Reduz erro humano e garante compliance em tempo real, não apenas em auditorias periódicas.",
        x: "Ferramentas: Open Policy Agent (OPA/Rego), AWS Config Rules, Azure Policy, Chef InSpec, HashiCorp Sentinel. Exemplo: política 'S3 buckets nunca públicos' verificada a cada deploy automaticamente.",
      },
      {
        q: "O que é o modelo de maturidade CMMI e como se aplica à segurança?",
        o: [
          "Framework que avalia maturidade de processos em 5 níveis; adaptável para medir evolução de controles de segurança",
          "Certificação de hardware seguro",
          "Linguagem de programação para auditoria",
          "Tipo de criptografia por nível",
        ],
        c: 0,
        e: "CMMI (Capability Maturity Model Integration): 5 níveis — 1) Inicial (ad hoc), 2) Gerenciado (por projeto), 3) Definido (padronizado), 4) Quantitativamente Gerenciado (métricas), 5) Otimizado (melhoria contínua). Aplicado à segurança, mede evolução da postura organizacional.",
        x: "C2M2 (Cybersecurity Capability Maturity Model): versão específica para cibersegurança. NIST CSF Tiers: 1-Partial a 4-Adaptive (similar). ISO 27001: ciclo PDCA para melhoria contínua. Organizações maduras: nível 3+ com processos padronizados.",
      },
      {
        q: "O que é third-party risk management (TPRM)?",
        o: [
          "Gestão de riscos introduzidos por fornecedores e parceiros; inclui due diligence e monitoramento contínuo",
          "Gerenciamento de três tipos de firewall",
          "Terceirização completa da segurança",
          "Transferência de dados para terceiros",
        ],
        c: 0,
        e: "TPRM avalia e monitora riscos de fornecedores que acessam dados ou sistemas. Inclui: due diligence pré-contrato, questionários de segurança (SIG), cláusulas contratuais, auditorias periódicas e monitoramento contínuo de riscos.",
        x: "Supply chain attacks (SolarWinds) mostraram a importância. Ferramentas: BitSight, SecurityScorecard (rating externo). Processo: tiering de fornecedores → assessment → contrato com SLA → monitoramento → revisão anual. NIST SP 800-161: supply chain risk.",
      },
    ],
  },

  // ── LGPD ──
  LGPD: {
    Fácil: [
      {
        q: "O que é a LGPD e quando ela entrou em vigor?",
        o: [
          "Lei Geral de Proteção de Dados Pessoais, em vigor desde setembro de 2020",
          "Lei de Governança Digital, 2018",
          "Lei Geral de Proteção Digital, 2021",
          "Lei de Gestão de Dados Públicos, 2019",
        ],
        c: 0,
        e: "A LGPD (Lei nº 13.709/2018) é a lei brasileira que regula o tratamento de dados pessoais por pessoas físicas e jurídicas. Inspirada no GDPR europeu. Entrou em vigor em setembro de 2020, com sanções aplicáveis a partir de agosto de 2021. A ANPD é o órgão fiscalizador.",
        x: "LGPD protege dados pessoais (nome, CPF, email) e dados sensíveis (saúde, religião, biometria). Bases legais: consentimento, legítimo interesse, cumprimento de obrigação legal, etc. Multa: até 2% do faturamento, limitada a R$ 50 milhões por infração.",
      },
      {
        q: "O que são dados pessoais segundo a LGPD?",
        o: [
          "Qualquer informação que identifique ou possa identificar uma pessoa natural",
          "Apenas CPF e RG",
          "Dados de empresas e organizações",
          "Informações públicas disponíveis na internet",
        ],
        c: 0,
        e: "Dado pessoal é toda informação de pessoa identificada ou identificável: nome, CPF, email, IP, cookies, localização. Dados anonimizados não são dados pessoais para a LGPD.",
        x: "Dado pessoal: nome, CPF, email, IP, cookies. Dado sensível (art. 5, II): saúde, etnia, religião, biometria, genética, opinião política. Dados sensíveis têm proteção extra (art. 11).",
      },
      {
        q: "O que é a ANPD e qual seu papel na LGPD?",
        o: [
          "Autoridade Nacional de Proteção de Dados — órgão que fiscaliza e aplica sanções",
          "Agência Nacional de Processamento de Dados",
          "Empresa de certificados digitais",
          "Sistema de backup do governo",
        ],
        c: 0,
        e: "A ANPD fiscaliza o cumprimento da LGPD, orienta empresas e aplica sanções (multas até R$50M). Análoga à CNIL (França) e ICO (UK). Recebe reclamações de titulares e edita normas complementares.",
        x: "Sanções: advertência, multa (até 2% faturamento / R$50M), publicização da infração, bloqueio/eliminação de dados. ANPD: fiscaliza, orienta, edita normas, recebe reclamações.",
      },
      {
        q: "O que são dados pessoais sensíveis na LGPD?",
        o: [
          "Dados sobre saúde, religião, etnia, biometria, genética, opinião política e filiação sindical",
          "Apenas dados bancários",
          "Dados de empresas e CNPJs",
          "Qualquer dado armazenado em computador",
        ],
        c: 0,
        e: "Art. 5º, II da LGPD: dado sensível é sobre origem racial/étnica, religião, opinião política, filiação sindical, saúde, vida sexual, dado genético ou biométrico. Tem proteção reforçada (art. 11).",
        x: "Dados sensíveis: bases legais mais restritivas (art. 11). Não se aplicam: legítimo interesse e proteção do crédito. Comum: consentimento específico ou obrigação legal. Exemplos: prontuário médico, digital biométrica.",
      },
      {
        q: "O que é consentimento na LGPD?",
        o: [
          "Manifestação livre, informada e inequívoca do titular concordando com o tratamento de seus dados",
          "Aceitar termos de uso sem ler",
          "Autorização automática ao criar uma conta",
          "Permissão dada pelo governo para tratar dados",
        ],
        c: 0,
        e: "Consentimento deve ser livre (sem coerção), informado (saber para quê), inequívoco (claro) e para finalidade específica. Pode ser revogado a qualquer momento. Consentimento genérico é nulo.",
        x: "Requisitos: finalidade específica, destaque no contrato, revogável, granular. Erro comum: checkbox pré-marcado (não é livre). Dados sensíveis: consentimento específico e destacado (art. 11, I).",
      },
      {
        q: "O que é tratamento de dados pessoais segundo a LGPD?",
        o: [
          "Toda operação com dados pessoais: coleta, armazenamento, uso, compartilhamento e eliminação",
          "Apenas armazenar dados em banco de dados",
          "Somente o uso comercial de dados",
          "Criptografia obrigatória de todos os dados",
        ],
        c: 0,
        e: "Art. 5º, X da LGPD: tratamento é toda operação realizada com dados pessoais — coleta, produção, recepção, classificação, utilização, acesso, reprodução, transmissão, distribuição, processamento, arquivamento, armazenamento, eliminação, avaliação, controle, modificação, comunicação, transferência, difusão ou extração.",
        x: "Até visualizar dados é tratamento. Imprimir, enviar por email, fazer backup — tudo é tratamento. Cada operação precisa de base legal. Controlador decide COMO tratar; operador executa a mando do controlador.",
      },
      {
        q: "O que é o princípio da finalidade na LGPD?",
        o: [
          "Dados devem ser tratados para propósitos legítimos, específicos e informados ao titular",
          "Dados podem ser usados para qualquer finalidade",
          "Finalidade se refere ao prazo de armazenamento",
          "Princípio que define o formato dos dados",
        ],
        c: 0,
        e: "Art. 6º, I: finalidade é a realização do tratamento para propósitos legítimos, específicos, explícitos e informados ao titular. Não se pode coletar dados para um fim e usar para outro sem nova base legal ou consentimento.",
        x: "10 princípios da LGPD (art. 6º): finalidade, adequação, necessidade, livre acesso, qualidade, transparência, segurança, prevenção, não discriminação, responsabilização. Finalidade é o primeiro e mais fundamental.",
      },
    ],
    Médio: [
      {
        q: "Quais são os agentes de tratamento de dados pessoais definidos pela LGPD?",
        o: [
          "Controlador e Operador",
          "Titular e Processador",
          "Administrador e Usuário",
          "Proprietário e Gerente",
        ],
        c: 0,
        e: "Controlador: toma as decisões sobre o tratamento dos dados (para que, como, quando). Operador: realiza o tratamento em nome do controlador (segue instruções). Exemplo: empresa (controlador) contrata serviço de cloud (operador) para armazenar dados de clientes.",
        x: "Controlador: empresa que coleta dados do cliente. Operador: AWS, Google Cloud, processador de pagamento que trata dados a mando do controlador. Encarregado (DPO): ponte entre controlador, ANPD e titulares.",
      },
      {
        q: "O que é o encarregado de proteção de dados (DPO) na LGPD?",
        o: [
          "Pessoa indicada pelo controlador para ser canal entre controlador, ANPD e titulares",
          "Servidor público da ANPD",
          "Software de proteção de dados",
          "Auditor externo de compliance",
        ],
        c: 0,
        e: "O DPO aceita reclamações de titulares, comunica-se com a ANPD, orienta funcionários sobre proteção de dados e executa atribuições do controlador. Obrigatório para controladores.",
        x: "LGPD: 'encarregado'. GDPR: 'DPO'. Canal de comunicação entre controlador, titulares e ANPD. Pode ser pessoa física ou jurídica (terceirizado).",
      },
      {
        q: "Quais são os direitos dos titulares de dados na LGPD?",
        o: [
          "Acesso, correção, anonimização, portabilidade, eliminação, informação e revogação de consentimento",
          "Apenas o direito de exclusão",
          "Direito de vender seus dados",
          "Direito de acessar dados de outras pessoas",
        ],
        c: 0,
        e: "Art. 18 garante: confirmação de tratamento, acesso, correção, anonimização/bloqueio/eliminação, portabilidade, informação sobre compartilhamento, revogação de consentimento.",
        x: "Direitos: confirmar, acessar, corrigir, anonimizar, portar, eliminar, informar, revogar. Controlador deve responder em tempo razoável. Exceções legais para eliminação.",
      },
      {
        q: "O que é Privacy by Design e como se relaciona com a LGPD?",
        o: [
          "Incorporar privacidade desde a concepção do sistema; a LGPD exige medidas de segurança desde o projeto",
          "Design visual de políticas de privacidade",
          "Software de criptografia de dados",
          "Layout de página de consentimento",
        ],
        c: 0,
        e: "Privacy by Design (Ann Cavoukian) incorpora privacidade na arquitetura do sistema desde o início, não como remendo posterior. LGPD art. 46 §2: medidas de segurança devem ser observadas desde a concepção do produto/serviço.",
        x: "7 princípios: proativo (não reativo), privacidade como padrão, embutida no design, funcionalidade total, segurança ponta-a-ponta, visibilidade/transparência, respeito ao usuário. GDPR art. 25: Data Protection by Design.",
      },
      {
        q: "O que é transferência internacional de dados na LGPD?",
        o: [
          "Envio de dados pessoais para outro país, permitida apenas com garantias adequadas de proteção",
          "Backup de dados em servidor no Brasil",
          "Compartilhamento entre empresas brasileiras",
          "Migração de banco de dados entre servidores",
        ],
        c: 0,
        e: "LGPD art. 33: transferência internacional permitida quando: país com proteção adequada (aprovado pela ANPD), cláusulas contratuais padrão, BCRs, consentimento específico, ou cooperação jurídica internacional.",
        x: "Mecanismos: decisão de adequação (ANPD), cláusulas-padrão contratuais (SCCs), BCRs (Binding Corporate Rules), consentimento específico. Comparação GDPR: Schrems II invalidou Privacy Shield (EUA).",
      },
      {
        q: "O que é ROPA (Record of Processing Activities) na LGPD?",
        o: [
          "Registro das operações de tratamento que documenta quais dados são tratados, para quê e por quem",
          "Relatório anual de auditoria",
          "Software de gerenciamento de consentimento",
          "Backup obrigatório de dados pessoais",
        ],
        c: 0,
        e: "ROPA documenta cada atividade de tratamento: dados coletados, finalidade, base legal, categorias de titulares, compartilhamentos, transferências internacionais, prazos de retenção e medidas de segurança. Exigido pela ANPD e GDPR (art. 30).",
        x: "ROPA é obrigatório para controladores e operadores. Campos: atividade de tratamento, dados pessoais envolvidos, finalidade, base legal, compartilhamento, retenção, medidas de segurança. Ferramenta: Data Mapping → ROPA → RIPD.",
      },
      {
        q: "O que é o princípio da minimização de dados na LGPD?",
        o: [
          "Tratar apenas dados estritamente necessários para a finalidade, evitando coleta excessiva",
          "Usar menor quantidade de servidores possível",
          "Minimizar o custo de armazenamento",
          "Excluir todos os dados após o uso",
        ],
        c: 0,
        e: "Art. 6º, III (necessidade): limitação do tratamento ao mínimo necessário. Não coletar dados 'por precaução' ou 'pode ser útil no futuro'. Coletar CPF para cadastro em newsletter é excessivo — email basta.",
        x: "Privacy by Design: coletar só o necessário. Data minimization: menos dados = menor risco. Exemplo ruim: formulário que pede CPF, endereço, renda para enviar email marketing. Exemplo bom: só email + nome.",
      },
    ],
    Difícil: [
      {
        q: "Quais são as bases legais da LGPD para tratamento de dados pessoais? Quantas existem?",
        o: [
          "10 bases legais, incluindo consentimento, legítimo interesse, cumprimento de obrigação legal, entre outras",
          "Apenas consentimento",
          "3 bases: consentimento, contrato e lei",
          "7 bases legais",
        ],
        c: 0,
        e: "A LGPD define 10 bases legais (art. 7º): 1) Consentimento. 2) Obrigação legal/regulatória. 3) Administração pública. 4) Pesquisa. 5) Execução de contrato. 6) Exercício regular de direito. 7) Proteção da vida. 8) Tutela da saúde. 9) Legítimo interesse. 10) Proteção do crédito. O consentimento NÃO é a única base — cada tratamento deve ter uma base legal adequada.",
        x: "Erro comum: achar que tudo precisa de consentimento. Exemplo: folha de pagamento usa base 'obrigação legal'. Cobrança usa 'proteção do crédito'. Dados sensíveis (art. 11) têm bases mais restritivas — não se aplica legítimo interesse nem proteção do crédito.",
      },
      {
        q: "O que é um RIPD (Relatório de Impacto à Proteção de Dados) na LGPD?",
        o: [
          "Documento que descreve tratamentos de alto risco e medidas de mitigação adotadas",
          "Relatório de incidentes de segurança",
          "Laudo de auditoria anual obrigatório",
          "Registro de todas as bases de dados",
        ],
        c: 0,
        e: "O RIPD (DPIA no GDPR) é exigido quando o tratamento pode gerar alto risco. Descreve: dados tratados, finalidade, bases legais, riscos identificados e medidas de mitigação. A ANPD pode requisitá-lo a qualquer momento.",
        x: "RIPD contém: tipos de dados, adequação, riscos, medidas de segurança. Cenários: dados sensíveis em larga escala, decisões automatizadas, monitoramento sistemático.",
      },
      {
        q: "Qual a diferença entre anonimização e pseudonimização de dados na LGPD?",
        o: [
          "Anonimização é irreversível (dado não é mais pessoal); pseudonimização é reversível (dado continua pessoal)",
          "São sinônimos",
          "Anonimização é para sensíveis, pseudonimização para comuns",
          "Pseudonimização é mais segura",
        ],
        c: 0,
        e: "Anonimização: processo IRREVERSÍVEL que remove toda identificação — dados não são pessoais (LGPD não se aplica). Pseudonimização: REVERSÍVEL usando tokens/hash — dados continuam pessoais, LGPD se aplica integralmente.",
        x: "Anonimizado: remove CPF, nome → impossível identificar. Pseudonimizado: CPF substituído por token → reversível com tabela. LGPD incentiva ambos como medidas de segurança.",
      },
      {
        q: "O que é o legítimo interesse como base legal da LGPD e quando pode ser utilizado?",
        o: [
          "Base que permite tratar dados sem consentimento quando há interesse legítimo do controlador, equilibrado com direitos do titular",
          "Interesse do titular em ter seus dados protegidos",
          "Interesse do governo em coletar dados",
          "Base legal que substitui todas as outras",
        ],
        c: 0,
        e: "Legítimo interesse (art. 7, IX) permite tratar dados sem consentimento quando necessário para finalidades legítimas do controlador. Exige LIA (Legitimate Interest Assessment): teste de finalidade, necessidade, balanceamento e salvaguardas.",
        x: "LIA: 1) Finalidade legítima? 2) Dados necessários (minimização)? 3) Equilíbrio com direitos do titular? 4) Salvaguardas (transparência, opt-out). NÃO se aplica a dados sensíveis. Não é carta branca.",
      },
      {
        q: "Como funciona o processo de notificação de incidentes de segurança na LGPD?",
        o: [
          "Controlador deve comunicar ANPD e titulares em prazo razoável sobre incidentes que possam gerar risco ou dano relevante",
          "Apenas registrar internamente sem comunicar externamente",
          "Notificar somente a polícia federal",
          "Comunicar apenas os titulares após 1 ano",
        ],
        c: 0,
        e: "Art. 48: controlador deve comunicar ANPD e titulares afetados em prazo razoável (regulamento diz 72h para ANPD). Informar: natureza dos dados, titulares envolvidos, medidas técnicas, riscos, medidas de mitigação.",
        x: "Conteúdo da notificação: descrição dos dados, titulares afetados, medidas de segurança, riscos, medidas tomadas. ANPD pode determinar: ampla divulgação, medidas para reverter efeitos. Comparação GDPR: 72h para DPA.",
      },
      {
        q: "O que são BCRs (Binding Corporate Rules) no contexto de transferência internacional de dados?",
        o: [
          "Regras corporativas vinculantes aprovadas pela autoridade para transferência de dados dentro de grupo multinacional",
          "Certificação de backup de dados",
          "Regras de firewall entre filiais",
          "Contratos de SLA entre países",
        ],
        c: 0,
        e: "BCRs são políticas internas de um grupo empresarial multinacional aprovadas pela ANPD/DPA para permitir transferência internacional de dados entre suas entidades. Garantem nível adequado de proteção, semelhante ao país de origem.",
        x: "BCRs: custosas e demoradas (meses para aprovação), mas permitem transferência livre dentro do grupo. Alternativas mais simples: SCCs (cláusulas-padrão), decisão de adequação. GDPR art. 47: BCRs aprovadas pela lead DPA.",
      },
      {
        q: "O que é o teste de proporcionalidade aplicado ao legítimo interesse na LGPD?",
        o: [
          "Análise que equilibra o interesse do controlador com os direitos e liberdades fundamentais do titular",
          "Teste de performance de sistemas de segurança",
          "Cálculo do tamanho adequado do banco de dados",
          "Verificação da proporção de dados sensíveis",
        ],
        c: 0,
        e: "O LIA (Legitimate Interest Assessment) avalia: 1) Finalidade legítima do controlador? 2) Tratamento necessário e proporcional? 3) Direitos do titular preservados? 4) Salvaguardas adotadas? Se o impacto ao titular superar o interesse, o legítimo interesse não se aplica.",
        x: "4 etapas: finalidade (legítima?), necessidade (proporcional?), balanceamento (impacto ao titular?), salvaguardas (opt-out, transparência, minimização). Recusado quando: dados sensíveis, crianças, tratamento em larga escala sem transparência. Art. 10 LGPD.",
      },
    ],
  },

  // ── Malwares ──
  Malwares: {
    Fácil: [
      {
        q: "Qual tipo de malware se disfarça como software legítimo para enganar o usuário?",
        o: ["Trojan (Cavalo de Troia)", "Worm", "Ransomware", "Adware"],
        c: 0,
        e: "Trojan se disfarça de programa útil/desejado (jogo, utilitário, crack) para induzir o usuário a instalá-lo. Diferente de vírus, não se replica sozinho — depende da ação do usuário. Uma vez instalado, pode abrir backdoors, roubar dados ou instalar outros malwares.",
        x: "Nome vem da mitologia grega (Cavalo de Troia). Exemplo: 'jogoGratis.exe' que na verdade instala um keylogger. Worm se propaga sozinho pela rede. Vírus se anexa a arquivos. Trojan engana o usuário.",
      },
      {
        q: "O que é malware?",
        o: [
          "Software malicioso criado para danificar, explorar ou obter acesso não autorizado",
          "Software de proteção contra vírus",
          "Atualização de sistema operacional",
          "Programa de backup de dados",
        ],
        c: 0,
        e: "Malware (malicious software) é o termo genérico para qualquer software malicioso. Inclui: vírus, worms, trojans, ransomware, spyware, adware, rootkits, keyloggers. Pode roubar dados, danificar sistemas ou extorquir.",
        x: "Tipos: Vírus (se anexa), Worm (se propaga), Trojan (se disfarça), Ransomware (criptografa), Spyware (espiona), Adware (anúncios), Keylogger (teclas), Rootkit (se oculta no SO).",
      },
      {
        q: "O que é um spyware?",
        o: [
          "Software que monitora atividades do usuário sem consentimento, coletando dados pessoais",
          "Antivírus que espiona outros programas",
          "Programa que protege contra espionagem",
          "Ferramenta de monitoramento autorizada",
        ],
        c: 0,
        e: "Spyware monitora secretamente: sites visitados, teclas digitadas (keylogger), capturas de tela. Coleta dados e envia ao atacante. Pode vir junto com software legítimo ou via exploits.",
        x: "Tipos: Keylogger (teclas), Screen capture, Browser hijacker (altera navegador), Stalkerware (monitoramento de parceiros). Detecção: Malwarebytes, AdwCleaner.",
      },
      {
        q: "O que é ransomware?",
        o: [
          "Malware que criptografa dados da vítima e exige pagamento (resgate) para liberá-los",
          "Software de proteção contra sequestéro de dados",
          "Tipo de antivírus premium",
          "Ferramenta de backup criptografado",
        ],
        c: 0,
        e: "Ransomware cifra arquivos ou bloqueia o sistema e exige pagamento (geralmente em criptomoeda) para fornecer a chave de descriptografia. Dupla extorsão: cifra + ameaça vazar dados roubados.",
        x: "Exemplos: WannaCry (2017, SMB), NotPetya (2017, supply chain), LockBit, REvil. Proteção: backup 3-2-1, patch management, MFA, segmentação de rede. NUNCA pagar garante recuperação.",
      },
      {
        q: "O que é adware?",
        o: [
          "Software que exibe anúncios indesejados e pode coletar dados de navegação",
          "Antivírus gratuito com proteção avançada",
          "Programa para criar anúncios publicitários",
          "Ferramenta de bloqueio de pop-ups",
        ],
        c: 0,
        e: "Adware exibe propagandas intrusivas (pop-ups, banners, redirecionamentos). Pode vir empacotado com software gratuito (bundleware). Versões mais agressivas coletam hábitos de navegação (grayware).",
        x: "Nem todo adware é malicioso (apps suportados por anúncios), mas muitos são indesejados. Pode alterar página inicial do navegador (browser hijacker). Remoção: AdwCleaner, Malwarebytes.",
      },
      {
        q: "O que é um worm de computador?",
        o: [
          "Malware que se autopropaga pela rede sem precisar de arquivo hospedeiro ou ação do usuário",
          "Vírus que infecta apenas documentos Word",
          "Software de monitoramento de rede",
          "Tipo de antivírus para Linux",
        ],
        c: 0,
        e: "Worm é malware autônomo que se propaga automaticamente explorando vulnerabilidades de rede. Diferente do vírus, não precisa de arquivo hospedeiro nem ação do usuário. Pode causar congestionamento de rede pela replicação massiva.",
        x: "Exemplos: Code Red (2001, IIS), SQL Slammer (2003, SQL Server), Conficker (2008, SMB), WannaCry (2017, EternalBlue/SMB). Defesa: patch management, segmentação de rede, IPS.",
      },
      {
        q: "O que é phishing?",
        o: [
          "Técnica de engenharia social que usa mensagens fraudulentas para roubar informações",
          "Tipo de antivírus corporativo",
          "Método de criptografia de emails",
          "Software de filtragem de spam",
        ],
        c: 0,
        e: "Phishing usa emails, SMS (smishing) ou ligações (vishing) se passando por entidades confiáveis para induzir vítimas a revelar senhas, dados bancários ou instalar malware. É o vetor de ataque mais comum (>90% dos breaches).",
        x: "Tipos: spear phishing (alvo específico), whaling (executivos), smishing (SMS), vishing (voz). Defesa: treinamento, filtros de email (SPF/DKIM/DMARC), MFA. Ferramentas de simulação: GoPhish, KnowBe4.",
      },
    ],
    Médio: [
      {
        q: "Qual a diferença entre um vírus e um worm?",
        o: [
          "Vírus precisa de um arquivo hospedeiro e ação do usuário; worm se propaga automaticamente pela rede",
          "São termos sinônimos",
          "Worm é menos perigoso que vírus",
          "Vírus se propaga pela rede e worm precisa de arquivo",
        ],
        c: 0,
        e: "Vírus: precisa de arquivo hospedeiro (se anexa a executáveis, documentos) e ação do usuário para se propagar (abrir arquivo, executar programa). Worm: programa independente que se propaga automaticamente pela rede, explorando vulnerabilidades sem interação do usuário. Worms podem causar congestionamento de rede pela replicação massiva.",
        x: "Vírus: ILOVEYOU (se anexava a emails). Worm: WannaCry (se propagava via SMB vulnerável, sem ação do usuário). Worm pode carregar payload de ransomware, vírus, etc.",
      },
      {
        q: "O que é uma botnet e como funciona?",
        o: [
          "Rede de dispositivos infectados controlados remotamente para ataques coordenados",
          "Rede de robôs industriais",
          "Software de automação de testes",
          "Rede social para hackers",
        ],
        c: 0,
        e: "Botnet: rede de dispositivos infectados (bots/zombies) controlados pelo botmaster via C2 (Comando e Controle). Usada para DDoS, spam, mineração de cripto, roubo de credenciais. Pode ter milhões de dispositivos.",
        x: "Malware infecta PCs/IoT → conecta ao C2 → botmaster envia comandos → bots executam. Exemplos: Mirai (IoT), Emotet (email), Zeus (bancário). Detecção: tráfego anômalo para IPs de C2.",
      },
      {
        q: "O que é um keylogger e como se proteger?",
        o: [
          "Software/hardware que registra teclas digitadas; proteção: antimalware, 2FA, teclado virtual",
          "Tipo de teclado criptografado",
          "Software de teste de teclado",
          "Ferramenta de acessibilidade",
        ],
        c: 0,
        e: "Keylogger captura todas as teclas incluindo senhas e dados bancários. Pode ser software (via malware) ou hardware (dispositivo USB entre teclado e PC). Proteções: antimalware, 2FA (senha roubada não basta), teclado virtual.",
        x: "Software: registra teclas, screenshots, clipboard. Hardware: dispositivo USB invisível ao SO. Detecção: antimalware + inspeção física. 2FA protege porque precisa do segundo fator.",
      },
      {
        q: "O que é fileless malware e por que é difícil de detectar?",
        o: [
          "Malware que opera na memória sem gravar arquivos no disco, evadindo antivírus tradicionais",
          "Malware que não usa internet",
          "Vírus que deleta seus próprios arquivos após infecção",
          "Malware que só funciona off-line",
        ],
        c: 0,
        e: "Fileless malware usa ferramentas legítimas do SO (PowerShell, WMI, macros) e opera apenas na RAM. Antivírus baseados em arquivo não detectam. Requer EDR com análise comportamental e monitoramento de processos.",
        x: "Técnicas: PowerShell com base64, WMI persistence, inject em processos legítimos, macros Office. Ferramentas: LOLBins (Living off the Land Binaries). Detecção: AMSI, EDR, Sysmon, análise de memória.",
      },
      {
        q: "O que é um dropper e como funciona?",
        o: [
          "Malware projetado para instalar outros malwares no sistema da vítima",
          "Ferramenta de transferência de arquivos",
          "Software de instalação de patches",
          "Bot de download automático",
        ],
        c: 0,
        e: "Dropper é o primeiro estágio da infecção: parece inofensivo, mas baixa e instala o payload real (ransomware, RAT, etc). Pode vir como anexo de email, documento com macro ou exploit kit.",
        x: "Dropper (contém payload embutido) vs Downloader (baixa payload da internet). Emotet: começou como trojan bancário, virou dropper-as-a-service para TrickBot/Ryuk. Kill chain: dropper → C2 → payload.",
      },
      {
        q: "O que é um RAT (Remote Access Trojan)?",
        o: [
          "Malware que dá ao atacante controle remoto completo do computador da vítima",
          "Ferramenta legítima de suporte remoto",
          "Tipo de roteador de acesso misto",
          "Software de acesso remoto corporativo",
        ],
        c: 0,
        e: "RAT permite ao atacante controlar remotamente o computador: acessar arquivos, ativar webcam/microfone, capturar tela, executar comandos. Geralmente distribuído via phishing ou dropper. Opera silenciosamente em background.",
        x: "Exemplos: DarkComet, njRAT, Gh0st RAT, QuasarRAT (open-source). Funcionalidades: keylogger, screenshot, webcam, download/upload, shell reverso. Detecção: EDR, análise de tráfego de rede (beacons para C2).",
      },
      {
        q: "O que é cryptojacking?",
        o: [
          "Uso não autorizado de recursos computacionais da vítima para minerar criptomoedas",
          "Criptografia de ransomware",
          "Roubo de carteiras de criptomoedas",
          "Mineração legal de Bitcoin",
        ],
        c: 0,
        e: "Cryptojacking usa CPU/GPU da vítima para minerar criptomoedas sem consentimento. Pode ser via malware instalado ou scripts no navegador (Coinhive, descontinuado). Sintomas: lentidão, alto uso de CPU, superaquecimento.",
        x: "Browser-based: JavaScript minerando Monero (difícil de rastrear). Malware-based: persistente, opera em background. Detecção: monitoramento de CPU, EDR, bloqueio de domínios de mining pools. Impacto: contas de cloud infladas.",
      },
    ],
    Difícil: [
      {
        q: "O que é um rootkit e por que é considerado um dos malwares mais perigosos?",
        o: [
          "Malware que se esconde no sistema operacional/kernel, tornando-se invisível para antivírus convencionais",
          "Vírus que ataca apenas a conta root",
          "Script que adivinha senhas de administrador",
          "Programa que formata o disco rígido remotamente",
        ],
        c: 0,
        e: "Rootkit modifica o kernel/sistema operacional para se ocultar: intercepta chamadas de sistema, esconde processos, arquivos e conexões de rede da visão do antivírus e do SO. Pode operar em nível de kernel (mais perigoso), bootloader (bootkits) ou firmware (UEFI rootkits). Detecção e remoção são extremamente difíceis.",
        x: "Tipos: User-mode (hooks em APIs), Kernel-mode (modifica kernel), Bootkit (infecta MBR/UEFI), Firmware (persiste em BIOS). Detecção: ferramentas offline (boot de CD/USB), análise de memória com Volatility. Remoção: frequentemente exige reinstalação do SO.",
      },
      {
        q: "O que é malware polimórfico e por que é difícil de detectar?",
        o: [
          "Malware que altera seu código a cada infecção para evitar detecção por assinaturas",
          "Malware com múltiplas funcionalidades",
          "Malware que se propaga por bluetooth",
          "Malware que ataca apenas polimorfismo de código",
        ],
        c: 0,
        e: "Polimórfico muda seu código (cifra o payload com chaves diferentes) a cada cópia, mantendo funcionalidade. Antivírus baseados em assinaturas não reconhecem variações. Requer heurística e análise comportamental.",
        x: "Assinatura: identifica bytes conhecidos → falha com polimórfico. Heurístico: analisa comportamento. Metamórfico: reescreve código (ainda mais difícil). EDR/XDR: detecção baseada em comportamento.",
      },
      {
        q: "O que é um ataque de supply chain em malware?",
        o: [
          "Comprometer o desenvolvimento/distribuição de software legítimo para inserir malware",
          "Ataque a caminhões de entrega",
          "Roubo de produtos em trânsito",
          "Bloqueio de importação de hardware",
        ],
        c: 0,
        e: "Supply chain attack: atacante compromete um fornecedor confiável e insere malware no produto legítimo. Vítimas instalam a atualização maliciosa confiando no fornecedor. Muito difícil de detectar.",
        x: "SolarWinds (2020): backdoor no Orion → 18.000 organizações. Kaseya (2021): REvil via atualização. CodeCov (2021): script CI comprometido. Defesa: SBOM, verificar integridade, Zero Trust.",
      },
      {
        q: "O que é um zero-day exploit e por que é tão perigoso?",
        o: [
          "Exploração de vulnerabilidade desconhecida pelo fabricante, sem patch disponível",
          "Ataque que ocorre à meia-noite",
          "Vírus que se ativa no primeiro dia do mês",
          "Malware que se auto-destrói em 24 horas",
        ],
        c: 0,
        e: "Zero-day: vulnerabilidade que o fabricante desconhece (0 dias para corrigir). Exploits zero-day são vendidos no mercado negro por milhões. Sem patch disponível, defesa depende de: EDR, segmentação, Zero Trust.",
        x: "Mercado: zero-day para iOS ~R$10M (Zerodium). Stuxnet usou 4 zero-days. Defesa em profundidade: WAF com regras genéricas, EDR comportamental, microsegmentação, sandboxing. CVE só sai após descoberta.",
      },
      {
        q: "O que é APT (Advanced Persistent Threat) e como opera?",
        o: [
          "Grupo hacker sofisticado com presença prolongada e furtiva na rede da vítima",
          "Tipo de antivírus avançado",
          "Ameaa temporária que se resolve sozinha",
          "Ataque rápido e destrutivo",
        ],
        c: 0,
        e: "APT são grupos (geralmente patrocinados por estados) que infiltram redes por meses/anos. Características: reconhecimento extenso, zero-days, movimentação lateral, exfiltração gradual, evasão de detecção.",
        x: "APT29 (Cozy Bear, Rússia), APT41 (China), Lazarus (Coreia do Norte). Kill chain: recon → weaponize → deliver → exploit → install → C2 → exfiltrate. Defesa: threat intelligence, NDR, EDR, hunting.",
      },
      {
        q: "O que é um bootkit e como difere de um rootkit tradicional?",
        o: [
          "Malware que infecta o processo de boot (MBR/UEFI), carregando antes do SO e sendo mais persistente",
          "Rootkit que opera apenas em modo usuário",
          "Kit de ferramentas para boot de emergência",
          "Software de gerenciamento de boot dual",
        ],
        c: 0,
        e: "Bootkit infecta MBR ou firmware UEFI, carregando antes do sistema operacional. É mais persistente que rootkit de kernel: sobrevive a formatação e reinstalação do SO. Antivírus comum não detecta porque já está ativo antes do boot.",
        x: "Exemplos: TDL4/Alureon (MBR), LoJax (primeiro UEFI rootkit in-the-wild, 2018, APT28). Defesa: UEFI Secure Boot, TPM, medição de integridade de boot. Detecção: ferramentas offline, verificação de firmware.",
      },
      {
        q: "O que é a técnica de process hollowing em malware?",
        o: [
          "Criar processo legítimo em estado suspenso, substituir seu código por malware e executá-lo para evadir detecção",
          "Esvaziar memória RAM para acelerar processos",
          "Técnica de compressão de executáveis",
          "Método de virtualização de processos",
        ],
        c: 0,
        e: "Process hollowing: malware cria um processo legítimo (ex: svchost.exe) suspenso, esvazia sua memória, injeta código malicioso e retoma a execução. O processo aparece legítimo no Task Manager, evadindo detecção.",
        x: "MITRE ATT&CK: T1055.012. Fluxo: CreateProcess(SUSPENDED) → NtUnmapViewOfSection → VirtualAllocEx → WriteProcessMemory → ResumeThread. Detecção: Sysmon (Event ID 25), EDR com análise de memória.",
      },
    ],
  },

  // ── Normas ISO 27001/27002 ──
  "Normas ISO 27001/27002": {
    Fácil: [
      {
        q: "Qual é o objetivo principal da ISO 27001?",
        o: [
          "Estabelecer um Sistema de Gestão de Segurança da Informação (SGSI)",
          "Definir linguagens de programação seguras",
          "Certificar hardware contra ataques físicos",
          "Regular o comércio eletrônico internacional",
        ],
        c: 0,
        e: "A ISO/IEC 27001 especifica os requisitos para implementar, manter e melhorar continuamente um SGSI (Sistema de Gestão de Segurança da Informação). É uma norma certificável — organizações podem obter certificação ISO 27001 após auditoria. O SGSI utiliza o ciclo PDCA (Plan-Do-Check-Act).",
        x: "ISO 27001: requisitos (O QUE implementar) — certificável. ISO 27002: diretrizes de controles (COMO implementar) — não certificável. Analogia: 27001 é o 'contrato' e 27002 é o 'manual de instruções'.",
      },
      {
        q: "O que é o ciclo PDCA e como se aplica à ISO 27001?",
        o: [
          "Plan-Do-Check-Act: ciclo de melhoria contínua para o SGSI",
          "Quatro tipos de criptografia",
          "Protocolo de segurança de rede",
          "Software de gestão de projetos",
        ],
        c: 0,
        e: "PDCA: Plan (planejar controles), Do (implementar), Check (monitorar e auditar), Act (corrigir e melhorar). A ISO 27001 usa PDCA para melhoria contínua do SGSI.",
        x: "Plan: escopo, análise de riscos, selecionar controles. Do: implementar. Check: auditorias internas. Act: ações corretivas. O ciclo se repete continuamente.",
      },
      {
        q: "O que significa SGSI (Sistema de Gestão de Segurança da Informação)?",
        o: [
          "Conjunto de políticas, processos e controles para gerenciar riscos de SI sistematicamente",
          "Software de segurança nos servidores",
          "Tipo de firewall corporativo",
          "Certificação individual de profissionais",
        ],
        c: 0,
        e: "SGSI é abordagem sistemática para gerenciar informações sensíveis: políticas, processos, controles técnicos e pessoas. A ISO 27001 especifica os requisitos para estabelecer um SGSI.",
        x: "SGSI inclui: política de segurança, análise de riscos, SoA (Declaração de Aplicabilidade), controles, treinamento, auditoria, melhoria contínua. É um SISTEMA de gestão, não um produto.",
      },
      {
        q: "A ISO 27001 é uma norma certificável?",
        o: [
          "Sim, organizações podem ser certificadas após auditoria por organismo acreditado",
          "Não, é apenas um guia de boas práticas",
          "Sim, mas apenas para profissionais individuais",
          "Não, apenas a ISO 27002 é certificável",
        ],
        c: 0,
        e: "ISO 27001 é certificável: um organismo de certificação acreditado audita o SGSI da organização. A certificação vale 3 anos, com auditorias de vigilância anuais. Já a ISO 27002 não é certificável.",
        x: "Processo: audit Estágio 1 (documentação) + Estágio 2 (implementação) → certificado (3 anos) → vigilância anual → recertificação. Organismos: BSI, DNV, Bureau Veritas, TÜV.",
      },
      {
        q: "O que é o Anexo A da ISO 27001?",
        o: [
          "Lista de controles de segurança recomendados que servem como referência para o SGSI",
          "Formulário de inscrição para certificação",
          "Glossário de termos técnicos de segurança",
          "Lista de auditorias realizadas",
        ],
        c: 0,
        e: "O Anexo A é a lista de controles de segurança da ISO 27001. Na versão 2022: 93 controles em 4 categorias. A organização seleciona quais são aplicáveis via análise de riscos e documenta na SoA.",
        x: "Categorias (2022): Organizacionais (37), Pessoais (8), Físicos (14), Tecnológicos (34) = 93 total. SoA: para cada controle, indicar aplicável/não aplicável com justificativa. ISO 27002 detalha cada um.",
      },
      {
        q: "O que são os três pilares da segurança da informação?",
        o: [
          "Confidencialidade, Integridade e Disponibilidade (CIA triad)",
          "Prevenção, Detecção e Recuperação",
          "Criptografia, Firewall e Antivírus",
          "Políticas, Normas e Procedimentos",
        ],
        c: 0,
        e: "CIA triad: Confidencialidade (só autorizados acessam), Integridade (dados não alterados indevidamente), Disponibilidade (acessível quando necessário). Base de toda segurança da informação e fundação da ISO 27001.",
        x: "Confidencialidade: criptografia, controle de acesso. Integridade: hash, assinatura digital, controle de versão. Disponibilidade: backup, redundancy, DRP. Hexagrama de Parkerian adiciona: autenticidade, posse, utilidade.",
      },
      {
        q: "O que é a família de normas ISO 27000?",
        o: [
          "Conjunto de normas internacionais que orientam a gestão de segurança da informação",
          "Apenas a ISO 27001 e ISO 27002",
          "Normas exclusivas para criptografia",
          "Certificações individuais de profissionais",
        ],
        c: 0,
        e: "A família ISO 27000 inclui dezenas de normas: 27000 (vocabulário), 27001 (requisitos SGSI), 27002 (controles), 27005 (riscos), 27017 (cloud), 27018 (PII), 27701 (privacidade), entre outras.",
        x: "Principais: 27001 (certificável), 27002 (implementação), 27005 (riscos), 27017/27018 (cloud), 27701 (privacidade/LGPD/GDPR), 27035 (resposta a incidentes), 27037 (forense digital).",
      },
    ],
    Médio: [
      {
        q: "Qual é a relação entre a ISO 27001 e a ISO 27002?",
        o: [
          "ISO 27001 define requisitos do SGSI; ISO 27002 detalha os controles de segurança recomendados",
          "São a mesma norma com nomes diferentes",
          "ISO 27002 substituiu a ISO 27001",
          "ISO 27001 é para empresas grandes e ISO 27002 para pequenas",
        ],
        c: 0,
        e: "ISO 27001: norma de requisitos — diz O QUE a organização deve fazer para implementar um SGSI (certificável). ISO 27002: código de práticas — detalha COMO implementar os controles listados no Anexo A da ISO 27001. A 27002 serve como guia de implementação dos controles referenciados pela 27001.",
        x: "ISO 27001 Anexo A lista os controles. ISO 27002 detalha cada um: objetivo, diretrizes de implementação, considerações. Versão 2022: 93 controles em 4 categorias (organizacionais, pessoais, físicos, tecnológicos) vs 114 controles em 14 domínios na versão anterior.",
      },
      {
        q: "O que é a Declaração de Aplicabilidade (SoA) na ISO 27001?",
        o: [
          "Documento que lista quais controles do Anexo A foram selecionados e justifica exclusões",
          "Formulário de candidatura para certificação",
          "Política de segurança da empresa",
          "Lista de funcionários com acesso ao SGSI",
        ],
        c: 0,
        e: "A SoA é documento obrigatório que lista todos os controles do Anexo A, indica quais foram selecionados, excluídos (com justificativa) e o status de implementação. Resumo dos controles aplicáveis.",
        x: "SoA: para cada um dos 93 controles (2022), indica aplicável/não aplicável, implementado/não, justificativa. Documento-chave na auditoria de certificação.",
      },
      {
        q: "O que é auditoria interna na ISO 27001 e qual sua frequência?",
        o: [
          "Avaliação periódica pela própria organização para verificar conformidade do SGSI; ao menos anual",
          "Auditoria feita pela ANPD",
          "Verificação de antivírus",
          "Teste de penetração externo",
        ],
        c: 0,
        e: "Cláusula 9.2 exige auditorias internas para verificar conformidade do SGSI. Conduzidas por auditores independentes da área auditada. Frequência mínima: anual (antes da análise crítica da direção).",
        x: "Verifica: políticas seguidas, controles eficazes, não-conformidades. Gera relatório → análise crítica da direção → ações corretivas. Base para auditoria de certificação externa.",
      },
      {
        q: "O que é o escopo do SGSI e como é definido?",
        o: [
          "Delimita quais áreas, processos e ativos são cobertos pelo SGSI; definido na cláusula 4.3",
          "Lista de todos os softwares da empresa",
          "Número de funcionários do departamento de TI",
          "Orçamento destinado à segurança",
        ],
        c: 0,
        e: "Cláusula 4.3: definir fronteiras e aplicabilidade do SGSI considerando questões internas/externas (4.1), partes interessadas (4.2) e interfaces/dependências. Pode ser toda a organização ou um departamento/sistema específico.",
        x: "Exemplo: 'SGSI cobre as operações do datacenter de SP e sistemas de e-commerce'. Escopo muito amplo = caro. Muito estreito = incompleto. Deve incluir interfaces com áreas fora do escopo.",
      },
      {
        q: "O que é a ISO 27005 e para que serve?",
        o: [
          "Norma com diretrizes para gestão de riscos de segurança da informação, complementando a ISO 27001",
          "Certificação de profissionais de segurança",
          "Norma de criptografia",
          "Guia de configuração de firewalls",
        ],
        c: 0,
        e: "ISO 27005 fornece diretrizes para o processo de gestão de riscos de SI exigido pela ISO 27001 (cláusula 6.1.2). Detalha: contexto, identificação, análise, avaliação, tratamento e aceitação de riscos. Não é certificável.",
        x: "Família 27000: 27001 (requisitos), 27002 (controles), 27005 (riscos), 27017 (cloud), 27018 (PII cloud), 27701 (privacidade). ISO 27005 + ISO 31000 = framework completo de riscos de SI.",
      },
      {
        q: "O que é a ISO 27701 e como se relaciona com a LGPD?",
        o: [
          "Extensão da ISO 27001 para gestão de privacidade; ajuda a demonstrar conformidade com LGPD e GDPR",
          "Subsótui a ISO 27001 para dados pessoais",
          "Certificação obrigatória da ANPD",
          "Norma exclusiva para criptografia de dados pessoais",
        ],
        c: 0,
        e: "ISO 27701 é extensão da ISO 27001/27002 que adiciona requisitos para Sistema de Gestão de Privacidade da Informação (PIMS). Mapeia para LGPD e GDPR, facilitando demonstração de conformidade. Certificável como extensão.",
        x: "ISO 27701: requer ISO 27001 como base. Adiciona controles para: controlador (PII controller) e operador (PII processor). Anexos mapeiam para GDPR (Anexo D) e ISO 29100 (princípios de privacidade).",
      },
      {
        q: "O que são não-conformidades em auditoria ISO 27001?",
        o: [
          "Desvios entre o que está documentado/requerido e o que é praticado; podem ser maiores ou menores",
          "Erros de criptografia nos sistemas",
          "Falhas de hardware nos servidores",
          "Bugs encontrados no software",
        ],
        c: 0,
        e: "Não-conformidade maior: falha sistêmica que compromete o SGSI (impede certificação até correção). Menor: desvio pontual que não compromete o sistema como um todo (correção até próxima audit). Oportunidade de melhoria: sugestão, não obrigatória.",
        x: "Maior: ausência de análise de riscos, política de segurança inexistente. Menor: um registro de treinamento faltando. Ação corretiva: causa raiz + ação + verificação de eficácia. ISO 19011: diretrizes de auditoria.",
      },
    ],
    Difícil: [
      {
        q: "Na ISO 27001:2022, como são organizados os controles do Anexo A?",
        o: [
          "4 categorias: organizacionais, pessoais, físicos e tecnológicos (93 controles)",
          "14 domínios com 114 controles",
          "10 capítulos com 50 controles",
          "7 categorias correspondendo ao modelo OSI",
        ],
        c: 0,
        e: "A versão 2022 reorganizou os controles do Anexo A em 4 categorias com 93 controles: Organizacionais (37), Pessoais (8), Físicos (14) e Tecnológicos (34). A versão anterior (2013) tinha 14 domínios com 114 controles. Foram adicionados 11 novos controles, como Threat Intelligence, Cloud Security e Data Masking.",
        x: "Novos controles na 2022: Threat Intelligence, ICT Readiness for Business Continuity, Information Security for Cloud Services, Physical Security Monitoring, Data Masking, Data Leakage Prevention, Web Filtering, Secure Coding, Configuration Management, Information Deletion, Monitoring Activities.",
      },
      {
        q: "O que é a análise crítica pela direção (management review) na ISO 27001?",
        o: [
          "Reunião periódica da alta direção para avaliar o desempenho do SGSI e tomar decisões",
          "Revisão técnica do código-fonte",
          "Auditoria externa anual",
          "Teste de recuperação de desastres",
        ],
        c: 0,
        e: "Cláusula 9.3: alta direção avalia resultados de auditorias, status de ações corretivas, mudanças, feedback e oportunidades de melhoria. Saídas: decisões sobre alterações no SGSI e alocação de recursos.",
        x: "Entradas: auditorias, incidentes, indicadores, feedback, mudanças de contexto. Saídas: melhorias, recursos, alterações no SGSI. Obrigatória periodicamente (ao menos anual).",
      },
      {
        q: "O que é o processo de avaliação de riscos na ISO 27001?",
        o: [
          "Identificação, análise (probabilidade × impacto) e priorização de riscos de SI; cláusula 6.1.2",
          "Apenas instalar antivírus e firewall",
          "Teste de penetração externo trimestral",
          "Verificação de SLAs com fornecedores",
        ],
        c: 0,
        e: "Cláusula 6.1.2: estabelecer critérios de risco, identificar riscos de SI, analisar (probabilidade × impacto), avaliar/priorizar, selecionar controles (Anexo A) e documentar no SoA e plano de tratamento.",
        x: "Ciclo: identificar ativos → ameaças/vulnerabilidades → probabilidade × impacto → comparar com critérios → tratar (evitar, mitigar, transferir, aceitar) → Risk Treatment Plan + SoA.",
      },
      {
        q: "O que é o processo de certificação ISO 27001 e quais são suas etapas?",
        o: [
          "Auditoria Estágio 1 (documentação) + Estágio 2 (implementação); certificado válido por 3 anos com vigilâncias anuais",
          "Exame online de múltipla escolha",
          "Apenas implementar os controles e declarar conformidade",
          "Auditoria única sem renovação",
        ],
        c: 0,
        e: "Estágio 1: auditoria documental (políticas, SoA, análise de riscos existem?). Estágio 2: auditoria de implementação (controles funcionam na prática?). Certificação: 3 anos, vigilância anual, recertificação no 3º ano.",
        x: "Cronograma típico: preparação (6-12 meses) → Estágio 1 → correções → Estágio 2 → certificado. Não-conformidades maiores: impedem certificação até correção. Menores: correção até próxima vigilância.",
      },
      {
        q: "Como a ISO 27001:2022 aborda segurança em nuvem (cloud)?",
        o: [
          "Novo controle A.5.23 (Information Security for Cloud Services) exige avaliação de riscos específica para cloud",
          "Proíbe uso de serviços em nuvem",
          "Apenas recomenda criptografia de dados",
          "Não aborda segurança em nuvem",
        ],
        c: 0,
        e: "ISO 27001:2022 incluiu controle A.5.23 específico para cloud: definir políticas de aquisição, uso, gestão e saída de serviços cloud. Complementado pela ISO 27017 (controles de segurança para cloud) e ISO 27018 (PII em cloud).",
        x: "A.5.23: responsabilidades compartilhadas (shared responsibility model), localização de dados, portabilidade, estratégia de exit. ISO 27017: 37 controles cloud + 7 novos. ISO 27018: proteção de dados pessoais em cloud.",
      },
      {
        q: "O que é a ISO 27017 e como complementa a ISO 27001 para cloud?",
        o: [
          "Norma com controles específicos para segurança em serviços de nuvem, estendendo a ISO 27002",
          "Substitui a ISO 27001 para provedores de cloud",
          "Certificação obrigatória para usar AWS",
          "Protocolo de comunicação entre nuvens",
        ],
        c: 0,
        e: "ISO 27017 fornece controles adicionais para provedores e clientes de cloud, estendendo a ISO 27002. Aborda: responsabilidades compartilhadas, virtualização, multitenancy, isolação e remoção de dados.",
        x: "37 controles adaptados da 27002 + 7 novos específicos para cloud. ISO 27018: proteção de PII em cloud pública. Certificável como extensão da 27001. AWS, Azure e GCP possuem certificação ISO 27017.",
      },
      {
        q: "O que é risk treatment plan na ISO 27001?",
        o: [
          "Documento que detalha ações para tratar cada risco identificado, incluindo controles, responsáveis e prazos",
          "Lista de todos os riscos aceitáveis",
          "Relatório de auditoria de riscos",
          "Software de gestão de riscos",
        ],
        c: 0,
        e: "O plano de tratamento de riscos documenta: cada risco identificado, estratégia de tratamento (evitar, mitigar, transferir, aceitar), controles selecionados do Anexo A, responsável, prazo e recursos. É requisito da cláusula 6.1.3.",
        x: "Fluxo: avaliação de riscos (6.1.2) → selecionar controles (Anexo A) → Risk Treatment Plan + SoA (6.1.3) → implementar → monitorar eficácia. O plano alimenta a SoA e é revisado periodicamente.",
      },
    ],
  },

  // ── Políticas de Segurança ──
  "Políticas de Segurança": {
    Fácil: [
      {
        q: "O que é uma Política de Segurança da Informação (PSI)?",
        o: [
          "Documento que define diretrizes, regras e responsabilidades de segurança da informação na organização",
          "Software de proteção contra vírus",
          "Hardware de criptografia de dados",
          "Certificação internacional de segurança",
        ],
        c: 0,
        e: "A PSI é o documento de mais alto nível que estabelece as diretrizes gerais de segurança da informação da organização: responsabilidades, classificação da informação, uso aceitável, controle de acesso, resposta a incidentes. Deve ser aprovada pela alta direção e comunicada a todos os colaboradores.",
        x: "Hierarquia: Política (O QUÊ — diretrizes gerais) → Normas (COMO — regras específicas) → Procedimentos (PASSO A PASSO — instruções detalhadas) → Guidelines (recomendações). Exemplo: 'Senhas devem ter no mínimo 12 caracteres' é uma norma derivada da política.",
      },
      {
        q: "O que é uma política de senha e quais são boas práticas?",
        o: [
          "Regras para criação e uso de senhas; boas práticas: mínimo 12 chars, complexidade e MFA",
          "Documento que lista todas as senhas",
          "Software que gera senhas",
          "Protocolo de criptografia de senhas",
        ],
        c: 0,
        e: "Política de senha define: comprimento mínimo (12+), complexidade, não reutilização e MFA obrigatório. NIST 800-63: senhas longas são mais importantes que complexidade forçada.",
        x: "NIST 800-63: tamanho > complexidade. Não forçar rotações periódicas (senhas fracas). Password manager recomendado. MFA é essencial.",
      },
      {
        q: "O que é classificação da informação e por que é importante?",
        o: [
          "Categorizar informações por sensibilidade para aplicar controles proporcionais",
          "Organizar arquivos em pastas",
          "Ordenar emails por data",
          "Criar índice de documentos",
        ],
        c: 0,
        e: "Classificação categoriza dados por nível: pública, interna, confidencial, secreta/restrita. Cada nível recebe controles proporcionais. Sem classificação, dados sensíveis podem ser tratados como públicos.",
        x: "Pública (site), Interna (políticas), Confidencial (financeiro), Restrita (planos estratégicos). Controles: restrita = criptografia + acesso limitado + DLP. ISO 27001 Anexo A controle 5.12.",
      },
      {
        q: "O que é uma AUP (Acceptable Use Policy — Política de Uso Aceitável)?",
        o: [
          "Política que define o uso aceitável dos recursos de TI pelos funcionários",
          "Tipo de licença de software",
          "Contrato de garantia de equipamentos",
          "Política de preços de produtos",
        ],
        c: 0,
        e: "AUP define o que é permitido e proibido no uso de computadores, e-mail, internet e dispositivos da empresa. Inclui: proibição de software pirata, uso pessoal limitado, proteção de dados. Funcionário assina ao ser contratado.",
        x: "Exemplos: não instalar software pirata, não acessar conteúdo impróprio, não compartilhar senhas, reportar incidentes. Violação pode resultar em sanções disciplinares. Base legal para ações da empresa.",
      },
      {
        q: "O que é conscientização em segurança da informação (security awareness)?",
        o: [
          "Treinamentos e campanhas para que todos conheçam os riscos e regras de segurança",
          "Instalação de antivírus em todos os computadores",
          "Auditoria externa anual",
          "Contratação de equipe de segurança",
        ],
        c: 0,
        e: "Security awareness educa funcionários sobre phishing, senhas, engenharia social, classificação de dados e políticas. Pessoas são o elo mais fraco: 90% dos ataques começam com phishing. Treinamento periódico é requisito da ISO 27001.",
        x: "Métodos: simulação de phishing, treinamentos online, gamificação, cartazes, newsletters. ISO 27001 cláusula 7.3: conscientização obrigatória. Ferramentas: KnowBe4, GoPhish. Meta: reduzir taxa de clique em phishing.",
      },
      {
        q: "O que é um plano de resposta a incidentes?",
        o: [
          "Documento que define passos a seguir quando ocorre um incidente de segurança da informação",
          "Relatório gerado após um ataque",
          "Software de monitoramento de rede",
          "Contrato com empresa de seguros",
        ],
        c: 0,
        e: "O plano de resposta a incidentes define: o que constitui um incidente, quem são os responsáveis, como classificar severidade, procedimentos de contenção, comunicação interna/externa e lições aprendidas.",
        x: "Fases: preparação → detecção → contenção → erradicação → recuperação → lições aprendidas. Sem plano: pânico, decisões erradas, tempo perdido. ISO 27035 e NIST SP 800-61 são referências.",
      },
      {
        q: "O que é backup e por que é importante para segurança?",
        o: [
          "Cópia de segurança dos dados que permite recuperação em caso de perda, ataque ou falha",
          "Software antivírus para servidores",
          "Tipo de firewall para banco de dados",
          "Processo de criptografia de disco",
        ],
        c: 0,
        e: "Backup é a última linha de defesa contra ransomware, falhas de hardware e erros humanos. Regra 3-2-1: 3 cópias, em 2 mídias diferentes, 1 offsite. Testar restauração periodicamente é tão importante quanto fazer backup.",
        x: "Tipos: completo (tudo), incremental (só alterações desde último backup), diferencial (alterações desde último completo). RPO define frequência. Air-gapped backup: desconectado da rede (proteção contra ransomware).",
      },
    ],
    Médio: [
      {
        q: "O que deve conter uma política de resposta a incidentes?",
        o: [
          "Definição de incidente, equipe responsável, procedimentos de detecção, contenção, erradicação e recuperação",
          "Lista de todos os vírus conhecidos",
          "Apenas telefones de emergência",
          "Somente procedimentos de backup",
        ],
        c: 0,
        e: "Uma política de resposta a incidentes define: classificação de incidentes, papéis e responsabilidades (CSIRT), procedimentos de detecção e notificação, fases de resposta (preparação, detecção, contenção, erradicação, recuperação, lições aprendidas), comunicação interna/externa e requisitos legais de notificação.",
        x: "Fases NIST (SP 800-61): 1) Preparation. 2) Detection & Analysis. 3) Containment, Eradication & Recovery. 4) Post-Incident Activity (lessons learned). A política deve ser testada periodicamente com exercícios de simulação (tabletop exercises).",
      },
      {
        q: "Qual a diferença entre política, norma e procedimento em segurança?",
        o: [
          "Política: diretrizes gerais. Norma: regras específicas. Procedimento: instruções passo a passo",
          "São termos sinônimos",
          "Política é técnica, norma é gerencial",
          "Procedimento é mais importante que política",
        ],
        c: 0,
        e: "Política (estratégico, 'o quê'): 'proteger dados sensíveis'. Norma (tático, 'como'): 'senhas mínimo 12 chars'. Procedimento (operacional): 'como trocar a senha no AD'. Guidelines são recomendações opcionais.",
        x: "Política: aprovada pela direção, abrangente. Norma: obrigatória, específica. Procedimento: detalhado, técnico. Exemplo: política diz 'controlar acesso', norma diz 'usar MFA', procedimento diz 'como configurar MFA'.",
      },
      {
        q: "O que é um BCP (Business Continuity Plan) e como se relaciona com DRP?",
        o: [
          "BCP garante operação durante crises; DRP foca na recuperação da TI após desastre",
          "São sinônimos",
          "BCP é para pequenas empresas e DRP para grandes",
          "DRP substitui o BCP",
        ],
        c: 0,
        e: "BCP (Business Continuity): plano abrangente para manter operações críticas. DRP (Disaster Recovery): subconjunto focado em recuperar infraestrutura de TI. BCP é mais amplo (pessoas, processos). DRP é mais técnico.",
        x: "BCP: comunicação de crise, trabalho remoto, local alternativo. DRP: backup/restore, site de contingência (hot/warm/cold), failover. RTO e RPO definidos pela BIA guiam o DRP.",
      },
      {
        q: "O que é um CSIRT (Computer Security Incident Response Team)?",
        o: [
          "Equipe responsável por coordenar a resposta a incidentes de segurança da informação",
          "Software de detecção de intrusão",
          "Certificação de profissionais de segurança",
          "Tipo de firewall corporativo",
        ],
        c: 0,
        e: "CSIRT/CERT é a equipe que recebe, analisa e responde a incidentes de segurança. Funções: triagem, análise forense, contenção, coordenação com áreas afetadas e comunicação. Pode ser interno ou externo.",
        x: "CERT.br (Brasil), US-CERT (EUA), FIRST (comunidade global). Atividades: monitoramento, resposta, forense, inteligência de ameaças. Níveis: L1 (triagem), L2 (análise), L3 (forense/malware). SOC opera 24/7, CSIRT responde.",
      },
      {
        q: "O que são exercícios tabletop em segurança da informação?",
        o: [
          "Simulações de cenários de incidentes onde a equipe debate decisões sem ações reais",
          "Jogos de tabuleiro sobre segurança",
          "Reuniões de planejamento de orçamento",
          "Testes de penetração em sistemas",
        ],
        c: 0,
        e: "Tabletop exercise: simulação baseada em discussão de um cenário de incidente (ex: ransomware). A equipe debate: quem faz o quê, como comunicar, que decisões tomar. Identifica falhas no plano sem risco real.",
        x: "Níveis: tabletop (discussão) < functional exercise (simulação parcial) < full-scale exercise (simulação completa). NIST SP 800-84: guia para testes de planos. Frequência recomendada: ao menos anual.",
      },
      {
        q: "O que é gestão de patches (patch management)?",
        o: [
          "Processo de identificar, testar e aplicar atualizações de segurança em sistemas e software",
          "Técnica de criptografia de atualizações",
          "Software de monitoramento de vulneráveis",
          "Política de troca de hardware",
        ],
        c: 0,
        e: "Patch management: identificar patches disponíveis → avaliar criticidade (CVSS) → testar em ambiente de homologação → aplicar em produção → verificar. Patches críticos devem ser aplicados rapidamente (ex: 48h).",
        x: "Sem patching: WannaCry explorou MS17-010 (patch disponível 2 meses antes). Ferramentas: WSUS, SCCM (Microsoft), Ansible, Chef. Vulnerabilidades críticas (CVSS 9+): patch urgente. Média: ciclo regular (mensal).",
      },
      {
        q: "O que é segregação de ambientes em TI?",
        o: [
          "Separar ambientes de desenvolvimento, teste e produção para evitar impactos de mudanças não testadas",
          "Dividir funcionários por andares diferentes",
          "Separar redes Wi-Fi por SSID",
          "Usar servidores de marcas diferentes",
        ],
        c: 0,
        e: "Segregação de ambientes (dev → staging → produção): código é desenvolvido em dev, testado em staging e só vai para produção após validação. Evita que erros afetem usuários reais. Dados de produção não devem estar em dev.",
        x: "Princípios: dados de produção mascarados em dev/staging, acessos separados por ambiente, pipeline CI/CD controla promoção entre ambientes. ISO 27001 A.8.31: separação de ambientes.",
      },
    ],
    Difícil: [
      {
        q: "Qual norma do NIST fornece diretrizes para desenvolvimento de políticas de segurança e qual é seu principal framework?",
        o: [
          "NIST CSF (Cybersecurity Framework) com funções: Identify, Protect, Detect, Respond, Recover",
          "NIST SP 800-53 com categorias: Plan, Do, Check, Act",
          "ISO 9001 com foco em qualidade de segurança",
          "NIST 800-12 com foco exclusivo em criptografia",
        ],
        c: 0,
        e: "O NIST CSF (Cybersecurity Framework) organiza segurança em 5 funções: Identify (inventário, riscos), Protect (controles preventivos), Detect (monitoramento), Respond (resposta a incidentes), Recover (recuperação). O NIST SP 800-53 complementa com catálogo detalhado de controles. CSF 2.0 (2024) adicionou 'Govern' como 6ª função.",
        x: "CSF v1.1: Identify, Protect, Detect, Respond, Recover. CSF v2.0 (2024): + Govern (governança). SP 800-53: catálogo de controles detalhados. SP 800-171: proteção de CUI. O CSF mapeia para ISO 27001, CIS Controls e outros frameworks.",
      },
      {
        q: "O que são os CIS Controls e como complementam a ISO 27001?",
        o: [
          "Lista priorizada de ações de segurança do CIS; complementam ISO 27001 com implementação prática",
          "Controles exclusivos para indústria financeira",
          "Substituição da ISO 27001 nos EUA",
          "Framework de gestão de projetos",
        ],
        c: 0,
        e: "CIS Controls são 18 controles priorizados em Implementation Groups (IG1, IG2, IG3) por maturidade. Mais prescritivos e técnicos que a ISO 27001, facilitando implementação prática.",
        x: "IG1 (essencial): inventário, controle de software, configuração segura, acesso, proteção de dados. IG2: logging, proteção email/web. IG3: pentest avançado. CIS Benchmarks: configurações seguras para SO, servidores.",
      },
      {
        q: "O que é 'security by design' e como se aplica no desenvolvimento?",
        o: [
          "Integrar segurança desde o início do design de sistemas, não como adição posterior",
          "Instalar firewall após incidente",
          "Design gráfico de dashboards de segurança",
          "Criar senhas visualmente complexas",
        ],
        c: 0,
        e: "Security by design: segurança como requisito desde a concepção, não adição posterior. SDLC seguro: threat modeling, code review, SAST/DAST. OWASP Top 10 2021: #4 é Insecure Design.",
        x: "DevSecOps: segurança integrada ao CI/CD. Privacy by design (LGPD/GDPR). NIST CSF v2.0: função 'Govern' enfatiza segurança integrada à governança desde o início.",
      },
      {
        q: "O que é o modelo Zero Trust e seus princípios fundamentais?",
        o: [
          "Nenhuma entidade é confiável por padrão; verificar explicitamente, menor privilégio, assumir violação",
          "Confiar em todos os dispositivos da rede interna",
          "Modelo de confiança baseado apenas em firewalls",
          "Framework de auditoria para nuvem",
        ],
        c: 0,
        e: "Zero Trust: 'never trust, always verify'. Princípios: verificar explicitamente (identidade, dispositivo, localização), menor privilégio (JIT/JEA), assumir breach (segmentação, monitoramento). Perímetro não é mais suficiente.",
        x: "NIST SP 800-207: arquitetura Zero Trust. Pilares: identidade, dispositivos, rede, aplicações, dados. Implementação: MFA, microsegmentação, ZTNA (Zero Trust Network Access), EDR, SASE. Google BeyondCorp: referência.",
      },
      {
        q: "O que é o MITRE ATT&CK e como é usado na prática?",
        o: [
          "Framework de táticas e técnicas de adversários usado para threat hunting, detecção e avaliação",
          "Software de detecção de malware",
          "Certificação de segurança ofensiva",
          "Protocolo de comunicação segura",
        ],
        c: 0,
        e: "MITRE ATT&CK cataloga táticas (objetivos: Initial Access, Execution, Persistence...) e técnicas (como: Phishing, PowerShell, Registry Run Keys). Usado para mapear detecções, avaliar cobertura e threat hunting.",
        x: "14 táticas: Recon → Resource Dev → Initial Access → Execution → Persistence → Priv Esc → Defense Evasion → Credential Access → Discovery → Lateral Move → Collection → C2 → Exfiltration → Impact.",
      },
      {
        q: "O que é threat intelligence e como se aplica na defesa?",
        o: [
          "Informações sobre ameaças (TTPs, IoCs) usadas para antecipar e detectar ataques",
          "Software de inteligência artificial para segurança",
          "Relatório anual de vulnerabilidades",
          "Treinamento de funcionários sobre riscos",
        ],
        c: 0,
        e: "Threat intelligence coleta, analisa e compartilha informações sobre ameaças: TTPs (táticas, técnicas, procedimentos), IoCs (indicadores de comprometimento: IPs, hashes, domínios). Alimenta SIEM, SOC e decisões estratégicas.",
        x: "Níveis: estratégico (tendências para C-level), tático (TTPs para SOC), operacional (IoCs para SIEM/firewall). Fontes: MITRE ATT&CK, VirusTotal, OTX, OSINT. STIX/TAXII: padrões de compartilhamento.",
      },
      {
        q: "O que é purple teaming em segurança?",
        o: [
          "Colaboração entre red team (ataque) e blue team (defesa) para melhorar detecção e resposta",
          "Equipe exclusiva de forense digital",
          "Time de desenvolvimento seguro",
          "Grupo de compliance e auditoria",
        ],
        c: 0,
        e: "Purple team: red team ataca e compartilha TTPs em tempo real com blue team, que ajusta detecções e respostas. Ciclo: atacar → detectou? → não → criar regra → atacar novamente → detectou? → sim → próxima técnica.",
        x: "Red team: simula atacante (pentest, social engineering). Blue team: defende (SOC, SIEM, EDR). Purple team: colaboração. Resultado: cobertura de detecção mapeada no MITRE ATT&CK. Ferramentas: Atomic Red Team, Caldera.",
      },
    ],
  },

  // ── Segurança em Aplicações Web ──
  "Segurança em Aplicações Web": {
    Fácil: [
      {
        q: "O que é o OWASP Top 10?",
        o: [
          "Lista das 10 vulnerabilidades mais críticas em aplicações web",
          "Os 10 melhores antivírus do mercado",
          "Os 10 navegadores web mais seguros",
          "Lista dos 10 firewalls mais vendidos",
        ],
        c: 0,
        e: "O OWASP Top 10 é um documento de conscientização publicado pela OWASP (Open Web Application Security Project) que lista as 10 vulnerabilidades mais críticas em aplicações web. É atualizado periodicamente e serve como referência para desenvolvedores e profissionais de segurança.",
        x: "OWASP Top 10 (2021): 1) Broken Access Control. 2) Cryptographic Failures. 3) Injection. 4) Insecure Design. 5) Security Misconfiguration. 6) Vulnerable Components. 7) Auth Failures. 8) Data Integrity Failures. 9) Logging Failures. 10) SSRF.",
      },
      {
        q: "O que é XSS (Cross-Site Scripting)?",
        o: [
          "Injeção de scripts maliciosos em páginas web visualizadas por outros usuários",
          "Técnica de criptografia entre sites",
          "Protocolo de comunicação segura",
          "Método de autenticação cross-site",
        ],
        c: 0,
        e: "XSS injeta JavaScript em páginas web. O script executa no navegador da vítima, podendo roubar cookies, sessões ou redirecionar. Prevenção: sanitizar outputs, Content Security Policy (CSP), HttpOnly cookies.",
        x: "Tipos: Reflected (parâmetro na URL), Stored (salvo no banco), DOM-based (manipulação do DOM). Prevenção: escape de HTML, CSP headers, HttpOnly cookies.",
      },
      {
        q: "O que é um WAF (Web Application Firewall)?",
        o: [
          "Firewall especializado que protege aplicações web filtrando tráfego HTTP/HTTPS",
          "Firewall para redes locais",
          "Antivírus para servidores web",
          "Software de backup para websites",
        ],
        c: 0,
        e: "WAF protege contra SQL injection, XSS, SSRF e DDoS L7. Opera na camada de aplicação analisando requisições HTTP/HTTPS. Pode ser hardware, software ou cloud (Cloudflare, AWS WAF).",
        x: "Firewall de rede: L3/L4 (IP/porta). WAF: L7 (conteúdo HTTP). Modos: block ou detect. OWASP CRS (Core Rule Set). Cloud WAFs: Cloudflare, AWS WAF, Azure Front Door.",
      },
      {
        q: "O que é HTTPS e por que é importante para segurança?",
        o: [
          "Versão segura do HTTP usando TLS para criptografar comunicação entre navegador e servidor",
          "Protocolo exclusivo para e-commerce",
          "Tipo de antivírus online",
          "Software de firewall para navegadores",
        ],
        c: 0,
        e: "HTTPS = HTTP + TLS. Criptografa dados em trânsito impedindo interceptação (MitM). O cadeado no navegador indica conexaço TLS válida. Google penaliza sites HTTP no ranking de busca.",
        x: "TLS 1.3: padrão atual (mais rápido, mais seguro). Certificado: Let's Encrypt (gratuito), DigiCert (pago). HSTS: força HTTPS. Mixed content: página HTTPS com recursos HTTP → aviso de segurança.",
      },
      {
        q: "O que é sanitização de entrada (input validation) em aplicações web?",
        o: [
          "Processo de limpar e validar dados enviados pelo usuário antes de processá-los",
          "Limpeza física dos teclados",
          "Formatação visual dos formulários",
          "Compressão de dados antes de enviar",
        ],
        c: 0,
        e: "Input validation verifica e limpa dados do usuário: tipo (número, texto), formato (email, CPF), tamanho, caracteres especiais. Previne SQLi, XSS e outras injeções. Regra: NUNCA confiar no input do usuário.",
        x: "Whitelist (aceitar só o esperado) > Blacklist (bloquear o malicioso). Server-side obrigatório (client-side é bypassável). Encoding de saída: HTML encode, URL encode. Frameworks modernos: validação automática (Zod, Joi).",
      },
      {
        q: "O que é uma vulnerabilidade de autenticação fraca em aplicações web?",
        o: [
          "Falha que permite acesso não autorizado por senhas fracas, falta de MFA ou gestão inadequada de sessões",
          "Bug visual na página de login",
          "Lentidão no carregamento do formulário",
          "Erro de layout no navegador",
        ],
        c: 0,
        e: "Autenticação fraca inclui: senhas fracas sem política, ausência de MFA, sessões que não expiram, tokens previsíveis, credential stuffing sem proteção. OWASP 2021 #7: Identification and Authentication Failures.",
        x: "Ataques: brute force, credential stuffing (senhas vazadas), session fixation. Defesa: MFA, rate limiting, bcrypt/Argon2, sessões com expiração curta, CAPTCHA após falhas.",
      },
      {
        q: "O que é clickjacking?",
        o: [
          "Ataque que usa iframes transparentes para enganar o usuário a clicar em elementos ocultos de outro site",
          "Técnica de otimização de cliques em anúncios",
          "Software de automação de cliques",
          "Método de teste de usabilidade",
        ],
        c: 0,
        e: "Clickjacking (UI redressing): atacante coloca iframe transparente do site alvo sobre sua página. Usuário pensa que clica em algo inofensivo, mas clica no site alvo (curtir, transferir, autorizar). Prevenção: X-Frame-Options, CSP frame-ancestors.",
        x: "X-Frame-Options: DENY (bloqueia iframe) ou SAMEORIGIN. CSP: frame-ancestors 'none'. Likejacking: variante no Facebook. Defesa moderna: CSP frame-ancestors 'self' é preferível a X-Frame-Options.",
      },
    ],
    Médio: [
      {
        q: "O que é SQL Injection e como preveni-la?",
        o: [
          "Injeção de código SQL malicioso via inputs; previne-se com prepared statements/parameterized queries",
          "Um tipo de criptografia para bancos de dados",
          "Técnica de otimização de queries SQL",
          "Backup automático de banco de dados",
        ],
        c: 0,
        e: "SQL Injection ocorre quando inputs do usuário são inseridos diretamente em queries SQL sem sanitização, permitindo ao atacante executar comandos SQL arbitrários. Prevenção: prepared statements (parameterized queries), ORMs, validação/sanitização de inputs, princípio do menor privilégio no banco de dados.",
        x: "Vulnerável: `SELECT * FROM users WHERE name = '\" + input + \"'`. Input: `' OR '1'='1` → retorna todos os usuários. Seguro: `SELECT * FROM users WHERE name = ?` com parâmetro vinculado. ORMs modernos (Prisma, Sequelize) usam parameterized queries por padrão.",
      },
      {
        q: "O que é CSRF (Cross-Site Request Forgery) e como prevenir?",
        o: [
          "Ataque que força o navegador a enviar requisição para site onde a vítima está autenticada; prevenção: tokens CSRF",
          "Falsificação de certificados SSL",
          "Técnica de criptografia entre sites",
          "Método de autenticação forte",
        ],
        c: 0,
        e: "CSRF: atacante engana vítima (já autenticada) a executar ação involuntária no site alvo. Prevenção: tokens CSRF (valor único por formulário), SameSite cookies, verificar Origin/Referer header.",
        x: "Exemplo: <img src='banco.com/transferir?para=atacante&valor=1000'> → navegador envia com cookies de sessão. CSRF token: campo hidden verificado pelo servidor. SameSite=Strict impede o envio de cookies cross-site.",
      },
      {
        q: "O que é Content Security Policy (CSP) e como protege contra XSS?",
        o: [
          "Header HTTP que define quais fontes de conteúdo o navegador pode executar",
          "Política de criptografia de conteúdo",
          "Tipo de firewall para CDN",
          "Protocolo de cache de navegador",
        ],
        c: 0,
        e: "CSP é um header HTTP que instrui o navegador sobre quais fontes de scripts, estilos e imagens são permitidas. Bloqueia scripts inline e fontes não autorizadas, sendo defesa eficaz contra XSS.",
        x: "Exemplo: Content-Security-Policy: script-src 'self' https://cdn.ex.com. Bloqueia: <script>alert('XSS')</script>. Report-only mode: monitorar sem bloquear. CSP + HttpOnly = proteção robusta.",
      },
      {
        q: "O que é SAST e DAST e qual a diferença?",
        o: [
          "SAST analisa código-fonte (white box); DAST testa aplicação em execução (black box)",
          "São dois tipos de firewall",
          "São protocolos de criptografia",
          "São certificações de segurança",
        ],
        c: 0,
        e: "SAST (Static): analisa código-fonte sem executar; detecta vulnerabilidades cedo no desenvolvimento. DAST (Dynamic): testa aplicação rodando, simulando ataques reais. IAST combina ambos.",
        x: "SAST: SonarQube, Semgrep, Checkmarx. DAST: OWASP ZAP, Burp Suite. SCA (Software Composition Analysis): Snyk, Dependabot. Pipeline DevSecOps ideal: SAST + SCA no código + DAST no staging.",
      },
      {
        q: "Quais são os principais cabeçalhos de segurança HTTP?",
        o: [
          "CSP, HSTS, X-Frame-Options, X-Content-Type-Options e Referrer-Policy",
          "Accept, Content-Type e Authorization apenas",
          "Cache-Control e ETag",
          "User-Agent e Cookie",
        ],
        c: 0,
        e: "Headers de segurança: CSP (fontes permitidas), HSTS (força HTTPS), X-Frame-Options (anti-clickjacking), X-Content-Type-Options (nosniff), Referrer-Policy (controla referência), Permissions-Policy (APIs do navegador).",
        x: "HSTS: Strict-Transport-Security: max-age=31536000; includeSubDomains; preload. X-Frame-Options: DENY (bloqueia iframe = anti-clickjacking). securityheaders.com: verifica headers de qualquer site.",
      },
      {
        q: "O que é JWT (JSON Web Token) e quais riscos de segurança envolve?",
        o: [
          "Token para autenticação/autorização em formato JSON; riscos incluem algoritmo 'none' e segredos fracos",
          "Tipo de criptografia para bancos de dados",
          "Protocolo de comunicação entre servidores",
          "Formato de backup de dados",
        ],
        c: 0,
        e: "JWT (header.payload.signature) é usado para autenticação stateless. Riscos: algoritmo 'none' (bypass de verificação), segredos fracos (força bruta), falta de expiração, armazenamento inseguro (localStorage → XSS).",
        x: "Ataques: alg:none, key confusion (RS256→HS256), JWK injection, token sem exp. Defesa: validar alg no servidor, segredo forte (256+ bits), exp curto + refresh token, armazenar em httpOnly cookie.",
      },
      {
        q: "O que é CORS (Cross-Origin Resource Sharing) e como afeta a segurança?",
        o: [
          "Mecanismo que controla quais domínios podem acessar APIs; configuração incorreta pode expor dados",
          "Protocolo de criptografia entre servidores",
          "Tipo de firewall para APIs",
          "Método de compressão de requisições",
        ],
        c: 0,
        e: "CORS controla quais origens podem fazer requisições cross-origin. Headers: Access-Control-Allow-Origin, Allow-Methods, Allow-Headers. Configuração errônea (`*` com credentials) expoe APIs a ataques cross-site.",
        x: "Erro comum: Access-Control-Allow-Origin: * com Allow-Credentials: true (navegador bloqueia). Risco: refletir Origin sem validação. Seguro: whitelist explícita de origens. Preflight: OPTIONS verifica permissões antes.",
      },
    ],
    Difícil: [
      {
        q: "O que é um ataque SSRF (Server-Side Request Forgery) e por que é particularmente perigoso em ambientes cloud?",
        o: [
          "O atacante faz o servidor realizar requisições para recursos internos, podendo acessar metadados de cloud e credenciais",
          "Falsificação de certificados SSL do servidor",
          "Envio de spam pelo servidor da vítima",
          "Sobrecarga do servidor com requisições falsas",
        ],
        c: 0,
        e: "SSRF explora funcionalidades do servidor que fazem requisições HTTP para URLs fornecidas pelo usuário. O atacante direciona essas requisições para recursos internos (localhost, rede interna, metadata services). Em cloud, o ataque ao endpoint de metadados (169.254.169.254) pode expor credenciais IAM, tokens de acesso e configurações sensíveis.",
        x: "Exemplo AWS: input = `http://169.254.169.254/latest/meta-data/iam/security-credentials/role-name` → retorna Access Key, Secret Key e Token. Proteção: whitelist de URLs, bloqueio de IPs internos, IMDSv2 (requer token), WAF com regras SSRF.",
      },
      {
        q: "O que é IDOR (Insecure Direct Object Reference) e como prevenir?",
        o: [
          "Acesso direto a objetos sem verificação de autorização; prevenção: verificar permissão a cada acesso",
          "Referência indireta a objetos internos",
          "Tipo de injeção em bancos de dados",
          "Falha de criptografia em URLs",
        ],
        c: 0,
        e: "IDOR: atacante manipula IDs em URLs para acessar dados de outros usuários. Exemplo: mudar /api/users/123 para /api/users/456. Prevenção: sempre verificar autorização do usuário logado antes de retornar dados.",
        x: "GET /invoices/1001 → minha fatura. /invoices/1002 → fatura de outro! Prevenção: verificar owner_id == user_id. UUIDs dificultam mas não substituem verificação de autorização.",
      },
      {
        q: "O que é DevSecOps e como integra segurança no desenvolvimento?",
        o: [
          "Integrar segurança em todo o pipeline CI/CD, desde o código até produção",
          "Equipe de segurança separada que audita após deploy",
          "Framework de gestão ágil",
          "Ferramenta de deploy automatizado",
        ],
        c: 0,
        e: "DevSecOps integra segurança em todo o pipeline: planejamento (threat modeling), código (SAST), build (SCA), teste (DAST), deploy (container scanning), operação (monitoramento). 'Shift left': segurança o mais cedo possível.",
        x: "Pipeline: código → SAST (estática) → SCA (dependências) → build → DAST (dinâmica) → container scan → deploy → monitoring. Ferramentas: SonarQube, Snyk, OWASP ZAP, Trivy.",
      },
      {
        q: "O que é desserialização insegura e como pode ser explorada?",
        o: [
          "Manipulação de objetos serializados para executar código remoto no servidor",
          "Erro ao converter dados JSON",
          "Falha na compressão de arquivos",
          "Bug em conversão de tipos numéricos",
        ],
        c: 0,
        e: "Desserialização insegura: aplicativo aceita objetos serializados sem validação. Atacante modifica o objeto para executar código arbitrário (RCE). Comum em Java (ObjectInputStream), PHP (unserialize), Python (pickle).",
        x: "Java: gadget chains (ysoserial) exploram desserialização para RCE. Prevenção: não aceitar objetos serializados de fontes não confiáveis, usar JSON/XML, assinar objetos. OWASP 2017 #8.",
      },
      {
        q: "O que são ataques de injeção de template (SSTI) em aplicações web?",
        o: [
          "Injeção de código em templates server-side que permite execução remota de código",
          "Ataque contra templates de email",
          "Modificação de templates CSS",
          "Injeção em templates de banco de dados",
        ],
        c: 0,
        e: "SSTI (Server-Side Template Injection): atacante injeta expressões no template engine (Jinja2, Twig, FreeMarker). Se o input é renderizado como template, pode executar código no servidor (RCE).",
        x: "Teste: {{7*7}} retorna 49 = vulnerável. Jinja2 (Python): {{config.items()}} vaza configuração. Escalação: __class__.__mro__[1].__subclasses__() para RCE. Prevenção: sandbox do template, não usar input no template.",
      },
      {
        q: "O que é prototype pollution em JavaScript e como pode ser explorado?",
        o: [
          "Modificação do prototype de objetos base que afeta todos os objetos derivados, podendo levar a RCE",
          "Poluição de variáveis de ambiente",
          "Exaustão de memória do navegador",
          "Conflito de versões de bibliotecas",
        ],
        c: 0,
        e: "Prototype pollution: atacante modifica Object.prototype adicionando propriedades que propagam para todos os objetos. Pode causar: bypass de autenticação (isAdmin=true), RCE (via child_process em Node.js), XSS.",
        x: "Vetor: merge/clone profundo de objetos com '__proto__' ou 'constructor.prototype'. Exemplo: {\"__proto__\": {\"isAdmin\": true}}. Defesa: Object.create(null), Map em vez de {}, validar chaves, Object.freeze(Object.prototype).",
      },
      {
        q: "O que é race condition em aplicações web e como pode ser explorada?",
        o: [
          "Falha de concorrência que permite explorar o intervalo entre verificação e uso para resultados não autorizados",
          "Competição entre navegadores por recursos",
          "Conflito de DNS entre servidores",
          "Corrida de cache entre CDNs",
        ],
        c: 0,
        e: "Race condition (TOCTOU — Time of Check to Time of Use): atacante envia requisições simultâneas para explorar o intervalo entre verificação e ação. Exemplo: usar cupom de desconto múltiplas vezes, sacar mais que o saldo.",
        x: "Exemplo: saldo = R$100, atacante envia 10 saques de R$100 simultaneamente → todos passam na verificação antes do débito. Defesa: locks otimistas/pessimistas, transações atômicas, idempotency keys. Ferramenta: Turbo Intruder (Burp).",
      },
    ],
  },
};

// ─── Round 1 · +1 questão por nível por categoria ───

const segurancaRound1Extras: Record<string, Record<UserLevel, SeedCard[]>> = {
  "Certificados Digitais e PKI": {
    Fácil: [
      {
        q: "O que é uma CA (Certificate Authority) e qual seu papel na PKI?",
        o: [
          "CA é a entidade que emite, assina e revoga certificados digitais X.509; sua chave privada garante a cadeia de confiança da PKI",
          "CA é o servidor que armazena as chaves privadas dos usuários",
          "CA é um protocolo de troca de chaves como TLS",
          "CA é sinônimo de servidor LDAP usado para autenticação",
        ],
        c: 0,
        e: "PKI (Public Key Infrastructure): hierarquia de CAs. Root CA: autoassinada, offline (air-gap). Intermediate CA: emite certificados de entidade final. Certificado X.509: Subject, Issuer, Serial, Validity, Public Key, Extensions (SAN, EKU), Signature. Chain of trust: navegador valida até Root CA no trust store.",
        x: "Root CA offline: chave privada nunca exposta à rede. Intermediate CA online: HSM protege chave. CRL (Certificate Revocation List): lista de certificados revogados. OCSP: verificação online em tempo real. Certificate Transparency (CT logs): lista pública de certificados emitidos. Let's Encrypt: CA pública gratuita com ACME protocol.",
      },
    ],
    Médio: [
      {
        q: "O que é Certificate Pinning e quais os riscos e benefícios dessa prática?",
        o: [
          "Certificate Pinning: app embute o hash/cert do servidor esperado; impede MITM com CA comprometida ou SSL inspection; risco: app quebra ao renovar certificado sem atualizar o pin",
          "Certificate Pinning é uma técnica de compressão de certificados TLS",
          "Pinning substitui completamente o trust store do sistema operacional",
          "Certificate Pinning é obrigatório pelo RFC TLS 1.3",
        ],
        c: 0,
        e: "Pin: hash SHA-256 da chave pública (SPKI) ou do certificado. Mobile apps: Android/iOS hardcodam o pin no APK/IPA. Proteção: mesmo com CA corporativa instalada via MDM, o pin rejeita o certificado falso. Risco: se o certificado for renovado com nova chave, app falha conexão até atualização. Backup pins: incluir 2 pins (ativo + backup).",
        x: "HTTP Public Key Pinning (HPKI): header HTTP (deprecated). Static pinning: hash no código. Dynamic pinning: pin atualizado via API segura. Contornar pinning: Frida, Objection (hook SSL functions). Defesa adicional: certificate transparency monitoring (certspotter). Google removeu HPKP do Chrome em 2018 por risco de lock-out.",
      },
    ],
    Difícil: [
      {
        q: "Como funciona o protocolo OCSP Stapling e como ele melhora desempenho e privacidade sobre OCSP clássico?",
        o: [
          "OCSP Stapling: servidor web faz a consulta OCSP antecipadamente e inclui a resposta assinada no handshake TLS; cliente não precisa contactar CA; melhora latência e privacidade",
          "OCSP Stapling remove completamente a necessidade de verificação de revogação",
          "OCSP Stapling é consultado pelo cliente diretamente na CA a cada segundo",
          "OCSP substitui CRL; Stapling é apenas um alias para OCSP clássico",
        ],
        c: 0,
        e: "OCSP clássico: cliente consulta CA a cada handshake TLS (latência extra, privacy leak: CA sabe quem acessa qual site). OCSP Stapling (RFC 6066): servidor consulta CA periodicamente (ex: 1h), cacheia resposta assinada pela CA, inclui no TLS handshake via Certificate Status Request extension. Must-staple (RFC 7633): extensão X.509 que exige OCSP stapling.",
        x: "Nginx: 'ssl_stapling on; ssl_stapling_verify on; resolver 8.8.8.8'. Apache: 'SSLUseStapling on'. Diagnóstico: 'openssl s_client -connect host:443 -status | grep OCSP'. OCSP response lifetime: 24h típico. Hard-fail vs soft-fail: hard-fail recusa conexão se OCSP indisponível (seguro mas arriscado); soft-fail aceita (Chrome default). CRL Distribution Points: fallback clássico.",
      },
    ],
  },
  Criptografia: {
    Fácil: [
      {
        q: "Qual a diferença entre criptografia simétrica e assimétrica?",
        o: [
          "Simétrica: mesma chave para cifrar e decifrar (AES, velocidade alta); assimétrica: par de chaves pública/privada (RSA/ECC, mais lenta, usada para troca de chaves e assinatura)",
          "Simétrica usa chave pública; assimétrica usa chave secreta compartilhada",
          "São equivalentes; a denominação varia por fabricante",
          "Assimétrica é mais rápida; usada para criptografar grandes volumes de dados",
        ],
        c: 0,
        e: "Simétrica: AES-256 (block cipher), ChaCha20 (stream cipher). Velocidade: GB/s em hardware. Problema: distribuição segura da chave. Assimétrica: RSA-2048+ (fatoração de primos), ECC (curvas elípticas: menor chave, mesma segurança). Velocidade: kB/s (~1000× mais lenta). Uso: assimétrica troca chave simétrica de sessão (híbrido: TLS, PGP).",
        x: "TLS 1.3: ECDHE para troca de chave (forward secrecy), AES-GCM ou ChaCha20-Poly1305 para dados. PGP: RSA/ECC assimétrica + AES simétrica para corpo. Hash: SHA-256 (não é criptografia, apenas hash). HMAC: integridade com chave simétrica. KDF (Key Derivation Function): PBKDF2, bcrypt, scrypt, Argon2 para derivar chaves de senhas.",
      },
    ],
    Médio: [
      {
        q: "O que é AES-GCM e por que é preferido ao AES-CBC com HMAC em protocolos modernos?",
        o: [
          "AES-GCM: AEAD (cifra + autenticação integrada, GCM usa contador+Galois Field); AES-CBC+HMAC: cifra e MAC separados, vulnerável a padding oracle se implementado incorretamente",
          "AES-GCM é mais lento que AES-CBC; preferido somente por compatibilidade",
          "AES-CBC é AEAD; GCM não oferece autenticação",
          "Ambos são equivalentes em segurança; GCM é apenas mais simples de configurar",
        ],
        c: 0,
        e: "AES-GCM (Galois/Counter Mode): modo AEAD (Authenticated Encryption with Associated Data). Em uma operação: cifra (CTR mode) + autenticação (GHASH). IV (nonce) de 96 bits: NUNCA reutilizar com a mesma chave (nonce reuse = catástrofe: chave XOR-able). AES-CBC: não autentica; requer HMAC separado. Padding oracle: CBC vulnerável a ataques de padding (POODLE, Lucky13).",
        x: "TLS 1.3 remove CBC; somente AEAD (AES-GCM, AES-CCM, ChaCha20-Poly1305). OpenSSL: 'EVP_aes_256_gcm()'. Nonce randomness: 96-bit nonce aleatório para cada mensagem. AES-GCM hardware: AES-NI (Intel/AMD) + PCLMULQDQ para GHASH → throughput 40+ Gbps. CCM: alternativa AEAD para IoT (menor estado).",
      },
    ],
    Difícil: [
      {
        q: "O que é criptografia pós-quântica (PQC) e quais algoritmos foram padronizados pelo NIST em 2024?",
        o: [
          "PQC: algoritmos resistentes a computadores quânticos (Shor quebra RSA/ECC); NIST 2024: ML-KEM (CRYSTALS-Kyber) para KEM, ML-DSA (CRYSTALS-Dilithium) e SLH-DSA (SPHINCS+) para assinatura",
          "PQC usa chaves simétricas maiores; RSA-4096 é considerado pós-quântico",
          "NIST ainda não padronizou nenhum algoritmo PQC; o processo está em fase inicial",
          "AES-256 é quebrado por computadores quânticos; PQC substitui somente criptografia simétrica",
        ],
        c: 0,
        e: "Shor's algorithm: quebra RSA, DSA, ECDSA, DH em tempo polinomial em QC. Grover's algorithm: reduz segurança simétrica à metade (AES-128 → AES-64-equivalent; AES-256 suficiente). NIST PQC (2024, FIPS 203/204/205): ML-KEM (lattice, key encapsulation), ML-DSA (lattice, digital signature), SLH-DSA (hash-based, stateless). CRYSTALS: Cryptographic Suite for Algebraic Lattices.",
        x: "'Harvest now, decrypt later': adversários coletam tráfego criptografado atual para decifrar quando QC disponível. TLS PQC: hybrid mode (X25519 + Kyber). CNSA 2.0 (NSA): prazo 2030-2035 para migração. XMSS/LMS: alternativas hash-based stateful para assinatura. OpenSSL 3.x + liboqs: integração PQC. Quantum-safe VPN: implementações piloto na Europa.",
      },
    ],
  },
  "Controle de Acesso": {
    Fácil: [
      {
        q: "Qual a diferença entre os modelos de controle de acesso DAC, MAC e RBAC?",
        o: [
          "DAC: dono do recurso define acesso; MAC: sistema de rótulos de segurança (top secret, classified) define acesso; RBAC: acesso baseado em papéis/funções do usuário na organização",
          "DAC é o modelo mais seguro; MAC é usado somente em redes sociais",
          "RBAC e DAC são equivalentes; MAC é somente para ambientes militares online",
          "MAC controla acesso por endereço MAC de rede; DAC por domínio Active Directory",
        ],
        c: 0,
        e: "DAC (Discretionary Access Control): proprietário controla (chmod Unix, ACLs Windows). MAC (Mandatory Access Control): rótulos de sigilo (SELinux, AppArmor, Trusted Solaris); sistema define, não o usuário. RBAC (Role-Based): roles (administrador, analista); usuários atribuídos a roles; NIST RBAC model. ABAC (Attribute-Based): política baseada em atributos (departamento, local, hora).",
        x: "SELinux: MAC no Linux (contexts: user:role:type:level). AppArmor: MAC por perfil de aplicação. Active Directory: RBAC via grupos de segurança. Zero Trust: ABAC + identity verification contínua. Princípio do menor privilégio: usuário tem apenas permissões necessárias. Separation of Duties: duas pessoas aprovam ação crítica.",
      },
    ],
    Médio: [
      {
        q: "O que é PAM (Privileged Access Management) e como reduz o risco de contas privilegiadas?",
        o: [
          "PAM: solução que controla, monitora e audita acesso de contas privilegiadas (admin, root, SA); cofre de senhas, sessões gravadas, just-in-time access, aprovação para uso de credenciais",
          "PAM é o módulo de autenticação plugável do Linux (Linux-PAM)",
          "PAM gerencia apenas senhas de usuários comuns; admins têm acesso irrestrito",
          "PAM é equivalente a um firewall para tráfego administrativo SSH",
        ],
        c: 0,
        e: "No contexto de segurança corporativa, PAM (Privileged Access Management): CyberArk, BeyondTrust, Thycotic. Cofre de senhas: credenciais privilegiadas armazenadas cifradas; checkout por sessão. Session recording: gravação de terminal/RDP para auditoria e forense. Just-in-time (JIT): acesso temporário com prazo. Privilege escalation justificada + aprovação de gestor.",
        x: "Threat: credential theft (Pass-the-Hash, Kerberoasting) de contas privilegiadas. PAM mitiga: credenciais rotacionadas automaticamente; humanos nunca veem senha real. PEDM (Privilege Elevation and Delegation Management): sudo com logging. Bastion host: jump server com PAM para acesso a servidores internos. NIST SP 1800-18: guia PAM.",
      },
    ],
    Difícil: [
      {
        q: "Como o modelo Zero Trust Architecture (ZTA) difere do modelo de segurança perimetral e quais seus pilares?",
        o: [
          "ZTA: 'nunca confiar, sempre verificar'; sem zona interna confiável; verificação contínua de identidade, dispositivo, contexto; microsegmentação; least-privilege por sessão",
          "Zero Trust elimina completamente firewalls e proxies na arquitetura",
          "ZTA é equivalente ao modelo de defesa em profundidade com DMZ",
          "Zero Trust confia em todos os usuários internos; desconfia somente de externos",
        ],
        c: 0,
        e: "Modelo perimetral: tudo dentro da rede corporativa é confiável (VPN = passa pelo firewall = confiável). Zero Trust (NIST SP 800-207): nenhum usuário/dispositivo é confiável por padrão, mesmo internamente. Pilares: (1) Identity verification (MFA, continuous auth); (2) Device health (EDR, compliance check); (3) Microsegmentation (lateralidade bloqueada); (4) Least-privilege (JIT, RBAC granular); (5) Assume breach (XDR, SIEM, monitoring).",
        x: "Implementação ZTA: Google BeyondCorp (acesso baseado em device cert + identity, sem VPN). Microsoft ZTA: Conditional Access (Azure AD), Intune (device compliance), Defender. SASE (Secure Access Service Edge): ZTA + SD-WAN como serviço (Zscaler, Cloudflare One). Lateral movement prevention: microsegmentação (VMware NSX, Illumio). Continuous validation: re-autenticação por risco (UEBA).",
      },
    ],
  },
  "Forense Digital": {
    Fácil: [
      {
        q: "O que é a cadeia de custódia em forense digital e por que é essencial em investigações?",
        o: [
          "Cadeia de custódia: documentação cronológica de quem coletou, transportou e acessou a evidência; garante integridade e admissibilidade legal das evidências digitais",
          "Cadeia de custódia é o registro de todos os arquivos apagados de um sistema",
          "É um protocolo de comunicação entre peritos forenses via rede cifrada",
          "Refere-se ao hash MD5 calculado antes e após análise de evidência",
        ],
        c: 0,
        e: "Cadeia de custódia: quem, quando, onde coletou e acessou a evidência. Evidência digital: volátil (RAM, processos, conexões) e não-volátil (disco, logs). Integridade: hash SHA-256 do image antes e após. Admissibilidade: se a cadeia for quebrada, evidência pode ser descartada no processo judicial. ISO/IEC 27037: diretrizes para identificação, coleta e preservação de evidências.",
        x: "Hash de imagem: 'sha256sum imagem.dd'. Write blocker: hardware que impede escrita no disco original (Tableau, WiebeTech). FTK Imager / dd / dcfldd: ferramentas de imagem forense. Live acquisition: AVML, LiME (RAM acquisition). Formulário de custódia: data, hora, responsável, hashes, assinatura. Evidência original: nunca analisada diretamente (analisa-se cópia).",
      },
    ],
    Médio: [
      {
        q: "Quais artefatos Windows são mais relevantes em uma investigação de incidente e onde são encontrados?",
        o: [
          "Prefetch, LNK files, Registry (UserAssist, MRU, ShimCache), Event Logs (EVTX), $MFT, $LogFile, hiberfil.sys, pagefile.sys, browser history, amcache.hve",
          "Apenas o Event Log é relevante; outros artefatos não contêm evidências",
          "Artefatos Windows ficam exclusivamente em C:\\Windows\\System32\\",
          "RAM não é artefato; somente disco rígido contém evidências relevantes",
        ],
        c: 0,
        e: "Windows forensics: Prefetch (C:\\Windows\\Prefetch\\*.pf): execução de programas. Registry: NTUSER.DAT (UserAssist: execuções GUI), ShimCache (AppCompatCache: execuções + timestamps), Amcache.hve (hash de executáveis). Event Log: Security (4624=logon, 4688=process create), System, Application. $MFT: tabela mestre de arquivos NTFS. LNK files: %APPDATA%\\Recent.",
        x: "Ferramentas: Autopsy (open-source), FTK (comercial), Volatility (RAM analysis), Eric Zimmermann Tools (MFTECmd, AppCompatCacheParser, LECmd). Timeline: Plaso/Log2Timeline agrega artefatos em linha do tempo. PowerShell history: %APPDATA%\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt. VSS (Volume Shadow Copies): cópias anteriores de arquivos.",
      },
    ],
    Difícil: [
      {
        q: "Como funciona a análise de memória RAM com Volatility e quais plugins são mais úteis em resposta a incidente?",
        o: [
          "Volatility analisa dumps de RAM extraindo processos, conexões, DLLs injetadas, handles, credenciais (hashdump, lsadump), código malicioso (malfind); plugins pslist, netscan, cmdline, malfind, dlllist, hashdump",
          "Volatility analisa somente arquivos de log; não processa imagens de RAM",
          "Análise de RAM é desnecessária se o disco foi imageado corretamente",
          "Volatility requer o sistema em execução; não funciona com dumps offline",
        ],
        c: 0,
        e: "Volatility 3: framework Python para análise de dumps de memória (Windows, Linux, macOS). Plugins essenciais: pslist/pstree (processos), netscan (conexões ativas), cmdline (argumentos de processo), malfind (código injetado: PAGE_EXECUTE_READWRITE em regiões sem backing), dlllist (DLLs carregadas), handles, hashdump (NTLM hashes do SAM), lsadump (LSA secrets).",
        x: "AVML / LiME / WinPmem: acquisition de RAM em sistemas live. malfind: detecta process hollowing, DLL injection (stealthy malware). Credential theft: mimikatz deixa rastros em lsass.exe. Volatility 2 vs 3: V3 é mais rápido, sem Python 2 dependency. Memory forensics cobre: fileless malware, backdoors em memória, rootkits.",
      },
    ],
  },
  "Gestão de Riscos": {
    Fácil: [
      {
        q: "O que é o processo de gestão de riscos segundo a ISO 31000 e quais suas etapas?",
        o: [
          "Identificação → análise (probabilidade × impacto) → avaliação → tratamento (aceitar, mitigar, transferir, eliminar) → monitoramento e revisão contínuos",
          "Gestão de riscos consiste apenas em instalar antivírus e firewall",
          "O processo inicia por tratamento; identificação ocorre somente após incidentes",
          "ISO 31000 é exclusiva para riscos financeiros; não se aplica à segurança da informação",
        ],
        c: 0,
        e: "ISO 31000:2018: Princípios, Framework, Processo. Processo: comunicação e consulta → estabelecimento de contexto → identificação → análise (qualitativa/quantitativa) → avaliação (priorização pelo risk appetite) → tratamento → monitoramento. Opções de tratamento: mitigar (controles), aceitar (risco residual), transferir (seguro), evitar (eliminar atividade).",
        x: "Análise quantitativa: ALE (Annual Loss Expectancy) = ARO × SLE. ALE: base para ROI de controles. Risk register: documenta riscos, owner, probabilidade, impacto, controles, residual. NIST RMF (SP 800-37): framework de gestão de riscos federais EUA. OCTAVE: metodologia orientada a ativos. Apetite de risco vs tolerância vs capacidade.",
      },
    ],
    Médio: [
      {
        q: "O que é BIA (Business Impact Analysis) e como ele guia a definição de RPO e RTO?",
        o: [
          "BIA identifica processos críticos e quantifica impactos de interrupção; RPO (Recovery Point Objective): máximo de dados tolerável a perder; RTO (Recovery Time Objective): tempo máximo aceitável para restaurar operação",
          "BIA é relatório de vulnerabilidades técnicas; RPO é tempo de resposta a incidente",
          "RTO e RPO são definidos pelo time de TI sem consultar o negócio",
          "BIA é realizado somente após um desastre para medir o impacto real",
        ],
        c: 0,
        e: "BIA: mapa de processos de negócio → criticidade → impacto temporal (financeiro, reputacional, legal). MTPD (Maximum Tolerable Period of Disruption): tempo até falência do processo. RPO: tolerância à perda de dados (RPO=0: replicação síncrona; RPO=24h: backup diário). RTO: tempo para retomar operação (RTO=4h: manter infraestrutura quente; RTO=72h: cold standby).",
        x: "BIA alimenta o BCP (Business Continuity Plan) e DRP (Disaster Recovery Plan). RPO baixo: replicação síncrona (SAN, database log shipping). RTO baixo: failover automático (active-passive cluster, hot site). Teste de DR: exercícios tabletop, simulações, failover real (gameday). WRT (Work Recovery Time): tempo para normalizar operações após restauração técnica. BCMS: ISO 22301.",
      },
    ],
    Difícil: [
      {
        q: "Como funciona a análise de risco quantitativa com os conceitos ALE, ARO, SLE e como calcular o ROI de um controle de segurança?",
        o: [
          "SLE = Valor do Ativo × Fator de Exposição; ARO = frequência anual de ocorrência; ALE = SLE × ARO; ROI controle = (ALE antes − ALE depois) − Custo controle",
          "ALE = custo de um incidente individual; ARO é calculado somente por auditors externos",
          "ROI = ALE × ARO; controles com ROI negativo devem ser implementados prioritariamente",
          "SLE inclui somente custos tangíveis; ARO é sempre igual a 1 para riscos críticos",
        ],
        c: 0,
        e: "SLE (Single Loss Expectancy) = Valor do Ativo × EF (Exposure Factor, % destruído). Ativo = R$500k, EF=40% → SLE = R$200k. ARO (Annualized Rate of Occurrence) = probabilidade anual (1x/2anos = 0,5). ALE = R$200k × 0,5 = R$100k/ano. Controle: R$30k/ano, reduz ALE para R$20k. ROI = (100k - 20k) - 30k = R$50k/ano economizados.",
        x: "Análise quantitativa: mais defensável para C-suite e board. Análise qualitativa (low/medium/high): mais rápida, subjetiva. FAIR (Factor Analysis of Information Risk): metodologia quantitativa estruturada. Monte Carlo simulation: modelagem de risco com distribuição de probabilidade. CVSS Score: não é análise de risco (é severidade técnica, não impacto ao negócio).",
      },
    ],
  },
  "Governança e Compliance": {
    Fácil: [
      {
        q: "O que é o framework COBIT e qual sua relação com governança de TI?",
        o: [
          "COBIT (Control Objectives for Information and Related Technologies): framework de governança e gestão de TI que alinha TI ao negócio, define objetivos de controle e mede maturidade",
          "COBIT é um protocolo de segurança de rede desenvolvido pela ISACA",
          "COBIT é equivalente ao ITIL; ambos tratam exclusivamente de gestão de incidentes",
          "COBIT é obrigatório apenas para empresas listadas na bolsa de valores",
        ],
        c: 0,
        e: "COBIT 2019 (ISACA): 40 objetivos de controle em 5 domínios (EDM: Evaluate/Direct/Monitor; APO: Align/Plan/Organize; BAI: Build/Acquire/Implement; DSS: Deliver/Service/Support; MEA: Monitor/Evaluate/Assess). Princípios: atender necessidades das partes interessadas, cobrir a empresa de ponta a ponta, aplicar framework integrado único.",
        x: "COBIT vs ITIL: COBIT = governança/controle (o quê e por quê); ITIL = melhores práticas de gerenciamento de serviços (como). COBIT vs ISO 27001: COBIT é framework amplo; ISO 27001 foca em SGSI. Maturidade CMMI: COBIT usa PAM (Process Capability). SOX compliance: COBIT frequentemente usado para controles ITGCs. ISACA certifications: CISA, CRISC.",
      },
    ],
    Médio: [
      {
        q: "O que é o PCI-DSS e quais são seus 12 requisitos principais?",
        o: [
          "PCI-DSS: padrão de segurança para ambientes de cartão de pagamento; 12 requisitos: rede segura (FW, senhas), proteção de dados CHD, programa de vulnerabilidades, controle de acesso, monitoramento, política de segurança",
          "PCI-DSS é lei federal brasileira que rege transações bancárias digitais",
          "PCI-DSS tem apenas 3 requisitos; os demais são opcionais conforme o nível",
          "PCI-DSS se aplica somente a varejistas; bancos e processadoras estão isentos",
        ],
        c: 0,
        e: "PCI-DSS v4.0: criado por Visa, Mastercard, Amex, Discover, JCB. 12 requisitos agrupados em 6 objetivos: (1-2) Rede segura; (3-4) Proteção de CHD (Cardholder Data); (5-6) Programa de vulnerabilidades; (7-9) Controle de acesso; (10-11) Monitoramento e testes; (12) Política de segurança da informação. Aplicável a qualquer entidade que processa/armazena/transmite dados de cartão.",
        x: "Níveis de compliance: nível 1 (>6M transações/ano): QSA externo; nível 2-4: SAQ (Self-Assessment Questionnaire). CHD: PAN, CVV, track data, PIN. Tokenização: substitui PAN por token; reduz escopo PCI. P2PE: criptografia ponto-a-ponto; reduz escopo. ASV scan: varredura externa trimestral. Pentest anual obrigatório. v4.0: customized approach, MFA expandido.",
      },
    ],
    Difícil: [
      {
        q: "Como estruturar um programa de Third-Party Risk Management (TPRM) e quais controles avaliar em fornecedores?",
        o: [
          "TPRM: inventário de fornecedores por criticidade → questionnaire/due diligence → análise de controles (ISO 27001, SOC 2, pentest) → contrato com SLAs e direito de auditoria → monitoramento contínuo",
          "TPRM se aplica somente a fornecedores de cloud; on-premise está isento",
          "Basta solicitar ao fornecedor carta de conformidade; auditoria direta é desnecessária",
          "TPRM é responsabilidade exclusiva do setor jurídico; equipe de segurança não participa",
        ],
        c: 0,
        e: "Risco de terceiros: fornecedores com acesso a dados sensíveis são extensão da superfície de ataque (SolarWinds, Kaseya, MOVEit). TPRM: (1) Inventário e classificação; (2) Due diligence inicial (questionário, certificações, pentest reports); (3) Contrato: DPA, SLAs de segurança, direito de auditoria; (4) Monitoramento: renewed assessment anual, SecurityScorecard, notícias de incidentes.",
        x: "ISO 27036: gestão de segurança em relacionamentos com fornecedores. SOC 2 Type II: auditoria independente de controles de fornecedor. CAIQ (Cloud Security Alliance): questionário padronizado para provedores cloud. Fourth-party risk: risco dos fornecedores dos seus fornecedores. SOW: incluir requisitos de segurança, obrigação de notificação de incidente (72h per LGPD/GDPR).",
      },
    ],
  },
  LGPD: {
    Fácil: [
      {
        q: "O que é dado pessoal sensível segundo a LGPD e quais exemplos a lei enumera?",
        o: [
          "Dado pessoal sensível: origem racial/étnica, convicção religiosa, opinião política, saúde, vida sexual, dado genético/biométrico, filiação sindical; tratamento requer consentimento específico ou hipótese legal",
          "Dado sensível é qualquer dado pessoal identificável; a lei não diferencia categorias",
          "Dados financeiros são sempre sensíveis segundo a LGPD",
          "Dado sensível inclui somente dados médicos; os demais são dados pessoais comuns",
        ],
        c: 0,
        e: "LGPD (Lei 13.709/2018), artigo 5°, II: dado pessoal sensível = dado pessoal sobre origem racial ou étnica, convicção religiosa, opinião política, filiação sindical, organização de caráter religioso, filosófico ou político, dado referente à saúde ou à vida sexual, dado genético ou biométrico.",
        x: "Tratamento de dado sensível: somente em hipóteses do art. 11 (consentimento específico e destacado, obrigação legal, políticas públicas, estudos de pesquisa, proteção da vida, tutela da saúde, prevenção à fraude, proteção do titular). Consentimento: deve ser inequívoco, informado, específico (não pode ser genérico). ANPD: Autoridade Nacional de Proteção de Dados.",
      },
    ],
    Médio: [
      {
        q: "Quais são as bases legais para tratamento de dados pessoais segundo a LGPD (art. 7°)?",
        o: [
          "10 bases legais: consentimento, obrigação legal, execução de políticas públicas, pesquisa, execução de contrato, exercício regular de direito, proteção da vida, tutela da saúde, legítimo interesse, proteção do crédito",
          "A única base legal é o consentimento expresso do titular",
          "LGPD tem apenas 3 bases legais: consentimento, contrato e lei",
          "Bases legais aplicam-se somente a empresas privadas; órgãos públicos estão isentos",
        ],
        c: 0,
        e: "LGPD art. 7°: (I) consentimento; (II) obrigação legal ou regulatória; (III) execução de políticas públicas (poder público); (IV) pesquisa (anonimização quando possível); (V) execução de contrato; (VI) exercício regular de direito; (VII) proteção da vida; (VIII) tutela da saúde (profissional de saúde); (IX) legítimo interesse; (X) proteção do crédito. Dados sensíveis: bases mais restritas (art. 11).",
        x: "Legítimo interesse: deve ser balanceado com direitos do titular; necessitar de LIA (Legitimate Interest Assessment). Consentimento: revogável a qualquer tempo; gratuito; não pode condicionar serviço. Data mapping (RoPA): mapeamento de atividades de tratamento por finalidade e base legal. Penalidades: até 2% do faturamento (R$50M por infração).",
      },
    ],
    Difícil: [
      {
        q: "Como implementar Privacy by Design e Privacy by Default em sistemas conforme a LGPD/GDPR?",
        o: [
          "Privacy by Design: integrar privacidade no ciclo de desenvolvimento (SDLC) desde o início; Privacy by Default: configuração mais restritiva como padrão; técnicas: minimização de dados, pseudonimização, controles de acesso granulares, data retention policies",
          "Privacy by Design é documentação jurídica; não envolve decisões técnicas de arquitetura",
          "Privacy by Default significa coletar dados máximos e permitir opt-out posterior",
          "Aplica-se somente a novos sistemas; sistemas legados estão isentos por padrão",
        ],
        c: 0,
        e: "Privacy by Design (Ann Cavoukian, 7 princípios): proativo não reativo, privacidade como padrão, embutida no design, funcionalidade plena, segurança end-to-end, visibilidade e transparência, respeito ao usuário. GDPR art. 25 / LGPD art. 46: obrigação legal. Data minimization: coletar somente o necessário. Pseudonimização: separar identificadores dos dados.",
        x: "DPIA (Data Protection Impact Assessment): avaliação de risco antes de processar dados sensíveis em larga escala. Threat model: LINDDUN (Privacy-focused STRIDE). Técnicas PbD: field-level encryption, tokenização, mascaramento para não-prod, consent management platform (CMP), cookie banner, RoPA (Record of Processing Activities). Privacy debt: débito técnico de privacidade em sistemas legados.",
      },
    ],
  },
  Malwares: {
    Fácil: [
      {
        q: "Qual a diferença entre vírus, worm e trojan?",
        o: [
          "Vírus: precisa de arquivo hospedeiro para se replicar; Worm: autorreplicante sem hospedeiro (explora redes); Trojan: disfarçado de software legítimo, não se replica sozinho",
          "São sinônimos usados intercambiavelmente na indústria",
          "Worm requer ação do usuário; vírus se propaga sozinho pela rede",
          "Trojan é sempre inofensivo; vírus e worm são os únicos malwares destrutivos",
        ],
        c: 0,
        e: "Vírus: anexa código malicioso a executáveis/documentos; precisa de execução pelo usuário; replica ao executar o hospedeiro (ILOVEYOU, Melissa). Worm: explora vulnerabilidades de rede autonomamente (WannaCry, Conficker - SMB/EternalBlue). Trojan: software aparentemente legítimo que esconde malware (backdoor, keylogger); não se replica. RAT (Remote Access Trojan): controle remoto completo.",
        x: "Rootkit: esconde presença no OS (kernel hooks, DKOM). Ransomware: cifra dados e exige resgate (WannaCry, Ryuk, LockBit). Spyware: monitora atividade (keyloggers, screen capture). Adware: exibe anúncios indesejados. Botnet: rede de bots (DDoS, spam, click fraud). Fileless malware: persiste em memória/registro sem arquivo em disco (PowerShell, WMI).",
      },
    ],
    Médio: [
      {
        q: "Como funciona um ataque de ransomware moderno e quais controles mitigam o risco?",
        o: [
          "Ransomware: acesso inicial (phishing/RDP/vuln) → persistência → lateral movement → exfiltração → criptografia com RSA+AES → nota de resgate; controles: backup offline 3-2-1, EDR comportamental, MFA, segmentação de rede",
          "Ransomware criptografa somente arquivos .doc e .pdf; demais extensões não são afetadas",
          "O antivírus tradicional (assinatura) é suficiente para prevenir ransomwares modernos",
          "Pagar o resgate garante a recuperação total dos dados em 100% dos casos",
        ],
        c: 0,
        e: "Kill chain ransomware: (1) Initial access: phishing, RDP brute force, exploração de vuln (VPN, Exchange). (2) Execution: PowerShell/WMI. (3) Persistence: scheduled tasks. (4) Privilege escalation: Mimikatz. (5) Lateral movement: PsExec, SMB. (6) Exfiltration (double extortion). (7) Encryption: AES-256 por arquivo, chave cifrada com RSA public key do atacante.",
        x: "Defesas: backup 3-2-1 (3 cópias, 2 mídias, 1 offsite/offline); testar restore. EDR (CrowdStrike, SentinelOne): comportamental, não por assinatura. MFA: impede acesso com credenciais roubadas. Segmentação de rede: limita lateral movement. Disable RDP ou mover porta. CISA: no more ransom (desencriptadores públicos). Seguro cibernético.",
      },
    ],
    Difícil: [
      {
        q: "O que é process hollowing e como ferramentas de EDR detectam essa técnica de evasão?",
        o: [
          "Process hollowing: processo legítimo (svchost.exe) criado suspenso; memória original desmapeada e substituída por código malicioso; processo retoma execução com código do atacante no contexto do processo legítimo",
          "Process hollowing injeta código em arquivos em disco em vez da memória",
          "EDR não detecta process hollowing; somente análise manual com debugger",
          "Process hollowing requer acesso físico ao hardware; impossível remotamente",
        ],
        c: 0,
        e: "Técnica: (1) CreateProcess com CREATE_SUSPENDED. (2) NtUnmapViewOfSection (desmapeia memória do processo). (3) VirtualAllocEx (aloca memória no processo filho). (4) WriteProcessMemory (escreve PE malicioso). (5) SetThreadContext (ajusta EIP/RIP para entry point). (6) ResumeThread. PID do processo legítimo: atividade maliciosa aparece sob svchost.exe no Task Manager.",
        x: "Detecção EDR: monitoramento de APIs suspeitas (NtUnmapViewOfSection + WriteProcessMemory + SetThreadContext sequência). Memory scanning: regiões PAGE_EXECUTE_READWRITE sem backing file (Volatility malfind). Behavioral: svchost.exe fazendo chamadas de rede incomuns. Yara rules: patterns no PE malicioso injetado. MITRE ATT&CK: T1055.012. ACG (Arbitrary Code Guard).",
      },
    ],
  },
  "Normas ISO 27001/27002": {
    Fácil: [
      {
        q: "Qual a diferença entre ISO 27001 e ISO 27002?",
        o: [
          "ISO 27001: requisitos para certificação do SGSI (auditável, certificável); ISO 27002: guia de boas práticas e controles de referência (não certificável)",
          "ISO 27001 e 27002 são a mesma norma; diferem apenas pelo idioma",
          "ISO 27002 é obrigatória por lei; ISO 27001 é apenas recomendada",
          "ISO 27001 cobre somente segurança física; 27002 cobre segurança lógica",
        ],
        c: 0,
        e: "ISO 27001:2022: SGSI (Sistema de Gestão de Segurança da Informação). Estrutura HLS (High Level Structure) = compatível com ISO 9001, 22301. Cláusulas 4-10: requisitos auditáveis. Anexo A: 93 controles (reorganizados em 4 temas em 2022). ISO 27002:2022: guia de implementação dos controles do Anexo A. Certificação: somente pela 27001.",
        x: "ISO 27001 cláusulas: 4 Contexto, 5 Liderança, 6 Planejamento, 7 Suporte, 8 Operação, 9 Avaliação, 10 Melhoria. Declaração de Aplicabilidade (SoA): lista controles Anexo A aplicáveis/excluídos com justificativa. GAP assessment: avalia maturidade atual × requisitos. PDCA: ciclo de melhoria contínua. Ciclo de certificação: 3 anos + auditorias anuais de manutenção.",
      },
    ],
    Médio: [
      {
        q: "O que é a Declaração de Aplicabilidade (SoA) na ISO 27001 e como ela é construída?",
        o: [
          "SoA: documento que lista todos os 93 controles do Anexo A, indicando se cada um é aplicável ou excluído, com justificativa; base para escopo do SGSI e auditorias externas",
          "SoA é o manual de políticas de segurança da empresa",
          "SoA lista somente os controles implementados; controles excluídos não precisam ser mencionados",
          "SoA é preenchida pelo auditor externo durante a certificação, não pela empresa",
        ],
        c: 0,
        e: "SoA (Statement of Applicability): requisito mandatório ISO 27001 (cláusula 6.1.3d). Construção: (1) Lista os 93 controles (Anexo A ISO 27001:2022, 4 temas: Organizacionais, Pessoais, Físicos, Tecnológicos). (2) Para cada controle: aplicável/não aplicável. (3) Status de implementação. (4) Referência ao documento/política que evidencia o controle. (5) Justificativa para exclusão. Baseada no risk treatment plan.",
        x: "ISO 27001:2022 Anexo A: 93 controles em 4 temas (era 114 em 14 domínios na versão 2013). Novos controles 2022: inteligência de ameaças, segurança na nuvem, data masking, monitoramento de atividades físicas. Risk treatment options: mitigar, aceitar, transferir, evitar. SoA alimenta o plano de continuidade e o programa de auditorias internas.",
      },
    ],
    Difícil: [
      {
        q: "Como conduzir uma análise de riscos conforme ISO 27005 integrada ao SGSI da ISO 27001?",
        o: [
          "ISO 27005: identificar ativos → ameaças → vulnerabilidades → calcular probabilidade × impacto → risk register → tratamento (SoA) → monitoramento; integrado à ISO 27001 cláusula 6.1 (planejamento de riscos)",
          "ISO 27005 substitui completamente a ISO 27001; não há necessidade de ambas",
          "Análise de riscos ISO 27005 é realizada somente uma vez na implementação inicial",
          "ISO 27005 define apenas controles técnicos; análise de riscos é responsabilidade do auditor",
        ],
        c: 0,
        e: "ISO 27005:2022 (alinhada com ISO 31000). Processo: (1) Estabelecimento de contexto (escopo, critérios de risco, apetite). (2) Identificação: ativos, ameaças, vulnerabilidades, controles existentes. (3) Análise: probabilidade × impacto = nível de risco. (4) Avaliação: comparar com critérios de aceitação, priorizar. (5) Tratamento: selecionar controles (SoA). (6) Aceitação: sign-off da direção. (7) Monitoramento.",
        x: "Escala de probabilidade/impacto: 1-5 qualitativa ou quantitativa (ALE). Risk appetite: nível de risco aceitável antes de tratamento. Residual risk: risco após controles; deve ser aceito pela direção. Ferramentas: planilha, Archer, ServiceNow GRC. Threat intelligence: MITRE ATT&CK como fonte de ameaças. Revisão anual obrigatória (ISO 27001 cláusula 9.3 management review).",
      },
    ],
  },
  "Políticas de Segurança": {
    Fácil: [
      {
        q: "O que é uma Política de Segurança da Informação (PSI) e quais elementos deve conter?",
        o: [
          "PSI: documento de alto nível que define objetivos, responsabilidades e diretrizes de segurança da informação; elementos: escopo, objetivos, definições, responsabilidades, sanções, referências a normas",
          "PSI é um documento técnico de configuração de firewall e sistemas",
          "PSI é elaborada somente pelo time de TI; não envolve a diretoria",
          "PSI define somente regras de uso de internet e e-mail corporativo",
        ],
        c: 0,
        e: "PSI: nível estratégico (política) → normas (nível tático) → procedimentos (operacional). Baseada em ISO 27001 (requisito da cláusula 5.2). Elementos: objetivos de segurança, escopo (ativos, pessoas, locais), princípios (CIA: confidencialidade, integridade, disponibilidade), papéis e responsabilidades, penalidades/sanções, revisão periódica (anual), aprovação da Alta Direção.",
        x: "Hierarquia documental: PSI → Normas específicas (uso aceitável, classificação da informação, senhas, dispositivos móveis) → Procedimentos (backup, resposta a incidentes) → Instruções de trabalho. Comunicação: todos os colaboradores devem conhecer a PSI (treinamento anual, assinatura de ciência). SANS Policy Templates: modelos gratuitos.",
      },
    ],
    Médio: [
      {
        q: "Como implementar um programa de conscientização e treinamento em segurança da informação eficaz?",
        o: [
          "Segmentar público por perfil de risco, usar conteúdo relevante ao cargo, aplicar simulações de phishing, medir métricas (click rate, reporting rate), revisar conteúdo anualmente e após incidentes",
          "Treinamento anual de 1 hora é suficiente; não é necessário segmentar por público",
          "Simulações de phishing são antiéticas e não devem ser usadas em programas corporativos",
          "Conscientização é responsabilidade exclusiva do RH; equipe de segurança não participa",
        ],
        c: 0,
        e: "Programa eficaz (NIST SP 800-50): identificar público-alvo e riscos específicos (executivo: CFO/whaling; dev: code injection; recepcionista: tailgating/vishing). Cobertura: phishing, senhas, uso aceitável, engenharia social, classificação da informação, LGPD. Formatos: e-learning, vídeos curtos (microlearning), posters, newsletters. Métricas: phishing click rate, completion rate.",
        x: "Plataformas: KnowBe4, Proofpoint Security Awareness, Hoxhunt. Simulação phishing: campanha mensal com templates graduais (easy→hard). Spear phishing simulado: executivos. SANS MGT433: programa de treinamento de segurança. ROI awareness: correlação entre treinamento e redução de phishing bem-sucedido. Gamificação: pontos, rankings, badges.",
      },
    ],
    Difícil: [
      {
        q: "Como estruturar um programa de Vulnerability Management (VM) do ciclo de descoberta ao fechamento?",
        o: [
          "Descoberta (scan ativos) → priorização (CVSS + EPSS + contexto de negócio) → remediation SLAs por criticidade → validação (rescan) → KPIs (MTTR, vuln density) → revisão contínua",
          "Vulnerability Management se limita a rodar o Nessus mensalmente e exportar o relatório",
          "Vulnerabilidades críticas devem ser corrigidas somente no próximo ciclo de manutenção mensal",
          "CVSS score 10 é suficiente para priorizar; contexto de negócio não é relevante",
        ],
        c: 0,
        e: "VM lifecycle: (1) Asset inventory (CMDB). (2) Scanning: credenciado (mais profundo) e não-credenciado. (3) Priorização: CVSS é ponto de partida; EPSS (Exploit Prediction Scoring System): probabilidade de exploração; contexto: exposição (internet-facing?), criticidade do ativo, existência de exploit público. (4) Remediation. (5) SLAs: Critical=7d, High=30d, Medium=90d. (6) Validation: rescan.",
        x: "Ferramentas: Tenable Nessus/SC, Qualys, Rapid7 InsightVM, OpenVAS. EPSS (FIRST.org): modelo ML para priorização. CISA KEV (Known Exploited Vulnerabilities): lista de vulns exploradas in-the-wild; prioridade máxima. KPIs: MTTR (Mean Time to Remediate), vuln density por ativo, aging (tempo médio em aberto). Risk-based VM: priorizar pelo risco real, não somente CVSS.",
      },
    ],
  },
  "Segurança em Aplicações Web": {
    Fácil: [
      {
        q: "O que é SQL Injection e como preveni-lo?",
        o: [
          "SQL Injection: inserção de código SQL via parâmetros da aplicação para manipular queries; prevenção: prepared statements/parameterized queries, stored procedures, validação de entrada, WAF",
          "SQL Injection é possível somente em banco de dados MySQL; outros bancos são imunes",
          "Codificar a entrada em Base64 previne completamente o SQL Injection",
          "Apenas WAF é suficiente para prevenir SQL Injection; código não precisa ser modificado",
        ],
        c: 0,
        e: "SQLi: atacante insere ' OR '1'='1 em campo de login → query retorna todos os usuários. Tipos: in-band (erro, union), blind (boolean, time-based), out-of-band. Impactos: extração de dados, bypass de autenticação, execução de comandos (xp_cmdshell no SQL Server). Prevenção primária: prepared statements (JDBC PreparedStatement, PDO PHP). Menor privilégio: conta de banco sem DROP/GRANT.",
        x: "Exemplo PHP inseguro: 'SELECT * FROM users WHERE user=\\\"'.$_GET['user'].'\\\"'. Seguro: PreparedStatement. sqlmap: ferramenta de exploração automática. OWASP A03:2021. WAF: segunda linha de defesa (não substitui código seguro). Blind SQLi: inferência booleana ('... AND 1=1' vs '... AND 1=2') ou timing ('... AND sleep(5)'). Error-based: message expõe estrutura do BD.",
      },
    ],
    Médio: [
      {
        q: "O que é SSRF (Server-Side Request Forgery) e como está relacionado a ambientes cloud?",
        o: [
          "SSRF: servidor faz requisição a URL controlada pelo atacante; em cloud, acessa metadata endpoint (169.254.169.254) obtendo credenciais IAM; prevenção: whitelist de URLs, bloquear metadata endpoint",
          "SSRF é exclusivo de aplicações mobile; não afeta servidores backend",
          "SSRF permite somente leitura de arquivos locais do servidor",
          "Metadata endpoint cloud (169.254.169.254) não contém dados sensíveis",
        ],
        c: 0,
        e: "SSRF (OWASP A10:2021): aplicação aceita URL do usuário e faz request do servidor. Exemplos: download de imagem externa, webhook, PDF generator. Impactos: acesso a serviços internos (localhost:8080), metadata cloud (AWS: 169.254.169.254/latest/meta-data/iam/security-credentials/), port scan interno. Capital One breach (2019): SSRF + privilégio excessivo no IAM Role.",
        x: "AWS IMDSv2: requer PUT com X-aws-ec2-metadata-token header (mitiga SSRF simples). Azure IMDS: 169.254.169.254 com Metadata:true header. Prevenção: whitelist (esquema+domínio+porta), bloquear 169.254.0.0/16, 10.0.0.0/8, 192.168.0.0/16. DNS rebinding: bypass de whitelist via DNS. Burp Collaborator: detecta SSRF blind.",
      },
    ],
    Difícil: [
      {
        q: "Como funciona JWT (JSON Web Token) e quais vulnerabilidades comuns existem na sua implementação?",
        o: [
          "JWT: header.payload.signature; ataque 'alg:none' remove verificação de assinatura; confusion RS256→HS256 usa chave pública como segredo HMAC; weak key força bruta; kid injection → path traversal ou SQLi",
          "JWT é sempre seguro por padrão; vulnerabilidades são somente teóricas",
          "Payload JWT é criptografado; atacante não pode ler as claims",
          "Trocar algoritmo de RS256 para HS256 aumenta a segurança do token",
        ],
        c: 0,
        e: "JWT: Base64url(header).Base64url(payload).Base64url(signature). Payload: não cifrado (apenas encoded); dados visíveis. Vulnerabilidades: (1) alg:none: biblioteca aceita token sem assinatura; (2) RS256→HS256 confusion: biblioteca verifica HMAC-SHA256 com chave pública (conhecida) como secret; (3) Weak HMAC secret: força bruta offline; (4) kid injection: interpolação direta → SQLi/LFI.",
        x: "Ferramentas: jwt_tool (ticarpi), jwt.io. Mitigações: forçar algoritmo no servidor (não aceitar do cliente); chave HMAC >= 256 bits aleatória; validar exp/nbf/iss/aud; HttpOnly+Secure cookies para armazenar JWT (não localStorage). JWE (JSON Web Encryption): cifra payload. OIDC: OAuth 2.0 + ID Token JWT. hashcat -a 0 -m 16500 hash.txt wordlist.txt.",
      },
    ],
  },
};

function mergeSegBankRounds(
  base: Record<string, Record<UserLevel, SeedCard[]>>,
  extras: Record<string, Record<UserLevel, SeedCard[]>>,
): Record<string, Record<UserLevel, SeedCard[]>> {
  const result: Record<string, Record<UserLevel, SeedCard[]>> = { ...base };
  for (const cat of Object.keys(extras)) {
    const levels = extras[cat] as Record<UserLevel, SeedCard[]>;
    if (!result[cat]) result[cat] = { Fácil: [], Médio: [], Difícil: [] };
    for (const lvl of ["Fácil", "Médio", "Difícil"] as UserLevel[]) {
      const existing = new Set(
        (result[cat][lvl] ?? []).map((c) => c.q.trim().toLowerCase()),
      );
      const novel = (levels[lvl] ?? []).filter(
        (c) => !existing.has(c.q.trim().toLowerCase()),
      );
      result[cat][lvl] = [...(result[cat][lvl] ?? []), ...novel];
    }
  }
  return result;
}

export const segurancaBank = mergeSegBankRounds(
  segurancaBankBase,
  segurancaRound1Extras,
);
